<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nicky Wakim">
<meta name="dcterms.date" content="2023-01-17">

<title>Linear Models - Simple Linear Regression (SLR)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/bsta_512_hex.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Linear Models</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule1.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homeworks.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Simple Linear Regression (SLR)</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Info</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weekly Pages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homeworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../readings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">612 Readings</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#topics" id="toc-topics" class="nav-link" data-scroll-target="#topics">Topics</a></li>
  <li><a href="#lets-start-with-an-example" id="toc-lets-start-with-an-example" class="nav-link" data-scroll-target="#lets-start-with-an-example">Let’s start with an example</a></li>
  <li><a href="#reference-how-did-i-code-that" id="toc-reference-how-did-i-code-that" class="nav-link" data-scroll-target="#reference-how-did-i-code-that">Reference: How did I code that?</a></li>
  </ul></li>
  <li><a href="#learning-objectives-1" id="toc-learning-objectives-1" class="nav-link" data-scroll-target="#learning-objectives-1">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#questions-we-can-ask-with-this-model" id="toc-questions-we-can-ask-with-this-model" class="nav-link" data-scroll-target="#questions-we-can-ask-with-this-model">Questions we can ask with this model</a></li>
  <li><a href="#association-vs.-prediction" id="toc-association-vs.-prediction" class="nav-link" data-scroll-target="#association-vs.-prediction">Association vs.&nbsp;prediction</a></li>
  <li><a href="#dataset-description" id="toc-dataset-description" class="nav-link" data-scroll-target="#dataset-description">Dataset description</a></li>
  <li><a href="#get-to-know-the-data" id="toc-get-to-know-the-data" class="nav-link" data-scroll-target="#get-to-know-the-data">Get to know the data</a></li>
  <li><a href="#remove-missing-values" id="toc-remove-missing-values" class="nav-link" data-scroll-target="#remove-missing-values">Remove missing values</a></li>
  <li><a href="#three-types-of-study-design-there-are-more" id="toc-three-types-of-study-design-there-are-more" class="nav-link" data-scroll-target="#three-types-of-study-design-there-are-more">Three types of study design (there are more)</a></li>
  <li><a href="#lets-revisit-the-regression-analysis-process" id="toc-lets-revisit-the-regression-analysis-process" class="nav-link" data-scroll-target="#lets-revisit-the-regression-analysis-process">Let’s revisit the regression analysis process</a></li>
  </ul></li>
  <li><a href="#learning-objectives-2" id="toc-learning-objectives-2" class="nav-link" data-scroll-target="#learning-objectives-2">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression-model" id="toc-simple-linear-regression-model" class="nav-link" data-scroll-target="#simple-linear-regression-model">Simple Linear Regression Model</a></li>
  <li><a href="#simple-linear-regression-model-another-way-to-view-components" id="toc-simple-linear-regression-model-another-way-to-view-components" class="nav-link" data-scroll-target="#simple-linear-regression-model-another-way-to-view-components">Simple Linear Regression Model (another way to view components)</a>
  <ul class="collapse">
  <li><a href="#components" id="toc-components" class="nav-link" data-scroll-target="#components">Components</a></li>
  </ul></li>
  <li><a href="#if-the-population-parameters-are-unobservable-how-did-we-get-the-line-for-life-expectancy" id="toc-if-the-population-parameters-are-unobservable-how-did-we-get-the-line-for-life-expectancy" class="nav-link" data-scroll-target="#if-the-population-parameters-are-unobservable-how-did-we-get-the-line-for-life-expectancy">If the population parameters are unobservable, how did we get the line for life expectancy?</a></li>
  <li><a href="#okay-so-how-do-we-estimate-the-regression-line" id="toc-okay-so-how-do-we-estimate-the-regression-line" class="nav-link" data-scroll-target="#okay-so-how-do-we-estimate-the-regression-line">Okay, so how do we estimate the regression line?</a></li>
  <li><a href="#regression-line-best-fit-line" id="toc-regression-line-best-fit-line" class="nav-link" data-scroll-target="#regression-line-best-fit-line">Regression line = best-fit line</a></li>
  <li><a href="#simple-linear-regression-model-1" id="toc-simple-linear-regression-model-1" class="nav-link" data-scroll-target="#simple-linear-regression-model-1">Simple Linear Regression Model</a></li>
  <li><a href="#we-get-it-nicky-how-do-we-estimate-the-regression-line" id="toc-we-get-it-nicky-how-do-we-estimate-the-regression-line" class="nav-link" data-scroll-target="#we-get-it-nicky-how-do-we-estimate-the-regression-line">We get it, Nicky! How do we estimate the regression line?</a></li>
  </ul></li>
  <li><a href="#learning-objectives-3" id="toc-learning-objectives-3" class="nav-link" data-scroll-target="#learning-objectives-3">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#it-all-starts-with-a-residual" id="toc-it-all-starts-with-a-residual" class="nav-link" data-scroll-target="#it-all-starts-with-a-residual">It all starts with a residual…</a></li>
  <li><a href="#so-now-we-have-two-representations-of-our-population-model" id="toc-so-now-we-have-two-representations-of-our-population-model" class="nav-link" data-scroll-target="#so-now-we-have-two-representations-of-our-population-model">So now we have two representations of our population model</a></li>
  <li><a href="#back-to-our-estimated-model" id="toc-back-to-our-estimated-model" class="nav-link" data-scroll-target="#back-to-our-estimated-model">Back to our estimated model</a></li>
  <li><a href="#translate-eyeballing-to-mathematical-form" id="toc-translate-eyeballing-to-mathematical-form" class="nav-link" data-scroll-target="#translate-eyeballing-to-mathematical-form">Translate eyeballing to mathematical form??</a></li>
  <li><a href="#coefficient-estimates" id="toc-coefficient-estimates" class="nav-link" data-scroll-target="#coefficient-estimates">Coefficient estimates</a></li>
  </ul></li>
  <li><a href="#learning-objectives-4" id="toc-learning-objectives-4" class="nav-link" data-scroll-target="#learning-objectives-4">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#regression-in-r-lm-summary-tidy" id="toc-regression-in-r-lm-summary-tidy" class="nav-link" data-scroll-target="#regression-in-r-lm-summary-tidy">Regression in R: <code>lm()</code>, <code>summary()</code>, &amp; <code>tidy()</code></a></li>
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#the-population-regression-model" id="toc-the-population-regression-model" class="nav-link" data-scroll-target="#the-population-regression-model">The (population) regression model</a></li>
  <li><a href="#how-do-we-interpret-the-coefficients" id="toc-how-do-we-interpret-the-coefficients" class="nav-link" data-scroll-target="#how-do-we-interpret-the-coefficients">How do we interpret the coefficients?</a></li>
  </ul></li>
  <li><a href="#next-class" id="toc-next-class" class="nav-link" data-scroll-target="#next-class">Next class???</a>
  <ul class="collapse">
  <li><a href="#what-are-the-line-conditions" id="toc-what-are-the-line-conditions" class="nav-link" data-scroll-target="#what-are-the-line-conditions">What are the LINE conditions?</a></li>
  <li><a href="#l-linearity-of-relationship-between-variables" id="toc-l-linearity-of-relationship-between-variables" class="nav-link" data-scroll-target="#l-linearity-of-relationship-between-variables">L: Linearity of relationship between variables</a></li>
  <li><a href="#i-independence-of-the-residuals-y-values" id="toc-i-independence-of-the-residuals-y-values" class="nav-link" data-scroll-target="#i-independence-of-the-residuals-y-values">I: Independence of the residuals (<span class="math inline">\(Y\)</span> values)</a></li>
  </ul></li>
  <li><a href="#n-normality-of-the-residuals" id="toc-n-normality-of-the-residuals" class="nav-link" data-scroll-target="#n-normality-of-the-residuals">N: Normality of the residuals</a>
  <ul class="collapse">
  <li><a href="#n-normality-of-the-residuals-1" id="toc-n-normality-of-the-residuals-1" class="nav-link" data-scroll-target="#n-normality-of-the-residuals-1">N: Normality of the residuals</a></li>
  <li><a href="#extract-models-residuals-in-r" id="toc-extract-models-residuals-in-r" class="nav-link" data-scroll-target="#extract-models-residuals-in-r">Extract model’s residuals in R</a></li>
  <li><a href="#check-normality-with-usual-distribution-plots" id="toc-check-normality-with-usual-distribution-plots" class="nav-link" data-scroll-target="#check-normality-with-usual-distribution-plots">Check normality with “usual” distribution plots</a></li>
  <li><a href="#normal-qq-plots-qq-quantile-quantile" id="toc-normal-qq-plots-qq-quantile-quantile" class="nav-link" data-scroll-target="#normal-qq-plots-qq-quantile-quantile">Normal QQ plots (QQ = quantile-quantile)</a></li>
  <li><a href="#examples-of-normal-qq-plots-15" id="toc-examples-of-normal-qq-plots-15" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots-15">Examples of Normal QQ plots (1/5)</a></li>
  <li><a href="#examples-of-normal-qq-plots-25" id="toc-examples-of-normal-qq-plots-25" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots-25">Examples of Normal QQ plots (2/5)</a></li>
  <li><a href="#examples-of-normal-qq-plots-35" id="toc-examples-of-normal-qq-plots-35" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots-35">Examples of Normal QQ plots (3/5)</a></li>
  <li><a href="#examples-of-normal-qq-plots-45" id="toc-examples-of-normal-qq-plots-45" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots-45">Examples of Normal QQ plots (4/5)</a></li>
  <li><a href="#examples-of-normal-qq-plots-55" id="toc-examples-of-normal-qq-plots-55" class="nav-link" data-scroll-target="#examples-of-normal-qq-plots-55">Examples of Normal QQ plots (5/5)</a></li>
  <li><a href="#qq-plot-of-residuals-of-model1" id="toc-qq-plot-of-residuals-of-model1" class="nav-link" data-scroll-target="#qq-plot-of-residuals-of-model1">QQ plot of residuals of <code>model1</code></a></li>
  <li><a href="#compare-to-randomly-generated-normal-qq-plots" id="toc-compare-to-randomly-generated-normal-qq-plots" class="nav-link" data-scroll-target="#compare-to-randomly-generated-normal-qq-plots">Compare to randomly generated Normal QQ plots</a></li>
  <li><a href="#randomly-generated-normal-qq-plots-n100" id="toc-randomly-generated-normal-qq-plots-n100" class="nav-link" data-scroll-target="#randomly-generated-normal-qq-plots-n100">Randomly generated Normal QQ plots: n=100</a></li>
  <li><a href="#examples-of-simulated-normal-qq-plots-n10" id="toc-examples-of-simulated-normal-qq-plots-n10" class="nav-link" data-scroll-target="#examples-of-simulated-normal-qq-plots-n10">Examples of simulated Normal QQ plots: n=10</a></li>
  <li><a href="#examples-of-simulated-normal-qq-plots-n1000" id="toc-examples-of-simulated-normal-qq-plots-n1000" class="nav-link" data-scroll-target="#examples-of-simulated-normal-qq-plots-n1000">Examples of simulated Normal QQ plots: n=1,000</a></li>
  <li><a href="#back-to-our-example" id="toc-back-to-our-example" class="nav-link" data-scroll-target="#back-to-our-example">Back to our example</a></li>
  </ul></li>
  <li><a href="#e-equality-of-variance-of-the-residuals" id="toc-e-equality-of-variance-of-the-residuals" class="nav-link" data-scroll-target="#e-equality-of-variance-of-the-residuals">E: Equality of variance of the residuals</a>
  <ul class="collapse">
  <li><a href="#residual-plot" id="toc-residual-plot" class="nav-link" data-scroll-target="#residual-plot">Residual plot</a></li>
  <li><a href="#e-equality-of-variance-of-the-residuals-homoscedasticity" id="toc-e-equality-of-variance-of-the-residuals-homoscedasticity" class="nav-link" data-scroll-target="#e-equality-of-variance-of-the-residuals-homoscedasticity">E: Equality of variance of the residuals (Homoscedasticity)</a></li>
  </ul></li>
  <li><a href="#r2-coefficient-of-determination" id="toc-r2-coefficient-of-determination" class="nav-link" data-scroll-target="#r2-coefficient-of-determination"><span class="math inline">\(R^2\)</span> = Coefficient of determination</a>
  <ul class="collapse">
  <li><a href="#r2-coefficient-of-determination-12" id="toc-r2-coefficient-of-determination-12" class="nav-link" data-scroll-target="#r2-coefficient-of-determination-12"><span class="math inline">\(R^2\)</span> = Coefficient of determination (1/2)</a></li>
  <li><a href="#r2-coefficient-of-determination-22" id="toc-r2-coefficient-of-determination-22" class="nav-link" data-scroll-target="#r2-coefficient-of-determination-22"><span class="math inline">\(R^2\)</span> = Coefficient of determination (2/2)</a></li>
  <li><a href="#r2-in-summary-r-output" id="toc-r2-in-summary-r-output" class="nav-link" data-scroll-target="#r2-in-summary-r-output"><span class="math inline">\(R^2\)</span> in <code>summary()</code> R output</a></li>
  </ul></li>
  <li><a href="#regression-inference" id="toc-regression-inference" class="nav-link" data-scroll-target="#regression-inference">Regression inference</a>
  <ul class="collapse">
  <li><a href="#inference-for-population-slope-beta_1" id="toc-inference-for-population-slope-beta_1" class="nav-link" data-scroll-target="#inference-for-population-slope-beta_1">Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#inference-for-the-population-slope-ci-and-hypothesis-test" id="toc-inference-for-the-population-slope-ci-and-hypothesis-test" class="nav-link" data-scroll-target="#inference-for-the-population-slope-ci-and-hypothesis-test">Inference for the population <span style="color:green"><strong>slope</strong></span>: CI and hypothesis test</a></li>
  <li><a href="#ci-for-population-slope-beta_1" id="toc-ci-for-population-slope-beta_1" class="nav-link" data-scroll-target="#ci-for-population-slope-beta_1">CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#standard-error-of-fitted-slope-b_1" id="toc-standard-error-of-fitted-slope-b_1" class="nav-link" data-scroll-target="#standard-error-of-fitted-slope-b_1">Standard error of fitted slope <span class="math inline">\(b_1\)</span></a></li>
  <li><a href="#calculate-ci-for-population-slope-beta_1" id="toc-calculate-ci-for-population-slope-beta_1" class="nav-link" data-scroll-target="#calculate-ci-for-population-slope-beta_1">Calculate CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#hypothesis-test-for-population-slope-beta_1" id="toc-hypothesis-test-for-population-slope-beta_1" class="nav-link" data-scroll-target="#hypothesis-test-for-population-slope-beta_1">Hypothesis test for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#p-value-for-testing-population-slope-beta_1" id="toc-p-value-for-testing-population-slope-beta_1" class="nav-link" data-scroll-target="#p-value-for-testing-population-slope-beta_1"><span class="math inline">\(p\)</span>-value for testing population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></a></li>
  </ul></li>
  <li><a href="#prediction-inference" id="toc-prediction-inference" class="nav-link" data-scroll-target="#prediction-inference">Prediction (&amp; inference)</a>
  <ul class="collapse">
  <li><a href="#prediction-with-regression-line" id="toc-prediction-with-regression-line" class="nav-link" data-scroll-target="#prediction-with-regression-line">Prediction with regression line</a></li>
  <li><a href="#prediction-with-regression-line-1" id="toc-prediction-with-regression-line-1" class="nav-link" data-scroll-target="#prediction-with-regression-line-1">Prediction with regression line</a></li>
  <li><a href="#ci-for-mean-response-mu_yx" id="toc-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#ci-for-mean-response-mu_yx">CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#example-ci-for-mean-response-mu_yx" id="toc-example-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#example-ci-for-mean-response-mu_yx">Example: CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#example-using-r-for-ci-for-mean-response-mu_yx" id="toc-example-using-r-for-ci-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#example-using-r-for-ci-for-mean-response-mu_yx">Example: Using R for CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#confidence-bands-for-mean-response-mu_yx" id="toc-confidence-bands-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#confidence-bands-for-mean-response-mu_yx">Confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#width-of-confidence-bands-for-mean-response-mu_yx" id="toc-width-of-confidence-bands-for-mean-response-mu_yx" class="nav-link" data-scroll-target="#width-of-confidence-bands-for-mean-response-mu_yx">Width of confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></a></li>
  <li><a href="#prediction-interval-for-predicting-individual-observations" id="toc-prediction-interval-for-predicting-individual-observations" class="nav-link" data-scroll-target="#prediction-interval-for-predicting-individual-observations">Prediction interval for predicting <strong>individual</strong> observations</a></li>
  <li><a href="#example-prediction-interval" id="toc-example-prediction-interval" class="nav-link" data-scroll-target="#example-prediction-interval">Example: Prediction interval</a></li>
  <li><a href="#example-using-r-for-prediction-interval" id="toc-example-using-r-for-prediction-interval" class="nav-link" data-scroll-target="#example-using-r-for-prediction-interval">Example: Using R for prediction interval</a>
  <ul class="collapse">
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#prediction-bands-vs.-confidence-bands-12" id="toc-prediction-bands-vs.-confidence-bands-12" class="nav-link" data-scroll-target="#prediction-bands-vs.-confidence-bands-12">Prediction bands vs.&nbsp;confidence bands (1/2)</a></li>
  <li><a href="#prediction-bands-vs.-confidence-bands-22" id="toc-prediction-bands-vs.-confidence-bands-22" class="nav-link" data-scroll-target="#prediction-bands-vs.-confidence-bands-22">Prediction bands vs.&nbsp;confidence bands (2/2)</a></li>
  </ul></li>
  <li><a href="#caution" id="toc-caution" class="nav-link" data-scroll-target="#caution">Caution…</a>
  <ul class="collapse">
  <li><a href="#corrrelation-doesnt-imply-causation" id="toc-corrrelation-doesnt-imply-causation" class="nav-link" data-scroll-target="#corrrelation-doesnt-imply-causation">Corrrelation doesn’t imply causation<code>*</code>!</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next">What’s next?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="03_SLR.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Simple Linear Regression (SLR)</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Week 1</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nicky Wakim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 17, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="learning-objectives" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Identify the aims of your research and see how they align with the intended purpose of simple linear regression</p></li>
<li><p>Identify the simple linear regression model and define statistics language for key notation</p></li>
<li><p>Illustrate how ordinary least squares (OLS) finds the best model parameter estimates</p></li>
<li><p>Solve the optimal coefficient estimates for simple linear regression using OLS</p></li>
<li><p>Apply OLS in R for simple linear regression of real data</p></li>
</ol>
<section id="topics" class="level2">
<h2 class="anchored" data-anchor-id="topics">Topics</h2>
<p>Topics for SLR:</p>
<p>assumptions</p>
<p>parameter estimation and interpretation</p>
<p>properties of LSE</p>
<p>estimation of variance?</p>
<p>Topics</p>
<ul>
<li><p>Inference for slope and intercept</p>
<ul>
<li>CI’s and hypothesis tests</li>
</ul></li>
<li><p>Inference for mean value of y at specific values of x</p>
<ul>
<li>Confidence bands of best-fit line</li>
</ul></li>
<li><p>Prediction intervals for individual predictions</p>
<ul>
<li>Prediction bands</li>
</ul></li>
<li><p><em>F-test for the slope</em></p></li>
<li><p><em>Pearson correlation coefficient r</em></p></li>
<li><p><em>Coefficient of determination R2</em></p></li>
<li><p><em>Testing the correlation coefficient !</em></p></li>
<li><p><em>CI for the correlation coefficient !</em></p></li>
</ul>
</section>
<section id="lets-start-with-an-example" class="level2">
<h2 class="anchored" data-anchor-id="lets-start-with-an-example">Let’s start with an example</h2>
<div class="columns">
<div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 188 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (2): life_expectancy_years_2011, female_literacy_rate_2011

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</div><div class="column" style="width:45%;">
<p>Average life expectancy vs.&nbsp;female literacy rate <span class="math inline">\(\beta\)</span></p>
<ul>
<li><p>Each point on the plot is for a different country</p></li>
<li><p><span class="math inline">\(X\)</span> = country’s adult female literacy rate</p></li>
<li><p><span class="math inline">\(Y\)</span> = country’s average life expectancy (years)</p></li>
<li><p>Data are from Gapminder (2011)</p></li>
</ul>
</div>
</div>
<div class="heq">
<p><span class="math display">\[\widehat{\text{life expectancy}} =  50.9 + 0.232\cdot\text{female literacy rate}\]</span></p>
</div>
</section>
<section id="reference-how-did-i-code-that" class="level2">
<h2 class="anchored" data-anchor-id="reference-how-did-i-code-that">Reference: How did I code that?</h2>
<p><img src="pause.png" class="absolute" data-top="100%" data-right="0%" width="120" height="120"></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapm, <span class="fu">aes</span>(<span class="at">x =</span> female_literacy_rate_2011,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour=</span><span class="st">"#F14124"</span>) <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Female literacy rate (%)"</span>, </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Life expectancy (years)"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Relationship between life expectancy and </span><span class="sc">\n</span><span class="st"> the female literacy rate in 2011"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>), </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>), </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">30</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="learning-objectives-1" class="level1">
<h1>Learning Objectives</h1>
<div class="lob">
<ol type="1">
<li>Identify the aims of your research and see how they align with the intended purpose of simple linear regression</li>
</ol>
</div>
<ol start="2" type="1">
<li><p>Identify the simple linear regression model and define statistics language for key notation</p></li>
<li><p>Illustrate how ordinary least squares (OLS) finds the best model parameter estimates</p></li>
<li><p>Solve the optimal coefficient estimates for simple linear regression using OLS</p></li>
<li><p>Apply OLS in R for simple linear regression of real data</p></li>
</ol>
<section id="questions-we-can-ask-with-this-model" class="level2">
<h2 class="anchored" data-anchor-id="questions-we-can-ask-with-this-model">Questions we can ask with this model</h2>
<div class="columns">
<div class="column" style="width:55%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 188 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (2): life_expectancy_years_2011, female_literacy_rate_2011

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</div><div class="column" style="width:45%;">
<ul>
<li>How do we…
<ul>
<li>calculate slope &amp; intercept?</li>
<li>interpret slope &amp; intercept?</li>
<li>do inference for slope &amp; intercept?
<ul>
<li>CI, p-value</li>
</ul></li>
<li>do prediction with regression line?
<ul>
<li>CI for prediction?</li>
</ul></li>
</ul></li>
<li>Does the model fit the data well?
<ul>
<li>Should we be using a line to model the data?</li>
</ul></li>
<li>Should we add additional variables to the model?
<ul>
<li>multiple/multivariable regression</li>
</ul></li>
</ul>
</div>
</div>
<div class="heq">
<p><span class="math display">\[\widehat{\text{life expectancy}} =  50.9 + 0.232\cdot\text{female literacy rate}\]</span></p>
</div>
</section>
<section id="association-vs.-prediction" class="level2">
<h2 class="anchored" data-anchor-id="association-vs.-prediction">Association vs.&nbsp;prediction</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="proof1">
<div class="proof-title">
<p>Association</p>
</div>
<div class="proof-cont">
<ul>
<li>What is the association between countries’ life expectancy and female literacy rate?</li>
<li>Use the slope of the line or correlation coefficient</li>
</ul>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="definition">
<div class="def-title">
<p>Prediction</p>
</div>
<div class="def-cont">
<ul>
<li>What is the expected average life expectancy for a country with a specified female literacy rate? &nbsp; &nbsp;</li>
</ul>
</div>
</div>
</div>
</div>
<p><span class="math display">\[\widehat{\text{life expectancy}} =  50.9 + 0.232\cdot\text{female literacy rate}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 188 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (2): life_expectancy_years_2011, female_literacy_rate_2011

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="dataset-description" class="level2">
<h2 class="anchored" data-anchor-id="dataset-description">Dataset description</h2>
<ul>
<li><p>Data file: <code>lifeexp_femlit_water_2011.csv</code></p></li>
<li><p>Data were downloaded from <a href="https://www.gapminder.org/data/" class="uri">https://www.gapminder.org/data/</a></p></li>
<li><p>2011 is the most recent year with the most complete data</p></li>
<li><p><strong>Life expectancy</strong> = the average number of years a newborn child would live if current mortality patterns were to stay the same. Source: <a href="https://www.gapminder.org/data/documentation/gd004/" class="uri">https://www.gapminder.org/data/documentation/gd004/</a></p></li>
<li><p><strong>Adult literacy rate</strong> is the percentage of people ages 15 and above who can, with understanding, read and write a short, simple statement on their everyday life. Source: <a href="http://data.uis.unesco.org/" class="uri">http://data.uis.unesco.org/</a></p></li>
<li><p><strong>At least basic water source (%)</strong> = the percentage of people using at least basic water services. This indicator encompasses both people using basic water services as well as those using safely managed water services. Basic drinking water services is defined as drinking water from an improved source, provided collection time is not more than 30 minutes for a round trip. Improved water sources include piped water, boreholes or tubewells, protect dug wells, protected springs, and packaged or delivered water.</p></li>
</ul>
</section>
<section id="get-to-know-the-data" class="level2">
<h2 class="anchored" data-anchor-id="get-to-know-the-data">Get to know the data</h2>
<ul>
<li>Load data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>gapm_original <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"lifeexp_femlit_water_2011.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 194 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): country, water_2011_quart
dbl (3): life_expectancy_years_2011, female_literacy_rate_2011, water_basic_...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ul>
<li>Glimpse of the data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapm_original)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 194
Columns: 5
$ country                    &lt;chr&gt; "Afghanistan", "Albania", "Algeria", "Andor…
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 76.7, 82.6, 60.9, 76.9, 76.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, NA, NA, 58.6, 99.4, 97.9, 99.5,…
$ water_basic_source_2011    &lt;dbl&gt; 52.6, 88.1, 92.6, 100.0, 40.3, 97.0, 99.5, …
$ water_2011_quart           &lt;chr&gt; "Q1", "Q2", "Q2", "Q4", "Q1", "Q3", "Q4", "…</code></pre>
</div>
</div>
<ul>
<li>Note the missing values for our variables of interest</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gapm_original <span class="sc">%&gt;%</span> <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  variable        n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 life_expec…   187  47.5  82.9   72.7  64.3  76.9  12.6  9.04  70.7  8.44 0.617
2 female_lit…    80  13    99.8   91.6  71.0  98.0  27.0 11.4   81.7 22.0  2.45 
# ℹ 1 more variable: ci &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="remove-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="remove-missing-values">Remove missing values</h2>
<ul>
<li>Remove rows with missing data for life expectancy and female literacy rate</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>gapm <span class="ot">&lt;-</span> gapm_original <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(life_expectancy_years_2011, female_literacy_rate_2011)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 5
$ country                    &lt;chr&gt; "Afghanistan", "Albania", "Angola", "Antigu…
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ water_basic_source_2011    &lt;dbl&gt; 52.6, 88.1, 40.3, 97.0, 99.5, 97.8, 96.7, 9…
$ water_2011_quart           &lt;chr&gt; "Q1", "Q2", "Q1", "Q3", "Q4", "Q3", "Q3", "…</code></pre>
</div>
</div>
<ul>
<li>No missing values now for our variables of interest</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gapm <span class="sc">%&gt;%</span> <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  variable        n   min   max median    q1    q3   iqr   mad  mean    sd    se
  &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 life_expec…    80    48  81.8   72.4  65.9  75.8  9.95  6.30  69.9  7.95 0.889
2 female_lit…    80    13  99.8   91.6  71.0  98.0 27.0  11.4   81.7 22.0  2.45 
# ℹ 1 more variable: ci &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Removing the rows with missing data was not needed to run the regression model.</li>
<li>I did this step since later we will be calculating the standard deviations of the explanatory and response variables for <em>just the values included in the regression model</em>. It’ll be easier to do this if we remove the missing values now.</li>
</ul>
</div>
</div>
</section>
<section id="three-types-of-study-design-there-are-more" class="level2">
<h2 class="anchored" data-anchor-id="three-types-of-study-design-there-are-more">Three types of study design (there are more)</h2>
<div class="columns">
<div class="column" style="width:33%;">
<div class="definition">
<div class="def-title">
<p>Experiment</p>
</div>
<div class="def-cont">
<ul>
<li><p>Observational units are randomly assigned to important predictor levels</p>
<ul>
<li><p>Random assignment controls for confounding variables (age, gender, race, etc.)</p></li>
<li><p>“gold standard” for determining causality</p></li>
<li><p>Observational unit is often at the participant-level</p></li>
</ul></li>
</ul>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="example">
<div class="ex-title">
<p>Quasi-experiment</p>
</div>
<div class="ex-cont">
<ul>
<li><p>Participants are assigned to intervention levels without randomization</p></li>
<li><p>Not common study design</p></li>
</ul>
</div>
</div>
</div><div class="column" style="width:33%;">
<div class="proposition">
<div class="prop-title">
<p>Observational</p>
</div>
<div class="prop-cont">
<ul>
<li><p>No randomization or assignment of intervention conditions</p></li>
<li><p>In general cannot infer causality</p>
<ul>
<li>However, there are casual inference methods…</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="lets-revisit-the-regression-analysis-process" class="level2">
<h2 class="anchored" data-anchor-id="lets-revisit-the-regression-analysis-process">Let’s revisit the regression analysis process</h2>
<p>&nbsp; &nbsp;</p>
<p><img src="images/arrow2.png" class="absolute img-fluid" data-top="17%" data-right="63.15%" width="155"> <img src="images/arrow2.png" class="absolute img-fluid" data-top="17%" data-right="28.7%" width="155"><img src="images/arrow_back4.png" class="absolute img-fluid" data-top="10%" data-right="30.7%" width="840"></p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="RAP1">
<div class="RAP1-title">
<p>Model Selection</p>
</div>
<div class="RAP1-cont">
<ul>
<li><p>Building a model</p></li>
<li><p>Prediction vs interpretation</p></li>
<li><p>Comparing models</p></li>
</ul>
</div>
</div>
</div><div class="column" style="width:4%;">

</div><div class="column" style="width:30%;">
<div class="RAP2">
<div class="RAP2-title">
<p>Model Fitting</p>
</div>
<div class="RAP2-cont">
<ul>
<li><p>Parameter estimation</p></li>
<li><p>Interpret model parameters</p></li>
<li><p>Hypothesis tests for coefficients</p></li>
<li><p>Categorical covariates</p></li>
<li><p>Interactions</p></li>
</ul>
</div>
</div>
</div><div class="column" style="width:4%;">

</div><div class="column" style="width:30%;">
<div class="RAP3">
<div class="RAP3-title">
<p>Model Evaluation</p>
</div>
<div class="RAP3-cont">
<ul>
<li>Evaluation of full and reduced models</li>
<li>Testing model assumptions</li>
<li>Residuals</li>
<li>Transformations</li>
<li>Influential points</li>
<li>Multicollinearity</li>
</ul>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="learning-objectives-2" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li>Identify the aims of your research and see how they align with the intended purpose of simple linear regression</li>
</ol>
<div class="lob">
<ol start="2" type="1">
<li>Identify the simple linear regression model and define statistics language for key notation</li>
</ol>
</div>
<ol start="3" type="1">
<li><p>Illustrate how ordinary least squares (OLS) finds the best model parameter estimates</p></li>
<li><p>Solve the optimal coefficient estimates for simple linear regression using OLS</p></li>
<li><p>Apply OLS in R for simple linear regression of real data</p></li>
</ol>
<section id="simple-linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression-model">Simple Linear Regression Model</h2>
<p>The (population) regression model is denoted by:</p>
<p>&nbsp;</p>
<div class="heq">
<p><span class="math display">\[Y =  \beta_0 + \beta_1X + \epsilon\]</span></p>
</div>
<p>&nbsp;</p>
<div class="columns">
<div class="column">
<section id="observable-sample-data" class="level4">
<h4 class="anchored" data-anchor-id="observable-sample-data">Observable sample data</h4>
<ul>
<li><p><span class="math inline">\(Y\)</span> is our dependent variable</p>
<ul>
<li>Aka outcome or response variable</li>
</ul></li>
<li><p><span class="math inline">\(X\)</span> is our independent variable</p>
<ul>
<li>Aka predictor, regressor, exposure variable</li>
</ul></li>
</ul>
</section>
</div><div class="column">
<section id="unobservable-population-parameters" class="level4">
<h4 class="anchored" data-anchor-id="unobservable-population-parameters">Unobservable population parameters</h4>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are <strong>unknown</strong> population parameters</p></li>
<li><p><span class="math inline">\(\epsilon\)</span> (epsilon) is the error about the line</p>
<ul>
<li><p>It is assumed to be a random variable with a…</p>
<ul>
<li><p>Normal distribution with mean 0 and constant variance <span class="math inline">\(\sigma^2\)</span></p></li>
<li><p>i.e.&nbsp;<span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></p></li>
</ul></li>
</ul></li>
</ul>
</section>
</div>
</div>
</section>
<section id="simple-linear-regression-model-another-way-to-view-components" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression-model-another-way-to-view-components">Simple Linear Regression Model (another way to view components)</h2>
<p>The (population) regression model is denoted by:</p>
<p>&nbsp;</p>
<div class="heq">
<p><span class="math display">\[Y =  \beta_0 + \beta_1X + \epsilon\]</span></p>
</div>
<p>&nbsp;</p>
<section id="components" class="level3">
<h3 class="anchored" data-anchor-id="components">Components</h3>
<table class="table">
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y\)</span></td>
<td>response, outcome, dependent variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>intercept</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>slope</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span></td>
<td>predictor, covariate, independent variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>residuals, error term</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="if-the-population-parameters-are-unobservable-how-did-we-get-the-line-for-life-expectancy" class="level2">
<h2 class="anchored" data-anchor-id="if-the-population-parameters-are-unobservable-how-did-we-get-the-line-for-life-expectancy">If the population parameters are unobservable, how did we get the line for life expectancy?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 188 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (2): life_expectancy_years_2011, female_literacy_rate_2011

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<div class="hl">
<p>Note: the <strong>population model is the true, underlying model</strong> that we are trying to estimate using our sample data</p>
<ul>
<li>Our goal in simple linear regression is to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span></li>
</ul>
</div>
</section>
<section id="okay-so-how-do-we-estimate-the-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="okay-so-how-do-we-estimate-the-regression-line">Okay, so how do we estimate the regression line?</h2>
<p>&nbsp;</p>
<p>At this point, we are going to move over to an R shiny app that I made.</p>
<p>&nbsp;</p>
<p>Let’s see if we can eyeball the best-fit line!</p>
</section>
<section id="regression-line-best-fit-line" class="level2">
<h2 class="anchored" data-anchor-id="regression-line-best-fit-line">Regression line = best-fit line</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\widehat{Y} = \widehat{\beta}_0 + \widehat{\beta}_1 X \]</span></p>
<ul>
<li><span class="math inline">\(\widehat{Y}\)</span> is the predicted outcome for a specific value of <span class="math inline">\(X\)</span></li>
<li><span class="math inline">\(\widehat{\beta}_0\)</span> is the intercept <em>of the best-fit line</em></li>
<li><span class="math inline">\(\widehat{\beta}_1\)</span> is the slope <em>of the best-fit line</em>, i.e., the increase in <span class="math inline">\(\widehat{Y}\)</span> for every increase of one (unit increase) in <span class="math inline">\(X\)</span>
<ul>
<li>slope = <em>rise over run</em></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 188 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (2): life_expectancy_years_2011, female_literacy_rate_2011

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="1056"></p>
</div>
</div>
</div>
</div>
</section>
<section id="simple-linear-regression-model-1" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression-model-1">Simple Linear Regression Model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<section id="population-regression-line" class="level4">
<h4 class="anchored" data-anchor-id="population-regression-line">Population regression line</h4>
<div class="lob">
<p><span class="math display">\[Y =  \beta_0 + \beta_1X + \epsilon\]</span></p>
</div>
<p>&nbsp;</p>
<section id="components-1" class="level5">
<h5 class="anchored" data-anchor-id="components-1">Components</h5>
<table class="table">
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y\)</span></td>
<td>response, outcome, dependent variable</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\beta_0\)</span></td>
<td>intercept</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\beta_1\)</span></td>
<td>slope</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span></td>
<td>predictor, covariate, independent variable</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\epsilon\)</span></td>
<td>residuals, error term</td>
</tr>
</tbody>
</table>
</section>
</section>
</div><div class="column" style="width:50%;">
<section id="estimated-regression-line" class="level4">
<h4 class="anchored" data-anchor-id="estimated-regression-line">Estimated regression line</h4>
<div class="hl">
<p><span class="math display">\[\widehat{Y} =  \widehat{\beta}_0 + \widehat{\beta}_1X\]</span></p>
</div>
<p>&nbsp;</p>
<section id="components-2" class="level5">
<h5 class="anchored" data-anchor-id="components-2">Components</h5>
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 70%">
</colgroup>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\widehat{Y}\)</span></td>
<td><em>estimated expected</em> response given predictor <span class="math inline">\(X\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\widehat{\beta}_0\)</span></td>
<td><em>estimated</em> intercept</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\widehat{\beta}_1\)</span></td>
<td><em>estimated</em> slope</td>
</tr>
<tr class="even">
<td><span class="math inline">\(X\)</span></td>
<td>predictor, covariate, independent variable</td>
</tr>
</tbody>
</table>
</section>
</section>
</div>
</div>
</section>
<section id="we-get-it-nicky-how-do-we-estimate-the-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="we-get-it-nicky-how-do-we-estimate-the-regression-line">We get it, Nicky! How do we estimate the regression line?</h2>
</section>
</section>
<section id="learning-objectives-3" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Identify the aims of your research and see how they align with the intended purpose of simple linear regression</p></li>
<li><p>Identify the simple linear regression model and define statistics language for key notation</p></li>
</ol>
<div class="lob">
<ol start="3" type="1">
<li>Illustrate how ordinary least squares (OLS) finds the best model parameter estimates</li>
</ol>
</div>
<ol start="4" type="1">
<li><p>Solve the optimal coefficient estimates for simple linear regression using OLS</p></li>
<li><p>Apply OLS in R for simple linear regression of real data</p></li>
</ol>
<section id="it-all-starts-with-a-residual" class="level2">
<h2 class="anchored" data-anchor-id="it-all-starts-with-a-residual">It all starts with a residual…</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Recall, one characteristic of our population model was that the residuals, <span class="math inline">\(\epsilon\)</span>, were Normally distributed: <span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></p></li>
<li><p>In our population regression model, we had: <span class="math display">\[Y =  \beta_0 + \beta_1X + \epsilon\]</span></p></li>
<li><p>We can also take the average (expected) value of the population model</p></li>
<li><p>We take the expected value of both sides and get:</p></li>
</ul>
<p><span class="math display">\[\begin{aligned}
        E[Y] &amp; = E[\beta_0 + \beta_1X + \epsilon] \\
        E[Y] &amp; = E[\beta_0] + E[\beta_1X] + E[\epsilon] \\
        E[Y] &amp; = \beta_0 + \beta_1X + E[\epsilon] \\
        E[Y|X] &amp; = \beta_0 + \beta_1X \\
\end{aligned}\]</span></p>
<ul>
<li>We call <span class="math inline">\(E[Y|X]\)</span> the expected value of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="03_SLR_01/OLSassumptions-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="so-now-we-have-two-representations-of-our-population-model" class="level2">
<h2 class="anchored" data-anchor-id="so-now-we-have-two-representations-of-our-population-model">So now we have two representations of our population model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="definition">
<div class="def-title">
<p>With observed values:</p>
</div>
<div class="def-cont">
<p><span class="math display">\[Y =  \beta_0 + \beta_1X + \epsilon\]</span></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="fact">
<div class="fact-title">
<p>With the population expected value of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span>:</p>
</div>
<div class="fact-cont">
<p><span class="math display">\[E[Y|X] = \beta_0 + \beta_1X\]</span></p>
</div>
</div>
</div>
</div>
<p>Using the two forms of the model, we can figure out a formula for our residuals:</p>
<p><span class="math display">\[\begin{aligned}
Y &amp; = (\beta_0 + \beta_1X) + \epsilon \\
Y &amp; = E[Y|X] + \epsilon \\
Y - E[Y|X] &amp; = \epsilon \\
\epsilon &amp; = Y - E[Y|X]
\end{aligned}\]</span></p>
<p>And so we have our true, population model, residuals!</p>
<div class="hl">
<p>This is an important fact! For the population model, the residuals: <span class="math inline">\(\epsilon = Y - E[Y|X]\)</span></p>
</div>
</section>
<section id="back-to-our-estimated-model" class="level2">
<h2 class="anchored" data-anchor-id="back-to-our-estimated-model">Back to our estimated model</h2>
<p>Get to: <span class="math inline">\(\widehat{\epsilon} = Y - \widehat{E}[Y|X] = Y - \widehat{Y}\)</span></p>
</section>
<section id="translate-eyeballing-to-mathematical-form" class="level2">
<h2 class="anchored" data-anchor-id="translate-eyeballing-to-mathematical-form">Translate eyeballing to mathematical form??</h2>
<p><img src="images/Screenshot 2024-01-13 at 11.41.54 AM.png" class="img-fluid"></p>
</section>
<section id="coefficient-estimates" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-estimates">Coefficient estimates</h2>
</section>
</section>
<section id="learning-objectives-4" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Identify the aims of your research and see how they align with the intended purpose of simple linear regression</p></li>
<li><p>Identify the simple linear regression model and define statistics language for key notation</p></li>
<li><p>Illustrate how ordinary least squares (OLS) finds the best model parameter estimates</p></li>
</ol>
<div class="lob">
<ol start="4" type="1">
<li>Solve the optimal coefficient estimates for simple linear regression using OLS</li>
</ol>
</div>
<ol start="5" type="1">
<li>Apply OLS in R for simple linear regression of real data</li>
</ol>
<section id="regression-in-r-lm-summary-tidy" class="level2">
<h2 class="anchored" data-anchor-id="regression-in-r-lm-summary-tidy">Regression in R: <code>lm()</code>, <code>summary()</code>, &amp; <code>tidy()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> gapm)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, 
    data = gapm)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.299  -2.670   1.145   4.114   9.498 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               50.92790    2.66041  19.143  &lt; 2e-16 ***
female_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.142 on 78 degrees of freedom
  (108 observations deleted due to missingness)
Multiple R-squared:  0.4109,    Adjusted R-squared:  0.4034 
F-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="baldmtbuum" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#baldmtbuum table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#baldmtbuum thead, #baldmtbuum tbody, #baldmtbuum tfoot, #baldmtbuum tr, #baldmtbuum td, #baldmtbuum th {
  border-style: none;
}

#baldmtbuum p {
  margin: 0;
  padding: 0;
}

#baldmtbuum .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#baldmtbuum .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#baldmtbuum .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#baldmtbuum .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#baldmtbuum .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#baldmtbuum .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baldmtbuum .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#baldmtbuum .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#baldmtbuum .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#baldmtbuum .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#baldmtbuum .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#baldmtbuum .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#baldmtbuum .gt_spanner_row {
  border-bottom-style: hidden;
}

#baldmtbuum .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#baldmtbuum .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#baldmtbuum .gt_from_md > :first-child {
  margin-top: 0;
}

#baldmtbuum .gt_from_md > :last-child {
  margin-bottom: 0;
}

#baldmtbuum .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#baldmtbuum .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#baldmtbuum .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#baldmtbuum .gt_row_group_first td {
  border-top-width: 2px;
}

#baldmtbuum .gt_row_group_first th {
  border-top-width: 2px;
}

#baldmtbuum .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#baldmtbuum .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#baldmtbuum .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#baldmtbuum .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baldmtbuum .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#baldmtbuum .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#baldmtbuum .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#baldmtbuum .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#baldmtbuum .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baldmtbuum .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#baldmtbuum .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#baldmtbuum .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#baldmtbuum .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#baldmtbuum .gt_left {
  text-align: left;
}

#baldmtbuum .gt_center {
  text-align: center;
}

#baldmtbuum .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#baldmtbuum .gt_font_normal {
  font-weight: normal;
}

#baldmtbuum .gt_font_bold {
  font-weight: bold;
}

#baldmtbuum .gt_font_italic {
  font-style: italic;
}

#baldmtbuum .gt_super {
  font-size: 65%;
}

#baldmtbuum .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#baldmtbuum .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#baldmtbuum .gt_indent_1 {
  text-indent: 5px;
}

#baldmtbuum .gt_indent_2 {
  text-indent: 10px;
}

#baldmtbuum .gt_indent_3 {
  text-indent: 15px;
}

#baldmtbuum .gt_indent_4 {
  text-indent: 20px;
}

#baldmtbuum .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Regression equation for our model:</p>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot \textrm{female literacy rate} \]</span></p>
</section>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li><strong>Observed values</strong> <span class="math inline">\(y_i\)</span>
<ul>
<li>the values in the dataset</li>
</ul></li>
<li><strong>Fitted values</strong> <span class="math inline">\(\widehat{y}_i\)</span>
<ul>
<li>the values that fall on the best-fit line for a specific <span class="math inline">\(x_i\)</span></li>
</ul></li>
<li><strong>Residuals</strong> <span class="math inline">\(e_i = y_i - \widehat{y}_i\)</span>
<ul>
<li>the differences between the observed and fitted values</li>
</ul></li>
</ul>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, 
    data = gapm)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.299  -2.670   1.145   4.114   9.498 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               50.92790    2.66041  19.143  &lt; 2e-16 ***
female_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.142 on 78 degrees of freedom
  (108 observations deleted due to missingness)
Multiple R-squared:  0.4109,    Adjusted R-squared:  0.4034 
F-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2942.635</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="the-population-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="the-population-regression-model">The (population) regression model</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>The (population) regression model is denoted by</li>
</ul>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \epsilon\]</span></p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are unknown population parameters</li>
<li><span class="math inline">\(\epsilon\)</span> (epsilon) is the error about the line
<ul>
<li>It is assumed to be a random variable:
<ul>
<li><span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span></li>
<li>variance <span class="math inline">\(\sigma^2\)</span> is constant</li>
</ul></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/OLSassumptions-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<div style="font-size: 60%;">
<p><a href="https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions" class="uri">https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions</a></p>
</div>
</div>
</div>
<ul>
<li><p>The <span style="color:blue"><strong>line</strong></span> is the average (expected) value of <span class="math inline">\(Y\)</span> given a value of <span class="math inline">\(x\)</span>: <span style="color:blue"><span class="math inline">\(E(Y|x)\)</span></span>.</p></li>
<li><p>The point estimates for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> based on a sample are denoted by <span class="math inline">\(b_0, b_1, s_{residuals}^2\)</span></p>
<ul>
<li>Note: also common notation is <span class="math inline">\(\widehat{\beta}_0, \widehat{\beta}_1, \widehat{\sigma}^2\)</span></li>
</ul></li>
</ul>
</section>
<section id="how-do-we-interpret-the-coefficients" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-interpret-the-coefficients">How do we interpret the coefficients?</h2>
<ul>
<li><strong>Intercept</strong>
<ul>
<li>The expected outcome for the <span class="math inline">\(y\)</span>-variable when the <span class="math inline">\(x\)</span>-variable is 0</li>
</ul></li>
<li><strong>Slope</strong>
<ul>
<li>For every increase of 1 unit in the <span class="math inline">\(x\)</span>-variable, there is an expected increase of, on average, <span class="math inline">\(b_1\)</span> units in the <span class="math inline">\(y\)</span>-variable.</li>
<li>We only say that there is an expected increase and not necessarily a causal increase.</li>
</ul></li>
</ul>
</section>
</section>
<section id="next-class" class="level1">
<h1>Next class???</h1>
<section id="what-are-the-line-conditions" class="level2">
<h2 class="anchored" data-anchor-id="what-are-the-line-conditions">What are the LINE conditions?</h2>
<p>For “good” model fit and to be able to make inferences and predictions based on our models, 4 conditions need to be satisfied.</p>
<p>Briefly:</p>
<ul>
<li><strong>L</strong> inearity of relationship between variables</li>
<li><strong>I</strong> ndependence of the Y values</li>
<li><strong>N</strong> ormality of the residuals</li>
<li><strong>E</strong> quality of variance of the residuals (homoscedasticity)</li>
</ul>
<p><a href="https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions">More in depth</a>:</p>
<ul>
<li><strong>L</strong> : there is a linear relationship between the mean response (Y) and the explanatory variable (X),</li>
<li><strong>I</strong> : the errors are independent—there’s no connection between how far any two points lie from the regression line,</li>
<li><strong>N</strong> : the responses are normally distributed at each level of X, and</li>
<li><strong>E</strong> : the variance or, equivalently, the standard deviation of the responses is equal for all levels of X.</li>
</ul>
</section>
<section id="l-linearity-of-relationship-between-variables" class="level2">
<h2 class="anchored" data-anchor-id="l-linearity-of-relationship-between-variables">L: Linearity of relationship between variables</h2>
<p>Is the association between the variables linear?</p>
<ul>
<li>Diagnostic tools:
<ul>
<li>Scatterplot</li>
<li>Residual plot (see later section for E : Equality of variance of the residuals)</li>
</ul></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="i-independence-of-the-residuals-y-values" class="level2">
<h2 class="anchored" data-anchor-id="i-independence-of-the-residuals-y-values">I: Independence of the residuals (<span class="math inline">\(Y\)</span> values)</h2>
<ul>
<li><p><strong>Are the data points independent of each other?</strong></p></li>
<li><p>Examples of when they are <em>not</em> independent, include</p>
<ul>
<li>repeated measures (such as baseline, 3 months, 6 months)</li>
<li>data from clusters, such as different hospitals or families</li>
</ul></li>
<li><p>This condition is checked by reviewing the study <em>design</em> and not by inspecting the data</p></li>
<li><p>How to analyze data using regression models when the <span class="math inline">\(Y\)</span>-values are not independent is covered in BSTA 519 (Longitudinal data)</p></li>
</ul>
</section>
</section>
<section id="n-normality-of-the-residuals" class="level1">
<h1>N: Normality of the residuals</h1>
<ul>
<li>Extract residuals from regression model in R</li>
<li>Diagnostic tools:
<ul>
<li>Distribution plots of residuals</li>
<li>QQ plots</li>
</ul></li>
</ul>
<section id="n-normality-of-the-residuals-1" class="level2">
<h2 class="anchored" data-anchor-id="n-normality-of-the-residuals-1">N: Normality of the residuals</h2>
<ul>
<li>The responses Y are normally distributed at each level of x</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/OLSassumptions-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
<div style="font-size: 60%;">
<p><a href="https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions" class="uri">https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions</a></p>
</div>
</section>
<section id="extract-models-residuals-in-r" class="level2">
<h2 class="anchored" data-anchor-id="extract-models-residuals-in-r">Extract model’s residuals in R</h2>
<ul>
<li>First extract the residuals’ values from the model output using the <code>augment()</code> function from the <code>broom</code> package.</li>
<li>Get a tibble with the orginal data, as well as the residuals and some other important values.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> gapm)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>aug1 <span class="ot">&lt;-</span> <span class="fu">augment</span>(model1) </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(aug1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 9
$ .rownames                  &lt;chr&gt; "1", "2", "5", "6", "7", "8", "14", "22", "…
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ .fitted                    &lt;dbl&gt; 53.94643, 73.14897, 64.53453, 74.00809, 73.…
$ .resid                     &lt;dbl&gt; 2.7535654, 3.5510294, -3.6345319, 2.8919074…
$ .hat                       &lt;dbl&gt; 0.13628996, 0.01768176, 0.02645854, 0.02077…
$ .sigma                     &lt;dbl&gt; 6.172684, 6.168414, 6.167643, 6.172935, 6.1…
$ .cooksd                    &lt;dbl&gt; 1.835891e-02, 3.062372e-03, 4.887448e-03, 2…
$ .std.resid                 &lt;dbl&gt; 0.48238134, 0.58332052, -0.59972251, 0.4757…</code></pre>
</div>
</div>
</section>
<section id="check-normality-with-usual-distribution-plots" class="level2">
<h2 class="anchored" data-anchor-id="check-normality-with-usual-distribution-plots">Check normality with “usual” distribution plots</h2>
<p>Note that below I save each figure, and then combine them together in one row of output using <code>grid.arrange()</code> from the <code>gridExtra</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>hist1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>density1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>box1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">x =</span> .resid)) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra) <span class="co"># NEW!!!</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(hist1, density1, box1, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
</section>
<section id="normal-qq-plots-qq-quantile-quantile" class="level2">
<h2 class="anchored" data-anchor-id="normal-qq-plots-qq-quantile-quantile">Normal QQ plots (QQ = quantile-quantile)</h2>
<ul>
<li>It can be tricky to eyeball with a histogram or density plot whether the residuals are normal or not</li>
<li>QQ plots are often used to help with this</li>
</ul>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><em>Vertical axis</em>: <strong>data quantiles</strong>
<ul>
<li>data points are sorted in order and</li>
<li>assigned quantiles based on how many data points there are</li>
</ul></li>
<li><em>Horizontal axis</em>: <strong>theoretical quantiles</strong>
<ul>
<li>mean and standard deviation (SD) calculated from the data points</li>
<li>theoretical quantiles are calculated for each point, assuming the data are modeled by a normal distribution with the mean and SD of the data</li>
</ul></li>
</ul>
</div><div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>
<ul>
<li><strong>Data are approximately normal if points fall on a line.</strong></li>
</ul>
<p>See more info at <a href="https://data.library.virginia.edu/understanding-QQ-plots/" class="uri">https://data.library.virginia.edu/understanding-QQ-plots/</a></p>
</section>
<section id="examples-of-normal-qq-plots-15" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-normal-qq-plots-15">Examples of Normal QQ plots (1/5)</h2>
<ul>
<li><strong>Data</strong>:
<ul>
<li>Body measurements from 507 physically active individuals</li>
<li>in their 20’s or early 30’s</li>
<li>within normal weight range.</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/qq_wristdiam.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="examples-of-normal-qq-plots-25" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-normal-qq-plots-25">Examples of Normal QQ plots (2/5)</h2>
<p>Skewed right distribution</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/qq_weights.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="examples-of-normal-qq-plots-35" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-normal-qq-plots-35">Examples of Normal QQ plots (3/5)</h2>
<p>Long tails in distribution</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/qq_biliac.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="examples-of-normal-qq-plots-45" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-normal-qq-plots-45">Examples of Normal QQ plots (4/5)</h2>
<p>Bimodal distribution</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/qq_forearm.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="examples-of-normal-qq-plots-55" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-normal-qq-plots-55">Examples of Normal QQ plots (5/5)</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/qq_forearm_gender.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
<section id="qq-plot-of-residuals-of-model1" class="level2">
<h2 class="anchored" data-anchor-id="qq-plot-of-residuals-of-model1">QQ plot of residuals of <code>model1</code></h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span>     <span class="co"># points</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>()  <span class="co"># line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</div>
</div>
</section>
<section id="compare-to-randomly-generated-normal-qq-plots" class="level2">
<h2 class="anchored" data-anchor-id="compare-to-randomly-generated-normal-qq-plots">Compare to randomly generated Normal QQ plots</h2>
<p>How “<em>good</em>” we can expect a QQ plot to look depends on the sample size.</p>
<ul>
<li><p>The QQ plots on the next slides are randomly generated</p>
<ul>
<li>using random samples from actual standard normal distributions <span class="math inline">\(N(0,1)\)</span>.</li>
</ul></li>
<li><p>Thus, all the points in the QQ plots <strong>should theoretically</strong> fall in a line</p></li>
<li><p>However, there is sampling variability…</p></li>
</ul>
</section>
<section id="randomly-generated-normal-qq-plots-n100" class="level2">
<h2 class="anchored" data-anchor-id="randomly-generated-normal-qq-plots-n100">Randomly generated Normal QQ plots: n=100</h2>
<ul>
<li>Note that <code>stat_qq_line()</code> doesn’t work with randomly generated samples, and thus the code below manually creates the line that the points should be on (which is <span class="math inline">\(y=x\)</span> in this case.)</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 90%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="examples-of-simulated-normal-qq-plots-n10" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-simulated-normal-qq-plots-n10">Examples of simulated Normal QQ plots: n=10</h2>
<p>With fewer data points,</p>
<ul>
<li>simulated QQ plots are more likely to look “less normal”</li>
<li>even though the data points were sampled from normal distributions.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 90%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># only change made to code!</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="examples-of-simulated-normal-qq-plots-n1000" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-simulated-normal-qq-plots-n1000">Examples of simulated Normal QQ plots: n=1,000</h2>
<p>With more data points,</p>
<ul>
<li>simulated QQ plots are more likely to look “more normal”</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div style="font-size: 90%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>samplesize <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># only change made to code!</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>rand_qq1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># line y=x</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>) </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>rand_qq2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>rand_qq3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>rand_qq4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">rnorm</span>(samplesize))) <span class="sc">+</span> </span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(rand_qq1, rand_qq2, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>             rand_qq3, rand_qq4, <span class="at">ncol =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
</section>
<section id="back-to-our-example" class="level2">
<h2 class="anchored" data-anchor-id="back-to-our-example">Back to our example</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Residuals from Life Expectancy vs.&nbsp;Female Literacy Rate Regression</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<p>Simulated QQ plot of Normal Residuals with n = 80</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of observations </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># in fitted model</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample =</span> <span class="fu">rnorm</span>(<span class="dv">80</span>))) <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="e-equality-of-variance-of-the-residuals" class="level1 nostretch">
<h1 class="nostretch">E: Equality of variance of the residuals</h1>
<ul>
<li>Homoscedasticity</li>
<li>Diagnostic tool: <strong>residual plot</strong></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/OLSassumptions-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
<div style="font-size: 60%;">
<p><a href="https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions" class="uri">https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions</a></p>
</div>
<section id="residual-plot" class="level2">
<h2 class="anchored" data-anchor-id="residual-plot">Residual plot</h2>
<ul>
<li><span class="math inline">\(x\)</span> = explanatory variable from regression model
<ul>
<li>(or the fitted values for a multiple regression)</li>
</ul></li>
<li><span class="math inline">\(y\)</span> = residuals from regression model</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(aug1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] ".rownames"                  "life_expectancy_years_2011"
[3] "female_literacy_rate_2011"  ".fitted"                   
[5] ".resid"                     ".hat"                      
[7] ".sigma"                     ".cooksd"                   
[9] ".std.resid"                </code></pre>
</div>
</div>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(aug1, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> female_literacy_rate_2011, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="dv">0</span>, </span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="dv">0</span>, </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Residual plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="576"></p>
</div>
</div>
</div>
</div>
</section>
<section id="e-equality-of-variance-of-the-residuals-homoscedasticity" class="level2">
<h2 class="anchored" data-anchor-id="e-equality-of-variance-of-the-residuals-homoscedasticity">E: Equality of variance of the residuals (Homoscedasticity)</h2>
<ul>
<li>The <strong>variance</strong> or, equivalently, the standard deviation of the responses is <strong>equal for all values of x</strong>.</li>
<li>This is called <strong>homoskedasticity</strong> (top row)</li>
<li>If there is <strong>heteroskedasticity</strong> (bottom row), then the assumption is not met.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/heteroskedastic.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section>
</section>
<section id="r2-coefficient-of-determination" class="level1">
<h1><span class="math inline">\(R^2\)</span> = Coefficient of determination</h1>
<p>Another way to assess model fit</p>
<section id="r2-coefficient-of-determination-12" class="level2">
<h2 class="anchored" data-anchor-id="r2-coefficient-of-determination-12"><span class="math inline">\(R^2\)</span> = Coefficient of determination (1/2)</h2>
<ul>
<li>Recall that the correlation coefficient <span class="math inline">\(r\)</span> measures the strength of the linear relationship between two numerical variables</li>
<li><span class="math inline">\(R^2\)</span> is usually used to measure the strength of a <em>linear fit</em>
<ul>
<li>For a simple linear regression model (one numerical predictor), <span class="math inline">\(R^2\)</span> is just the square of the correlation coefficient</li>
</ul></li>
<li>In general, <span class="math inline">\(R^2\)</span> is the proportion of the variability of the dependent variable that is <strong>explained</strong> by the independent variable(s)</li>
</ul>
<p><span class="math display">\[R^2 = \frac{\textrm{variance of predicted y-values}}
{\textrm{variance of observed y-values}} = \frac{\sum_{i=1}^n(\widehat{y}_i-\bar{y})^2}
{\sum_{i=1}^n(y_i-\bar{y})^2}
= \frac{s_y^2 - s_{\textrm{residuals}}^2}
{s_y^2}\]</span> <span class="math display">\[R^2 = 1- \frac{s_{\textrm{residuals}}^2}
{s_y^2}\]</span> where <span class="math inline">\(\frac{s_{\textrm{residuals}}^2}{s_y^2}\)</span> is the proportion of “unexplained” variability in the <span class="math inline">\(y\)</span> values,<br>
and thus <span class="math inline">\(R^2 = 1- \frac{s_{\textrm{residuls}}^2}{s_y^2}\)</span> is the proportion of “explained” variability in the <span class="math inline">\(y\)</span> values</p>
</section>
<section id="r2-coefficient-of-determination-22" class="level2">
<h2 class="anchored" data-anchor-id="r2-coefficient-of-determination-22"><span class="math inline">\(R^2\)</span> = Coefficient of determination (2/2)</h2>
<ul>
<li><p>Recall, <span class="math inline">\(-1&lt;r&lt;1\)</span></p></li>
<li><p>Thus, <span class="math inline">\(0&lt;R^2&lt;1\)</span></p></li>
<li><p>In practice, we want “high” <span class="math inline">\(R^2\)</span> values, i.e.&nbsp;<span class="math inline">\(R^2\)</span> as close to 1 as possible.</p></li>
</ul>
<p>Calculating <span class="math inline">\(R^2\)</span> in R using <code>glance()</code> from the <code>broom</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.411         0.403  6.14      54.4 1.50e-10     1  -258.  521.  529.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4109366</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>A model can have a high <span class="math inline">\(R^2\)</span> value when there is a curved pattern.</li>
<li>Always first check whether a linear model is reasonable or not.</li>
</ul>
</div>
</div>
</section>
<section id="r2-in-summary-r-output" class="level2">
<h2 class="anchored" data-anchor-id="r2-in-summary-r-output"><span class="math inline">\(R^2\)</span> in <code>summary()</code> R output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = life_expectancy_years_2011 ~ female_literacy_rate_2011, 
    data = gapm)

Residuals:
    Min      1Q  Median      3Q     Max 
-22.299  -2.670   1.145   4.114   9.498 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               50.92790    2.66041  19.143  &lt; 2e-16 ***
female_literacy_rate_2011  0.23220    0.03148   7.377  1.5e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.142 on 78 degrees of freedom
  (108 observations deleted due to missingness)
Multiple R-squared:  0.4109,    Adjusted R-squared:  0.4034 
F-statistic: 54.41 on 1 and 78 DF,  p-value: 1.501e-10</code></pre>
</div>
</div>
<p>Compare to the square of the correlation coefficient <span class="math inline">\(r\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(<span class="at">x =</span> gapm<span class="sc">$</span>life_expectancy_years_2011, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> gapm<span class="sc">$</span>female_literacy_rate_2011,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">use =</span>  <span class="st">"complete.obs"</span>)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>r</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6410434</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>r<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4109366</code></pre>
</div>
</div>
</section>
</section>
<section id="regression-inference" class="level1">
<h1>Regression inference</h1>
<ol type="1">
<li>Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></li>
<li>CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></li>
<li>Prediction interval for predicting <strong>individual</strong> observations</li>
</ol>
<section id="inference-for-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="inference-for-population-slope-beta_1">Inference for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit regression model:</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(life_expectancy_years_2011 <span class="sc">~</span> female_literacy_rate_2011,</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> gapm)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regression table:</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="co"># conf.int = TRUE part is new! </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="aqjpwglwoo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#aqjpwglwoo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#aqjpwglwoo thead, #aqjpwglwoo tbody, #aqjpwglwoo tfoot, #aqjpwglwoo tr, #aqjpwglwoo td, #aqjpwglwoo th {
  border-style: none;
}

#aqjpwglwoo p {
  margin: 0;
  padding: 0;
}

#aqjpwglwoo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aqjpwglwoo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#aqjpwglwoo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aqjpwglwoo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aqjpwglwoo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqjpwglwoo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqjpwglwoo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aqjpwglwoo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aqjpwglwoo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aqjpwglwoo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aqjpwglwoo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aqjpwglwoo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aqjpwglwoo .gt_spanner_row {
  border-bottom-style: hidden;
}

#aqjpwglwoo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#aqjpwglwoo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aqjpwglwoo .gt_from_md > :first-child {
  margin-top: 0;
}

#aqjpwglwoo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aqjpwglwoo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aqjpwglwoo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#aqjpwglwoo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#aqjpwglwoo .gt_row_group_first td {
  border-top-width: 2px;
}

#aqjpwglwoo .gt_row_group_first th {
  border-top-width: 2px;
}

#aqjpwglwoo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqjpwglwoo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#aqjpwglwoo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#aqjpwglwoo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqjpwglwoo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqjpwglwoo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aqjpwglwoo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#aqjpwglwoo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aqjpwglwoo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aqjpwglwoo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqjpwglwoo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqjpwglwoo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aqjpwglwoo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#aqjpwglwoo .gt_left {
  text-align: left;
}

#aqjpwglwoo .gt_center {
  text-align: center;
}

#aqjpwglwoo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aqjpwglwoo .gt_font_normal {
  font-weight: normal;
}

#aqjpwglwoo .gt_font_bold {
  font-weight: bold;
}

#aqjpwglwoo .gt_font_italic {
  font-style: italic;
}

#aqjpwglwoo .gt_super {
  font-size: 65%;
}

#aqjpwglwoo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#aqjpwglwoo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#aqjpwglwoo .gt_indent_1 {
  text-indent: 5px;
}

#aqjpwglwoo .gt_indent_2 {
  text-indent: 10px;
}

#aqjpwglwoo .gt_indent_3 {
  text-indent: 15px;
}

#aqjpwglwoo .gt_indent_4 {
  text-indent: 20px;
}

#aqjpwglwoo .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<span class="math display">\[\begin{align}
\widehat{y} =&amp; b_0 + b_1 \cdot x\\
\widehat{\text{life expectancy}} =&amp; 50.9 + 0.232 \cdot \text{female literacy rate}
\end{align}\]</span>
<ul>
<li>What are <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_A\)</span>?</li>
<li>How do we calculate the standard error, statistic, <em>p</em>-value, and CI?</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>We can also test &amp; calculate CI for the population intercept</li>
<li>This will be covered in BSTA 512</li>
</ul>
</div>
</div>
</section>
<section id="inference-for-the-population-slope-ci-and-hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="inference-for-the-population-slope-ci-and-hypothesis-test">Inference for the population <span style="color:green"><strong>slope</strong></span>: CI and hypothesis test</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Population model</strong><br>
<em>line + random “noise”</em></p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \varepsilon\]</span> with <span class="math inline">\(\varepsilon \sim N(0,\sigma)\)</span><br>
<span class="math inline">\(\sigma\)</span> is the variability (SD) of the residuals</p>
<p><br></p>
<p><strong>Sample best-fit (least-squares) line:</strong></p>
<p><span class="math display">\[\widehat{y} = b_0 + b_1 \cdot x \]</span></p>
<p>Note: Some sources use <span class="math inline">\(\widehat{\beta}\)</span> instead of <span class="math inline">\(b\)</span>.</p>
</div><div class="column" style="width:50%;">
<ul>
<li>Construct a <strong>95% confidence interval</strong> for the <strong>population slope</strong> <span class="math inline">\(\beta_1\)</span></li>
</ul>
<p><br></p>
<ul>
<li>Conduct the <strong>hypothesis test</strong></li>
</ul>
<span class="math display">\[\begin{align}
H_0 &amp;: \beta_1 = 0\\
\text{vs. } H_A&amp;: \beta_1 \neq 0
\end{align}\]</span>
<p><br></p>
<p><em>Note: R reports p-values for 2-sided tests</em></p>
</div>
</div>
</section>
<section id="ci-for-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="ci-for-population-slope-beta_1">CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<p>Recall the general CI formula:</p>
<p><span class="math display">\[\textrm{Point Estimate} \pm t^*\cdot SE_{\textrm{Point Estimate}}\]</span></p>
<p>For the CI of the coefficient <span class="math inline">\(b_1\)</span> this translates to</p>
<p><span class="math display">\[b_1 \pm t^*\cdot SE_{b_1}\]</span> where <span class="math inline">\(t^*\)</span> is the critical value from a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(df = n -2\)</span>.</p>
<p><br></p>
<p><em>How is</em> <span class="math inline">\(\text{SE}_{b_1}\)</span> <em>calculated?</em> See next slide.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term                  estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             50.9      2.66       19.1  3.33e-31   45.6      56.2  
2 female_literacy_rate…    0.232    0.0315      7.38 1.50e-10    0.170     0.295</code></pre>
</div>
</div>
</section>
<section id="standard-error-of-fitted-slope-b_1" class="level2">
<h2 class="anchored" data-anchor-id="standard-error-of-fitted-slope-b_1">Standard error of fitted slope <span class="math inline">\(b_1\)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[\text{SE}_{b_1} = \frac{s_{\textrm{residuals}}}{s_x\sqrt{n-1}}\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(\text{SE}_{b_1}\)</span> is the <strong>variability</strong> of the statistic <span class="math inline">\(b_1\)</span></p>
</div>
</div>
<div style="font-size: 90%;">
<div class="columns">
<div class="column" style="width:32%;">
<ul>
<li><span class="math inline">\(s_{\textrm{residuals}}^2\)</span> is the sd of the residuals</li>
</ul>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:32%;">
<ul>
<li><span class="math inline">\(s_x\)</span> is the sample sd of the explanatory variable <span class="math inline">\(x\)</span></li>
</ul>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:32%;">
<ul>
<li><span class="math inline">\(n\)</span> is the sample size, or the number of (complete) pairs of points</li>
</ul>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.411         0.403  6.14      54.4 1.50e-10     1  -258.  521.  529.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard deviation of the residuals (Residual standard error in summary() output)</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standard deviation of x's</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of pairs of complete observations</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(se_b1 <span class="ot">&lt;-</span> s_resid<span class="sc">/</span>(s_x <span class="sc">*</span> <span class="fu">sqrt</span>(n<span class="dv">-1</span>))) <span class="co"># compare to SE in regression output</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</section>
<section id="calculate-ci-for-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="calculate-ci-for-population-slope-beta_1">Calculate CI for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[b_1 \pm t^*\cdot SE_{b_1}\]</span></p>
</div><div class="column" style="width:50%;">
<p>where <span class="math inline">\(t^*\)</span> is the <span class="math inline">\(t\)</span>-distribution critical value with <span class="math inline">\(df = n -2\)</span>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="skptloxxdx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#skptloxxdx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#skptloxxdx thead, #skptloxxdx tbody, #skptloxxdx tfoot, #skptloxxdx tr, #skptloxxdx td, #skptloxxdx th {
  border-style: none;
}

#skptloxxdx p {
  margin: 0;
  padding: 0;
}

#skptloxxdx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#skptloxxdx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#skptloxxdx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#skptloxxdx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#skptloxxdx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skptloxxdx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skptloxxdx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skptloxxdx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#skptloxxdx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#skptloxxdx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#skptloxxdx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#skptloxxdx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#skptloxxdx .gt_spanner_row {
  border-bottom-style: hidden;
}

#skptloxxdx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#skptloxxdx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#skptloxxdx .gt_from_md > :first-child {
  margin-top: 0;
}

#skptloxxdx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#skptloxxdx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#skptloxxdx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#skptloxxdx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#skptloxxdx .gt_row_group_first td {
  border-top-width: 2px;
}

#skptloxxdx .gt_row_group_first th {
  border-top-width: 2px;
}

#skptloxxdx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skptloxxdx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#skptloxxdx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#skptloxxdx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skptloxxdx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skptloxxdx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#skptloxxdx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#skptloxxdx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#skptloxxdx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skptloxxdx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skptloxxdx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skptloxxdx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skptloxxdx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skptloxxdx .gt_left {
  text-align: left;
}

#skptloxxdx .gt_center {
  text-align: center;
}

#skptloxxdx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#skptloxxdx .gt_font_normal {
  font-weight: normal;
}

#skptloxxdx .gt_font_bold {
  font-weight: bold;
}

#skptloxxdx .gt_font_italic {
  font-style: italic;
}

#skptloxxdx .gt_super {
  font-size: 65%;
}

#skptloxxdx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#skptloxxdx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#skptloxxdx .gt_indent_1 {
  text-indent: 5px;
}

#skptloxxdx .gt_indent_2 {
  text-indent: 10px;
}

#skptloxxdx .gt_indent_3 {
  text-indent: 15px;
}

#skptloxxdx .gt_indent_4 {
  text-indent: 20px;
}

#skptloxxdx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Save regression output for the row with the slope’s information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>model1_b1 <span class="ot">&lt;-</span><span class="fu">tidy</span>(model1) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"female_literacy_rate_2011"</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>model1_b1 <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ssuggzvcqp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ssuggzvcqp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ssuggzvcqp thead, #ssuggzvcqp tbody, #ssuggzvcqp tfoot, #ssuggzvcqp tr, #ssuggzvcqp td, #ssuggzvcqp th {
  border-style: none;
}

#ssuggzvcqp p {
  margin: 0;
  padding: 0;
}

#ssuggzvcqp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ssuggzvcqp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ssuggzvcqp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ssuggzvcqp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ssuggzvcqp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ssuggzvcqp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ssuggzvcqp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ssuggzvcqp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ssuggzvcqp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ssuggzvcqp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ssuggzvcqp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ssuggzvcqp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ssuggzvcqp .gt_spanner_row {
  border-bottom-style: hidden;
}

#ssuggzvcqp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ssuggzvcqp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ssuggzvcqp .gt_from_md > :first-child {
  margin-top: 0;
}

#ssuggzvcqp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ssuggzvcqp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ssuggzvcqp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ssuggzvcqp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ssuggzvcqp .gt_row_group_first td {
  border-top-width: 2px;
}

#ssuggzvcqp .gt_row_group_first th {
  border-top-width: 2px;
}

#ssuggzvcqp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ssuggzvcqp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ssuggzvcqp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ssuggzvcqp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ssuggzvcqp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ssuggzvcqp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ssuggzvcqp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ssuggzvcqp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ssuggzvcqp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ssuggzvcqp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ssuggzvcqp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ssuggzvcqp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ssuggzvcqp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ssuggzvcqp .gt_left {
  text-align: left;
}

#ssuggzvcqp .gt_center {
  text-align: center;
}

#ssuggzvcqp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ssuggzvcqp .gt_font_normal {
  font-weight: normal;
}

#ssuggzvcqp .gt_font_bold {
  font-weight: bold;
}

#ssuggzvcqp .gt_font_italic {
  font-style: italic;
}

#ssuggzvcqp .gt_super {
  font-size: 65%;
}

#ssuggzvcqp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ssuggzvcqp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ssuggzvcqp .gt_indent_1 {
  text-indent: 5px;
}

#ssuggzvcqp .gt_indent_2 {
  text-indent: 10px;
}

#ssuggzvcqp .gt_indent_3 {
  text-indent: 15px;
}

#ssuggzvcqp .gt_indent_4 {
  text-indent: 20px;
}

#ssuggzvcqp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<p>Save values needed for CI:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>estimate</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>std.error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nobs</span>(model1) <span class="co"># sample size n</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">80-2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>Compare CI bounds below with the ones in the regression table above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>(CI_LB <span class="ot">&lt;-</span> b1 <span class="sc">-</span> tstar<span class="sc">*</span>SE_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1695284</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>(CI_UB <span class="ot">&lt;-</span> b1 <span class="sc">+</span> tstar<span class="sc">*</span>SE_b1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2948619</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="hypothesis-test-for-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-test-for-population-slope-beta_1">Hypothesis test for population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<div class="columns">
<div class="column" style="width:40%;">
<span class="math display">\[\begin{align}
H_0 &amp;: \beta_1 = 0\\
\text{vs. } H_A&amp;: \beta_1 \neq 0
\end{align}\]</span>
</div><div class="column" style="width:60%;">
<p>The <strong>test statistic</strong> for <span class="math inline">\(b_1\)</span> is</p>
<p><span class="math display">\[t = \frac{ b_1 - \beta_1}{ \text{SE}_{b_1}} = \frac{ b_1}{ \text{SE}_{b_1}}\]</span></p>
<p>when we assume <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="oxveeokzut" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oxveeokzut table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oxveeokzut thead, #oxveeokzut tbody, #oxveeokzut tfoot, #oxveeokzut tr, #oxveeokzut td, #oxveeokzut th {
  border-style: none;
}

#oxveeokzut p {
  margin: 0;
  padding: 0;
}

#oxveeokzut .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oxveeokzut .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oxveeokzut .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oxveeokzut .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oxveeokzut .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oxveeokzut .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxveeokzut .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oxveeokzut .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oxveeokzut .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oxveeokzut .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oxveeokzut .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oxveeokzut .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oxveeokzut .gt_spanner_row {
  border-bottom-style: hidden;
}

#oxveeokzut .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oxveeokzut .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oxveeokzut .gt_from_md > :first-child {
  margin-top: 0;
}

#oxveeokzut .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oxveeokzut .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oxveeokzut .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oxveeokzut .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oxveeokzut .gt_row_group_first td {
  border-top-width: 2px;
}

#oxveeokzut .gt_row_group_first th {
  border-top-width: 2px;
}

#oxveeokzut .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxveeokzut .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oxveeokzut .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oxveeokzut .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxveeokzut .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxveeokzut .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oxveeokzut .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oxveeokzut .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oxveeokzut .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxveeokzut .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oxveeokzut .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxveeokzut .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oxveeokzut .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxveeokzut .gt_left {
  text-align: left;
}

#oxveeokzut .gt_center {
  text-align: center;
}

#oxveeokzut .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oxveeokzut .gt_font_normal {
  font-weight: normal;
}

#oxveeokzut .gt_font_bold {
  font-weight: bold;
}

#oxveeokzut .gt_font_italic {
  font-style: italic;
}

#oxveeokzut .gt_super {
  font-size: 65%;
}

#oxveeokzut .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oxveeokzut .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oxveeokzut .gt_indent_1 {
  text-indent: 5px;
}

#oxveeokzut .gt_indent_2 {
  text-indent: 10px;
}

#oxveeokzut .gt_indent_3 {
  text-indent: 15px;
}

#oxveeokzut .gt_indent_4 {
  text-indent: 20px;
}

#oxveeokzut .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Calculate the test statistic using the values in the regression table:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recall model1_b1 is regression table restricted to b1 row</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>(TestStat <span class="ot">&lt;-</span> model1_b1<span class="sc">$</span>estimate <span class="sc">/</span> model1_b1<span class="sc">$</span>std.error)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.376557</code></pre>
</div>
</div>
<p>Compare this test statistic value to the one from the regression table above</p>
</section>
<section id="p-value-for-testing-population-slope-beta_1" class="level2">
<h2 class="anchored" data-anchor-id="p-value-for-testing-population-slope-beta_1"><span class="math inline">\(p\)</span>-value for testing population <span style="color:green"><strong>slope</strong></span> <span class="math inline">\(\beta_1\)</span></h2>
<ul>
<li><p>As usual, the <span class="math inline">\(p\)</span>-value is the <em>probability of obtaining a test statistic</em> <strong>just as extreme or more extreme</strong> <em>than the observed test statistic assuming the null hypothesis</em> <span class="math inline">\(H_0\)</span> <em>is true.</em></p></li>
<li><p>To calculate the <span class="math inline">\(p\)</span>-value, we need to know the probability distribution of the test statistic (the <em>null distribution</em>) assuming <span class="math inline">\(H_0\)</span> is true.</p></li>
<li><p>Statistical theory tells us that the test statistic <span class="math inline">\(t\)</span> can be modeled by a <span style="color:green"><span class="math inline">\(t\)</span>-distribution</span> with <span style="color:green"><span class="math inline">\(df = n-2\)</span></span>.</p></li>
<li><p>Recall that this is a 2-sided test:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pv =</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(TestStat, <span class="at">df=</span><span class="dv">80-2</span>, <span class="at">lower.tail=</span>F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.501286e-10</code></pre>
</div>
</div>
<p>Compare the <span class="math inline">\(p\)</span>-value to the one from the regression table below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()  <span class="co"># compare p-value calculated above to p-value in table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="egbfzlqvei" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#egbfzlqvei table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#egbfzlqvei thead, #egbfzlqvei tbody, #egbfzlqvei tfoot, #egbfzlqvei tr, #egbfzlqvei td, #egbfzlqvei th {
  border-style: none;
}

#egbfzlqvei p {
  margin: 0;
  padding: 0;
}

#egbfzlqvei .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#egbfzlqvei .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#egbfzlqvei .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#egbfzlqvei .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#egbfzlqvei .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#egbfzlqvei .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egbfzlqvei .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#egbfzlqvei .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#egbfzlqvei .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#egbfzlqvei .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#egbfzlqvei .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#egbfzlqvei .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#egbfzlqvei .gt_spanner_row {
  border-bottom-style: hidden;
}

#egbfzlqvei .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#egbfzlqvei .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#egbfzlqvei .gt_from_md > :first-child {
  margin-top: 0;
}

#egbfzlqvei .gt_from_md > :last-child {
  margin-bottom: 0;
}

#egbfzlqvei .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#egbfzlqvei .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#egbfzlqvei .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#egbfzlqvei .gt_row_group_first td {
  border-top-width: 2px;
}

#egbfzlqvei .gt_row_group_first th {
  border-top-width: 2px;
}

#egbfzlqvei .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#egbfzlqvei .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#egbfzlqvei .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#egbfzlqvei .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egbfzlqvei .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#egbfzlqvei .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#egbfzlqvei .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#egbfzlqvei .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#egbfzlqvei .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#egbfzlqvei .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#egbfzlqvei .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#egbfzlqvei .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#egbfzlqvei .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#egbfzlqvei .gt_left {
  text-align: left;
}

#egbfzlqvei .gt_center {
  text-align: center;
}

#egbfzlqvei .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#egbfzlqvei .gt_font_normal {
  font-weight: normal;
}

#egbfzlqvei .gt_font_bold {
  font-weight: bold;
}

#egbfzlqvei .gt_font_italic {
  font-style: italic;
}

#egbfzlqvei .gt_super {
  font-size: 65%;
}

#egbfzlqvei .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#egbfzlqvei .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#egbfzlqvei .gt_indent_1 {
  text-indent: 5px;
}

#egbfzlqvei .gt_indent_2 {
  text-indent: 10px;
}

#egbfzlqvei .gt_indent_3 {
  text-indent: 15px;
}

#egbfzlqvei .gt_indent_4 {
  text-indent: 20px;
}

#egbfzlqvei .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.low">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="conf.high">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td>
<td headers="conf.low" class="gt_row gt_right">45.6314348</td>
<td headers="conf.high" class="gt_row gt_right">56.2243615</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td>
<td headers="conf.low" class="gt_row gt_right">0.1695284</td>
<td headers="conf.high" class="gt_row gt_right">0.2948619</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
</section>
<section id="prediction-inference" class="level1">
<h1>Prediction (&amp; inference)</h1>
<ol type="1">
<li>Prediction for mean response</li>
<li>Prediction for new individual observation</li>
</ol>
<section id="prediction-with-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-regression-line">Prediction with regression line</h2>
<div class="cell">
<div class="cell-output-display">

<div id="oxbwnhizin" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oxbwnhizin table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oxbwnhizin thead, #oxbwnhizin tbody, #oxbwnhizin tfoot, #oxbwnhizin tr, #oxbwnhizin td, #oxbwnhizin th {
  border-style: none;
}

#oxbwnhizin p {
  margin: 0;
  padding: 0;
}

#oxbwnhizin .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oxbwnhizin .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oxbwnhizin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oxbwnhizin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oxbwnhizin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oxbwnhizin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxbwnhizin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oxbwnhizin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oxbwnhizin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oxbwnhizin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oxbwnhizin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oxbwnhizin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oxbwnhizin .gt_spanner_row {
  border-bottom-style: hidden;
}

#oxbwnhizin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oxbwnhizin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oxbwnhizin .gt_from_md > :first-child {
  margin-top: 0;
}

#oxbwnhizin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oxbwnhizin .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oxbwnhizin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oxbwnhizin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oxbwnhizin .gt_row_group_first td {
  border-top-width: 2px;
}

#oxbwnhizin .gt_row_group_first th {
  border-top-width: 2px;
}

#oxbwnhizin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxbwnhizin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oxbwnhizin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oxbwnhizin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxbwnhizin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxbwnhizin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oxbwnhizin .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oxbwnhizin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oxbwnhizin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oxbwnhizin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oxbwnhizin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxbwnhizin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oxbwnhizin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oxbwnhizin .gt_left {
  text-align: left;
}

#oxbwnhizin .gt_center {
  text-align: center;
}

#oxbwnhizin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oxbwnhizin .gt_font_normal {
  font-weight: normal;
}

#oxbwnhizin .gt_font_bold {
  font-weight: bold;
}

#oxbwnhizin .gt_font_italic {
  font-style: italic;
}

#oxbwnhizin .gt_super {
  font-size: 65%;
}

#oxbwnhizin .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oxbwnhizin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oxbwnhizin .gt_indent_1 {
  text-indent: 5px;
}

#oxbwnhizin .gt_indent_2 {
  text-indent: 10px;
}

#oxbwnhizin .gt_indent_3 {
  text-indent: 15px;
}

#oxbwnhizin .gt_indent_4 {
  text-indent: 20px;
}

#oxbwnhizin .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="term">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="estimate">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="std.error">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="statistic">statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="p.value">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="term" class="gt_row gt_left">(Intercept)</td>
<td headers="estimate" class="gt_row gt_right">50.9278981</td>
<td headers="std.error" class="gt_row gt_right">2.66040695</td>
<td headers="statistic" class="gt_row gt_right">19.142898</td>
<td headers="p.value" class="gt_row gt_right">3.325312e-31</td></tr>
    <tr><td headers="term" class="gt_row gt_left">female_literacy_rate_2011</td>
<td headers="estimate" class="gt_row gt_right">0.2321951</td>
<td headers="std.error" class="gt_row gt_right">0.03147744</td>
<td headers="statistic" class="gt_row gt_right">7.376557</td>
<td headers="p.value" class="gt_row gt_right">1.501286e-10</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot \textrm{female literacy rate} \]</span></p>
<p>What is the predicted life expectancy for a country with female literacy rate 60%?</p>
<p><span class="math display">\[\widehat{\textrm{life expectancy}} = 50.9 + 0.232 \cdot 60 = 64.82\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(y_60 <span class="ot">&lt;-</span> <span class="fl">50.9</span> <span class="sc">+</span> <span class="fl">0.232</span><span class="sc">*</span><span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.82</code></pre>
</div>
</div>
<p><br></p>
<ul>
<li>How do we interpret the predicted value?</li>
<li>How variable is it?</li>
</ul>
</section>
<section id="prediction-with-regression-line-1" class="level2">
<h2 class="anchored" data-anchor-id="prediction-with-regression-line-1">Prediction with regression line</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Recall the population model:</p>
<p><em>line + random “noise”</em></p>
<p><span class="math display">\[Y = \beta_0 + \beta_1 \cdot X + \varepsilon\]</span> with <span class="math inline">\(\varepsilon \sim N(0,\sigma)\)</span><br>
<span class="math inline">\(\sigma\)</span> is the variability (SD) of the residuals</p>
<p><br></p>
<ul>
<li>When we take the expected value, at a given value <span class="math inline">\(x^*\)</span>, we have that the predicted response is the average expected response at <span class="math inline">\(x^*\)</span>:</li>
</ul>
<p><span class="math display">\[\widehat{E[Y|x^*]} = b_0 + b_1 x^*\]</span></p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</div>
</div>
<ul>
<li>These are the points on the regression line.</li>
<li>The mean responses has variability, and we can calculate a CI for it, for every value of <span class="math inline">\(x^*\)</span>.</li>
</ul>
</section>
<section id="ci-for-mean-response-mu_yx" class="level2">
<h2 class="anchored" data-anchor-id="ci-for-mean-response-mu_yx">CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h2>
<p><span class="math display">\[\widehat{E[Y|x^*]} \pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\]</span></p>
<ul>
<li><span class="math inline">\(SE_{\widehat{E[Y|x^*]}}\)</span> is calculated using</li>
</ul>
<p><span class="math display">\[SE_{\widehat{E[Y|x^*]}} = s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\]</span></p>
<ul>
<li><span class="math inline">\(\widehat{E[Y|x^*]}\)</span> is the predicted value at the specified point <span class="math inline">\(x^*\)</span> of the explanatory variable</li>
<li><span class="math inline">\(s_{\textrm{residuals}}^2\)</span> is the sd of the residuals</li>
<li><span class="math inline">\(n\)</span> is the sample size, or the number of (complete) pairs of points</li>
<li><span class="math inline">\(\bar{x}\)</span> is the sample mean of the explanatory variable <span class="math inline">\(x\)</span></li>
<li><span class="math inline">\(s_x\)</span> is the sample sd of the explanatory variable <span class="math inline">\(x\)</span></li>
</ul>
<p><br></p>
<ul>
<li>Recall that <span class="math inline">\(t_{n-2}^*\)</span> is calculated using <code>qt()</code> and depends on the confidence level.</li>
</ul>
</section>
<section id="example-ci-for-mean-response-mu_yx" class="level2">
<h2 class="anchored" data-anchor-id="example-ci-for-mean-response-mu_yx">Example: CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h2>
<p><strong>Find the 95% CI for the mean life expectancy when the female literacy rate is 60.</strong></p>
<div style="font-size: 80%;">
<span class="math display">\[\begin{align}
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\\
64.8596 &amp;\pm 1.990847 \cdot s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 6.142157 \sqrt{\frac{1}{80} + \frac{(60 - 81.65375)^2}{(80-1)21.95371^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 0.9675541\\
64.8596 &amp;\pm 1.926252\\
(62.93335 &amp;, 66.78586)
\end{align}\]</span>
</div>
<div style="font-size: 90%;">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>(Y60 <span class="ot">&lt;-</span> <span class="fl">50.9278981</span> <span class="sc">+</span> <span class="fl">0.2321951</span> <span class="sc">*</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.8596</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">78</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>(mx <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(SE_Yx <span class="ot">&lt;-</span> s_resid <span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (<span class="dv">60</span> <span class="sc">-</span> mx)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span>s_x<span class="sc">^</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:32%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(MOE_Yx <span class="ot">&lt;-</span> SE_Yx<span class="sc">*</span>tstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:32%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">-</span> MOE_Yx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:32%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">+</span> MOE_Yx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-using-r-for-ci-for-mean-response-mu_yx" class="level2">
<h2 class="anchored" data-anchor-id="example-using-r-for-ci-for-mean-response-mu_yx">Example: Using R for CI for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h2>
<p><strong>Find the 95% CI’s for the mean life expectancy when the female literacy rate is 40, 60, and 80.</strong></p>
<ul>
<li>Use the base R <code>predict()</code> function</li>
<li>Requires specification of a <code>newdata</code> “value”
<ul>
<li>The <code>newdata</code> value is <span class="math inline">\(x^*\)</span></li>
<li>This has to be in the format of a data frame though</li>
<li>with column name identical to the predictor variable in the model</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">female_literacy_rate_2011 =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">60</span>, <span class="dv">80</span>)) </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>newdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  female_literacy_rate_2011
1                        40
2                        60
3                        80</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model1, </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span>newdata, </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 60.21570 57.26905 63.16236
2 64.85961 62.93335 66.78586
3 69.50351 68.13244 70.87457</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<p>We are 95% confident that the <strong>average</strong> life expectancy for a country with a 60% female literacy rate will be between 62.9 and 66.8 years.</p>
</section>
</div>
</div>
</section>
<section id="confidence-bands-for-mean-response-mu_yx" class="level2">
<h2 class="anchored" data-anchor-id="confidence-bands-for-mean-response-mu_yx">Confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h2>
<ul>
<li>Often we plot the CI for many values of X, creating <strong>confidence bands</strong></li>
<li>The confidence bands are what ggplot creates when we set <code>se = TRUE</code> within <code>geom_smooth</code></li>
<li>For what values of x are the confidence bands (intervals) narrowest?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gapm,</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>female_literacy_rate_2011, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y=</span>life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">se=</span><span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Life expectancy vs. female literacy rate"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="width-of-confidence-bands-for-mean-response-mu_yx" class="level2">
<h2 class="anchored" data-anchor-id="width-of-confidence-bands-for-mean-response-mu_yx">Width of confidence bands for mean response <span class="math inline">\(\mu_{Y|x^*}\)</span></h2>
<ul>
<li>For what values of <span class="math inline">\(x^*\)</span> are the confidence bands (intervals) narrowest? widest?</li>
</ul>
<span class="math display">\[\begin{align}
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot SE_{\widehat{E[Y|x^*]}}\\
\widehat{E[Y|x^*]} &amp;\pm t_{n-2}^* \cdot s_{residuals} \sqrt{\frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}
\end{align}\]</span>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 108 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_vline()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="prediction-interval-for-predicting-individual-observations" class="level2">
<h2 class="anchored" data-anchor-id="prediction-interval-for-predicting-individual-observations">Prediction interval for predicting <strong>individual</strong> observations</h2>
<ul>
<li>We do not call this interval a CI since <span class="math inline">\(Y\)</span> is a random variable instead of a parameter</li>
<li>The form is similar to a CI though:</li>
</ul>
<p><span class="math display">\[\widehat{Y|x^*} \pm t_{n-2}^* \cdot s_{residuals} \sqrt{1 + \frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\]</span></p>
<ul>
<li>Note that the only difference to the CI for a mean value of y is the additional <code>1+</code> under the square root.
<ul>
<li>Thus the width is wider!</li>
</ul></li>
</ul>
</section>
<section id="example-prediction-interval" class="level2">
<h2 class="anchored" data-anchor-id="example-prediction-interval">Example: Prediction interval</h2>
<p><strong>Find the 95% prediction interval for the life expectancy when the female literacy rate is 60.</strong></p>
<span class="math display">\[\begin{align}
\widehat{Y|x^*} &amp;\pm t_{n-2}^* \cdot s_{residuals} \sqrt{1 + \frac{1}{n} + \frac{(x^* - \bar{x})^2}{(n-1)s_x^2}}\\
64.8596 &amp;\pm 1.990847 \cdot 6.142157 \sqrt{1+\frac{1}{80} + \frac{(60 - 81.65375)^2}{(80-1)21.95371^2}}\\
(52.48072 &amp;, 77.23849)
\end{align}\]</span>
<div style="font-size: 90%;">
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>(Y60 <span class="ot">&lt;-</span> <span class="fl">50.9278981</span> <span class="sc">+</span> <span class="fl">0.2321951</span> <span class="sc">*</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 64.8596</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>(tstar <span class="ot">&lt;-</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="at">df =</span> <span class="dv">78</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.990847</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>(s_resid <span class="ot">&lt;-</span> <span class="fu">glance</span>(model1)<span class="sc">$</span>sigma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.142157</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>(n <span class="ot">&lt;-</span> <span class="fu">nobs</span>(model1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>(mx <span class="ot">&lt;-</span> <span class="fu">mean</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>(s_x <span class="ot">&lt;-</span> <span class="fu">sd</span>(gapm<span class="sc">$</span>female_literacy_rate_2011))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>(SE_Ypred <span class="ot">&lt;-</span> s_resid <span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (<span class="dv">60</span> <span class="sc">-</span> mx)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span>s_x<span class="sc">^</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
<div class="columns">
<div class="column" style="width:36%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>(MOE_Ypred <span class="ot">&lt;-</span> SE_Ypred<span class="sc">*</span>tstar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">-</span> MOE_Ypred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div><div class="column" style="width:1%;">

</div><div class="column" style="width:30%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>Y60 <span class="sc">+</span> MOE_Ypred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-using-r-for-prediction-interval" class="level2">
<h2 class="anchored" data-anchor-id="example-using-r-for-prediction-interval">Example: Using R for prediction interval</h2>
<p><strong>Find the 95% prediction intervals for the life expectancy when the female literacy rate is 40, 60, and 80.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>newdata  <span class="co"># previously defined for CI's</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  female_literacy_rate_2011
1                        40
2                        60
3                        80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model1, </span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span>newdata, </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">interval=</span><span class="st">"prediction"</span>)  <span class="co"># prediction instead of "confidence"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 60.21570 47.63758 72.79382
2 64.85961 52.48072 77.23849
3 69.50351 57.19879 81.80823</code></pre>
</div>
</div>
<p><br></p>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<p>We are 95% confident that a new selected country with a 60% female literacy rate will have a life expectancy between 52.5 and 77.2 years.</p>
</section>
</section>
<section id="prediction-bands-vs.-confidence-bands-12" class="level2">
<h2 class="anchored" data-anchor-id="prediction-bands-vs.-confidence-bands-12">Prediction bands vs.&nbsp;confidence bands (1/2)</h2>
<p>Create a scatterplot with the regression line, 95% confidence bands, and 95% prediction bands.</p>
<ul>
<li>First create a data frame with the original data points (both x and y values), their respective predicted values, andtheir respective prediction intervals</li>
<li>Can do this with <code>augment()</code> from the <code>broom</code> package.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>model1_pred_bands <span class="ot">&lt;-</span> <span class="fu">augment</span>(model1, <span class="at">interval =</span> <span class="st">"prediction"</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at new object:</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model1_pred_bands) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ".rownames"                  "life_expectancy_years_2011"
 [3] "female_literacy_rate_2011"  ".fitted"                   
 [5] ".lower"                     ".upper"                    
 [7] ".resid"                     ".hat"                      
 [9] ".sigma"                     ".cooksd"                   
[11] ".std.resid"                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># glimpse of select variables of interest:</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>model1_pred_bands <span class="sc">%&gt;%</span> </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(life_expectancy_years_2011, female_literacy_rate_2011, </span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>         .fitted<span class="sc">:</span>.upper) <span class="sc">%&gt;%</span> </span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 80
Columns: 5
$ life_expectancy_years_2011 &lt;dbl&gt; 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…
$ female_literacy_rate_2011  &lt;dbl&gt; 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…
$ .fitted                    &lt;dbl&gt; 53.94643, 73.14897, 64.53453, 74.00809, 73.…
$ .lower                     &lt;dbl&gt; 40.91166, 60.81324, 52.14572, 61.65365, 61.…
$ .upper                     &lt;dbl&gt; 66.98121, 85.48470, 76.92334, 86.36253, 86.…</code></pre>
</div>
</div>
</section>
<section id="prediction-bands-vs.-confidence-bands-22" class="level2">
<h2 class="anchored" data-anchor-id="prediction-bands-vs.-confidence-bands-22">Prediction bands vs.&nbsp;confidence bands (2/2)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(model1_pred_bands) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ".rownames"                  "life_expectancy_years_2011"
 [3] "female_literacy_rate_2011"  ".fitted"                   
 [5] ".lower"                     ".upper"                    
 [7] ".resid"                     ".hat"                      
 [9] ".sigma"                     ".cooksd"                   
[11] ".std.resid"                </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(model1_pred_bands, </span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>female_literacy_rate_2011, <span class="at">y=</span>life_expectancy_years_2011)) <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> .lower, <span class="at">ymax =</span> .upper), <span class="co"># prediction bands</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm) <span class="sc">+</span>  <span class="co"># confidence bands</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SLR with Confidence &amp; Prediction Bands"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03_SLR_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="caution" class="level1">
<h1>Caution…</h1>
<section id="corrrelation-doesnt-imply-causation" class="level2">
<h2 class="anchored" data-anchor-id="corrrelation-doesnt-imply-causation">Corrrelation doesn’t imply causation<code>*</code>!</h2>
<ul>
<li><p>This might seem obvious, but make sure to not write your analysis results in a way that implies causation if the study design doesn’t warrant it (such as an observational study).</p></li>
<li><p>Beware of spurious correlations: <a href="http://www.tylervigen.com/spurious-correlations" class="uri">http://www.tylervigen.com/spurious-correlations</a></p></li>
</ul>
<p><img src="../img_slides/spurious_corr_2.png" class="img-fluid"></p>
<ul>
<li><code>*</code>Caveat: there is a whole field of statistics/epidemiology on causal inference. <a href="https://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf" class="uri">https://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf</a></li>
</ul>
</section>
<section id="whats-next" class="level2">
<h2 class="anchored" data-anchor-id="whats-next">What’s next?</h2>
<p><br> <br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../img_slides/flowchart_only_continuous.jpg" class="img-fluid figure-img"></p>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>