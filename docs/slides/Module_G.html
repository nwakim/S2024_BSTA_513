<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Regression – module_g</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/bsta_550_hex_3.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Linear Regression</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule1.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class_slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homeworks.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Info</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homeworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weekly Pages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Weeks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_01_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_02_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_03_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_04_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_05_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_06_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_07_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_08_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_09_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_10_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_11_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<div class="frame">
<p><span style="color: royalblue"><strong>BIOSTAT 650<br>
Theory and Application of Linear Regression<br>
Module G: MLR Hypothesis Testing</strong></span></p>
</div>
<div class="frame">
<p>Outline</p>
<p>Topics:</p>
<p>Extra sums of squares principle</p>
<p>General F test</p>
<p>Covariate subset test</p>
<p>Examples</p>
</div>
<div class="frame">
<p>Last time: F test <span class="math inline">\(H_0: \beta_1=\beta_2=\dots=\beta_{\myq-1}=0\)</span>;<br>
<span class="math inline">\(H_1:\)</span> at least one of them is nonzero</p>
<p><span class="math display">\[\begin{split}
\begin{cases}
\frac{SSY}{\sigma^2}\sim\chi^2_{n-1,\lambda_Y},~
\frac{SSR}{\sigma^2}\sim\chi^2_{\myq-1,\lambda_R\stackrel{{\scriptscriptstyle\text{$H_0$}}}{\longeq} \;0},~
\frac{SSE}{\sigma^2}\sim\chi^2_{n-\myq,\lambda_E\stackrel{{\scriptscriptstyle\text{LINE}}}{\longeq} \;0}\\
SSR\ind SSE\end{cases}  \\
\Rightarrow\;\; F=\frac{MSR}{MSE}=\frac{\frac{SSR}{\sigma^2}/(\myq-1)}{\frac{SSE}{\sigma^2}/(n-\myq)}\stackrel{H_0}{\sim} F_{p-1,n-p}\textcolor{white}{placeholder}&amp;
\end{split}\]</span></p>
</div>
<div class="frame">
<p>F test</p>
<p>Step 1: Fit the full model: <span class="math inline">\(Y_i=\beta_0+\beta_1X_{1i}+\dots+\beta_{p-1}X_{p-1,i}+\epsilon_i\)</span> Step 2: Fit the null (reduced) model: <span class="math inline">\(Y_i=\beta_0+\epsilon_i\)</span></p>
<p>Recall SSE = <span class="math inline">\(\sum_i\)</span>(observed<span class="math inline">\(_i\;-\)</span> fitted<span class="math inline">\(_i\)</span>)<span class="math inline">\(^2\)</span> The null model: <span class="math inline">\(\begin{rcases*} \text{SSE({$\beta_0$}) = $\sum_i(Y_i-\overline{Y})^2$ = SSY} \\ \text{SSR({$\beta_0$}) = 0} \end{rcases*} \text{sum to SSY}\)</span></p>
<p>The full model: <span class="math inline">\(\;\begin{rcases*} \text{SSE({$\boldbeta$}) = $\sum_i(Y_i-\widehat{Y}_i)^2$} \\ \text{SSR({$\boldbeta$}) = SSE({$\beta_0$}) - SSE({$\boldbeta$}) $\geq$ 0} \end{rcases*} \text{sum to SSY}\)</span></p>
<p>, i.e.,<br>
SSE(<span class="math inline">\(\beta_0\)</span>) <span class="math inline">\(-\)</span> SSE(<span class="math inline">\(\boldbeta\)</span>) = SSR(<span class="math inline">\(\boldbeta\)</span>) <span class="math inline">\(-\)</span> SSR(<span class="math inline">\(\beta_0\)</span>)</p>
<p>Step 3: <span class="math inline">\(F=\frac{\text{SSR($\boldbeta$)}/\text{dfSSR($\boldbeta$)}}{\text{SSE($\boldbeta$)\;/\; dfSSE($\boldbeta$)}}=\frac{  \left[ % \text{ \textcolor{royalblue}{ SSE({\)</span>_0<span class="math inline">\(}) - % SSE({\)</span><span class="math inline">\(}) \text{ \textcolor{royalblue}{ SSR({$\boldbeta$}) -
        SSR({$\beta_0$})
     }}  \right] % \left[ {\text{SSE}(\beta_0) - \text{SSE}(\boldbeta)} \right]  \;/\;  \left[ \text{dfSSR({$\boldbeta$})    -  dfSSR({$\beta_0$})} \right] }{ \text{SSE($\boldbeta$)\;/\; dfSSE($\boldbeta$)}  }\)</span> <strong>The F test compares the error (SSR) between the two models</strong> Intuitively, if error reduces (SSR increases) greatly due to the additional parameters then it makes sense to use the larger model</p>
</div>
<div class="frame">
<p>Extra Sum of Squares SSE(<span class="math inline">\(\beta_0\)</span>) <span class="math inline">\(-\)</span> SSE(<span class="math inline">\(\boldbeta\)</span>) is referred to as an “extra sum of squares". It can be viewed in either of two ways:</p>
<p>(1) the reduction in the SSE (2) the increase in the SSR when one or more predictor variables are added to the model.</p>
<p>In essence, when we add a predictor to a model, we hope to explain some of the variability in the response via regression, and thereby reduce some of the error. An extra sum of squares quantifies how much variability we explain (increase in SSR) or alternatively how much error we reduce (reduction in SSE).</p>
</div>
<div class="frame">
<p>Extra Sum of Squares</p>
<p>Model: <span class="math inline">\({\boldY}={\boldX}\boldbeta + {\boldepsilon}\)</span>; Re-write as: <span class="math inline">\({\boldY}={\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldepsilon}\)</span>,<br>
where <span class="math inline">\({\boldX}=[{\boldX}_1,{\boldX}_2]\)</span>, <span class="math inline">\(\boldbeta=[\boldbeta_1^T,\boldbeta_2^T]^T\)</span>, <span class="math inline">\(\boldbeta_1:\)</span> <span class="math inline">\(\myq_1\times 1\)</span>; <span class="math inline">\(\boldbeta_2:\)</span> <span class="math inline">\(\myq_2\times 1\)</span></p>
<p>Extra sum of squares (due to <span class="math inline">\(\boldbeta_2\)</span>): denoted as <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)\)</span></p>
<p>Increase in SSR attributable to adding <span class="math inline">\({\boldX}_2\)</span>, given that <span class="math inline">\({\boldX}_1\)</span> is already in the model <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)=SSR(\boldbeta_1,\boldbeta_2)-SSR(\boldbeta_1)=SSE(\boldbeta_1)-SSE(\boldbeta_1,\boldbeta_2)\)</span> <span class="math inline">\(df SS=p_2\)</span></p>
<p>Since <span class="math inline">\(SSY=SSR+SSE\)</span>, the increase in SSR due to <span class="math inline">\({\boldX}_2\)</span> equals the decrease in SSE due to <span class="math inline">\({\boldX}_2\)</span></p>
</div>
<div class="frame">
<p>Partial, Sequential Sums of Squares</p>
<p>e.g., <span class="math inline">\({\boldX}=[{\boldone}_n,{\boldX}_1,{\boldX}_2,{\boldX}_3]\)</span> <span class="math inline">\(\boldbeta=(\beta_0,\boldbeta_1^T,\boldbeta_2^T,\boldbeta_3^T)^T\)</span></p>
<p>SS:</p>
<p>for <span class="math inline">\(\boldbeta_1\)</span>: <span class="math inline">\(SS(\boldbeta_1|\beta_0,\boldbeta_2,\boldbeta_3)\)</span></p>
<p>for <span class="math inline">\(\boldbeta_2\)</span>: <span class="math inline">\(SS(\boldbeta_2|\beta_0,\boldbeta_1,\boldbeta_3)\)</span></p>
<p>for <span class="math inline">\(\boldbeta_3\)</span>: <span class="math inline">\(SS(\boldbeta_3|\beta_0,\boldbeta_1,\boldbeta_2)\)</span></p>
<p>SS: for <span class="math inline">\(\boldbeta_1\)</span>: <span class="math inline">\(SS(\boldbeta_1|\beta_0)\)</span></p>
<p>for <span class="math inline">\(\boldbeta_2\)</span>: <span class="math inline">\(SS(\boldbeta_2|\beta_0,\boldbeta_1)\)</span></p>
<p>for <span class="math inline">\(\boldbeta_3\)</span>: <span class="math inline">\(SS(\boldbeta_3|\beta_0,\boldbeta_1,\boldbeta_2)\)</span></p>
</div>
<div class="frame">
<p>Partial, Sequential Sums of Squares (continued)</p>
<p>Note: <span class="math display">\[\begin{split}
&amp;SSE(\beta_0) = SSY \\
&amp;SSR(\beta_0) = 0\\
&amp;\begin{cases}
SS(\boldbeta_1|\beta_0)  
= SSR(\beta_0,\boldbeta_1)-SSR(\beta_0)\\
SS(\boldbeta_2|\boldbeta_1,\beta_0)\stackrel{\scriptscriptstyle def}{\longeq} SSR(\boldbeta_2,\boldbeta_1,\beta_0)-SSR(\boldbeta_1,\beta_0)
\end{cases}\\
&amp;\begin{cases}
SSR(\beta_0,\boldbeta_1) \stackrel{{\scriptscriptstyle SSR(\beta_0)=0}}{\longeq}  SS(\boldbeta_1|\beta_0)+0\\
SSR(\beta_0,\boldbeta_1,\boldbeta_2) =
SS(\boldbeta_2|\boldbeta_1,\beta_0)+SS(\boldbeta_1|\beta_0)+0\\
%{\color{white}{SSR(\beta_0,\boldbeta_1,\boldbeta_2)}} =SS(\boldbeta_2|\boldbeta_1,\beta_0)+SSR(\beta_0,\boldbeta_1)
\end{cases}\\
%&amp;SSR(\beta_0,\boldbeta_1,\boldbeta_2,\boldbeta_3) =SSR(\beta_0,\boldbeta_1,\boldbeta_2)+SS(\boldbeta_3|\boldbeta_2,\boldbeta_1,\beta_0) \\
&amp;SS(\boldbeta_2,\boldbeta_1|\beta_0) = SS(\boldbeta_2|\boldbeta_1,\beta_0)+SS(\boldbeta_1|\beta_0)
\end{split}\]</span></p>
</div>
<div class="frame">
<p>Nested Models Models are nested if they use same variables (and cases!) but one model specifies at least one additional parameter to be estimated. The model with more parameters (or fewer restrictions on the parameters) is the “full” model The model with less parameters (or more restrictions on the parameters) is called the “restricted” model The restricted model is said to be nested within the full model</p>
</div>
<div class="frame">
<p>Nested Models As a special case: two MLRs are <em>nested</em> if the covariate set in one is a subset of the covariate set of the other</p>
<p>e.g., set of nested models: <span class="math display">\[\begin{aligned}
{\boldY} &amp; = &amp; {\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldX}_3\boldbeta_3 + {\boldepsilon} \nonumber \\
{\boldY} &amp; = &amp; {\boldX}_1\boldbeta_1 + {\boldepsilon} \nonumber \\
{\boldY} &amp; = &amp; {\boldX}_1\boldbeta_1 + {\boldX}_3\boldbeta_3 +{\boldepsilon} \nonumber
\end{aligned}\]</span></p>
<p>e.g., two non-nested models: <span class="math display">\[\begin{aligned}
{\boldY} &amp; = &amp; {\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldX}_3\boldbeta_3 + {\boldepsilon} \nonumber \\
\nonumber
{\boldY} &amp; = &amp; {\boldX}_1\boldbeta_1 + {\boldX}_4\boldbeta_4 +{\boldepsilon}
\nonumber
\end{aligned}\]</span></p>
</div>
<div class="frame">
<p>Hypothesis Testing: General e.g., model: <span class="math inline">\(Y_i = \beta_0 + \beta_1X_{i1}+ \beta_2X_{i2}+ \beta_3X_{i3} + e_i\)</span></p>
<p>All major types of hypothesis tests can be performed using a single framework</p>
<p>overall test: <span class="math inline">\(H_0:\beta_1=\beta_2=\beta_3=0\)</span> vs.<br>
<span class="math inline">\(H_1:\beta_j\neq 0\)</span> for <span class="math inline">\(j=1\)</span> or <span class="math inline">\(j=2\)</span> or <span class="math inline">\(j=3\)</span> single-covariate test: <span class="math inline">\(H_0:\beta_2=0\)</span> vs.<br>
<span class="math inline">\(H_1:\beta_2\neq 0\)</span> test for covariate subset: <span class="math inline">\(H_0:\beta_2=\beta_3=0\)</span> vs.<br>
<span class="math inline">\(H_1:\beta_2\neq 0\)</span> or <span class="math inline">\(\beta_3\neq 0\)</span></p>
</div>
<div class="frame">
<p>F-statistic: General Form</p>
<p>F-statistic for comparing any two nested models is of the form: <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{ SS/ df SS}{MSE_1} \sim  F_{ df SS,
    dfE_1} \nonumber
\end{aligned}\]</span> where: <span class="math inline">\(SS=SSE_0-SSE_1=SSR_1-SSR_0\)</span>: extra SS, <span class="math inline">\(H_0\)</span> model versus <span class="math inline">\(H_1\)</span> model</p>
<p><span class="math inline">\(dfSS=dfE_0-dfE_1=dfR_1-dfR_0\)</span>: difference in <span class="math inline">\(dfE\)</span> (<span class="math inline">\(dfR\)</span>), <span class="math inline">\(H_0\)</span> vs <span class="math inline">\(H_1\)</span> model ( = number of parameters tested in the null hypothesis)</p>
<p><span class="math inline">\(MSE_1=\)</span> estimate of <span class="math inline">\(\sigma^2\)</span>, based on <span class="math inline">\(H_1\)</span> model</p>
</div>
<div class="frame">
<p>F-test: General Form e.g., <span class="math inline">\({\boldX}=[{\boldX}_1,{\boldX}_2]\)</span> <span class="math inline">\(\boldbeta^T=[\boldbeta_1^T,\boldbeta_2^T]\)</span> <span class="math inline">\(\boldbeta_1:\)</span> <span class="math inline">\(\myq_1\times 1\)</span> vector; <span class="math inline">\(\boldbeta_2:\)</span> <span class="math inline">\(\myq_2\times 1\)</span> <span class="math inline">\(\myq=\myq_1+\myq_2\)</span> Model: <span class="math display">\[\begin{aligned}
{\boldY}= {\boldX}\boldbeta+{\boldepsilon} ={\boldX}_1\boldbeta_1+{\boldX}_2\boldbeta_2 + {\boldepsilon}\nonumber
\end{aligned}\]</span> Hypotheses: <span class="math inline">\(H_0:\boldbeta_2={\boldzero}_{\myq_2}\)</span> vs. <span class="math inline">\(H_1:\boldbeta_2\neq {\boldzero}_{\myq_2}\)</span> Test statistic: <span class="math display">\[\begin{aligned}
F = \frac{SS(\boldbeta_2|\boldbeta_1)/\myq_2}{\widehat{\sigma}^2_1}
\sim F_{\myq_2,n-\myq} \nonumber
\end{aligned}\]</span> where <span class="math inline">\(\widehat{\sigma}^2_1\)</span> is estimate of <span class="math inline">\(\sigma^2\)</span> based on the full model (<span class="math inline">\(H_1\)</span>)</p>
</div>
<div class="frame">
<p>Overall Test: <span class="math inline">\(H_0:\boldbeta_1={\boldzero}_{p_1}, p_1=\myq-1\)</span> Model <span class="math inline">\({\boldY} = {\boldone}_n\beta_0 + {\boldX}\boldbeta_1 + {\boldepsilon}\)</span> <span class="math inline">\(\myq-1\)</span> covariates; <span class="math inline">\(\myq\)</span> parameters</p>
<p>Overall test: <span class="math inline">\(H_0:\boldbeta_1={\boldzero}_{\myq-1}\)</span> vs. <span class="math inline">\(H_1:\boldbeta_1\neq {\boldzero}_{\myq-1}\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\boldbeta_1|\beta_0)/(\myq-1)}{\widehat{\sigma}^2_1} \sim
F_{\myq-1,n-\myq} \nonumber
\end{aligned}\]</span> note: <span class="math inline">\(SS(\boldbeta_1|\beta_0)= SSR(\beta_0,\boldbeta_1)-SSR(\beta_0)=SSR(\boldbeta_1)\)</span> therefore, <span class="math inline">\(F=MSR/MSE\)</span> test has same form as SLR test of <span class="math inline">\(H_0:\beta_1=0\)</span></p>
</div>
<div class="frame">
<p>Covariate Subset Test: <span class="math inline">\(H_0:\boldbeta_1={\boldzero}_{p_1}, p_1&lt;\myq-1\)</span> Model <span class="math inline">\({\boldY} = {\boldone}_n\beta_0 + {\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldepsilon}\)</span></p>
<p>Hypotheses: <span class="math inline">\(H_0:\boldbeta_1={\boldzero}_{\myq_1}\)</span> vs. <span class="math inline">\(H_1:\boldbeta_1\neq {\boldzero}_{\myq_1}\)</span> (<span class="math inline">\(\myq=1+\myq_1+\myq_2\)</span>)</p>
<p>set <span class="math inline">\({\boldX}_2^*=[{\boldone}_n,{\boldX}_2]\)</span>, <span class="math inline">\(\boldbeta_2^*=(\beta_0,\boldbeta_2^T)^T\)</span></p>
<p>Test statistic: <span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(\boldbeta_1|\boldbeta_2^*)/\myq_1}{\widehat{\sigma}^2_1}
\sim F_{\myq_1,n-\myq} \nonumber
\end{aligned}\]</span></p>
<p>Recall: <span class="math display">\[\begin{aligned}
SS(\boldbeta_1|\boldbeta_2^*) &amp; = &amp;
SSR(\boldbeta_1,\boldbeta_2^*) - SSR(\boldbeta_2^*) \nonumber \\
&amp; = &amp; SSE(\boldbeta_2^*) - SSE(\boldbeta_1,\boldbeta_2^*)
\nonumber
\end{aligned}\]</span></p>
</div>
<div class="frame">
<p>Single-Covariate Test: <span class="math inline">\(H_0:\boldbeta_1={\boldzero}_{p_1}, p_1=1\)</span> Model: <span class="math inline">\({\boldY} = {X}_1\beta_1 + {\boldX}_2\boldbeta_2 + {\boldepsilon}\)</span></p>
<p>Hypotheses: <span class="math inline">\(H_0:\beta_1=0\)</span> vs.&nbsp;<span class="math inline">\(H_1:\beta_1\neq 0\)</span></p>
<p>Test statistic: <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\beta_1|\boldbeta_2)}{\widehat{\sigma}^2_1} \sim
F_{1,n-\myq} \nonumber
\end{aligned}\]</span></p>
<p>Recall: <span class="math inline">\(F_{1,n-\myq} \equiv \{ t_{n-\myq} \}^2\)</span> and <span class="math inline">\(F=T^2\)</span>. Thus, single-covariate hypotheses can be tested using the <span class="math inline">\(t\)</span>-distribution: <span class="math display">\[\begin{aligned}
T &amp; = &amp; \frac{\widehat{\beta}_1}{SE(\widehat{\beta}_1)} \sim
t_{n-\myq} \nonumber
\end{aligned}\]</span> Using <span class="math inline">\(t\)</span>-distribution, could test <span class="math inline">\(H_0:\beta_1=0\)</span> vs: <span class="math inline">\(H_1: \beta_1\neq 0\)</span>, <span class="math inline">\(H_1: \beta_1 &gt; 0\)</span>, or <span class="math inline">\(H_1: \beta_1 &lt; 0\)</span> Two-sided hypotheses can be tested using either F or t test; for one-sided use t test</p>
</div>
<div class="frame">
<p>How do we carry out these tests? Consider model: <span class="math inline">\({\boldY} = {\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldepsilon}\)</span></p>
<p><span class="math inline">\(H_0: \boldbeta_2={\boldzero}_{\myq_2}\)</span> vs. <span class="math inline">\(H_1:\boldbeta_2\neq {\boldzero}_{\myq_2}\)</span> We need to compute <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\boldbeta_2|\boldbeta_1)/\myq_2}{\widehat{\sigma}^2_1}
%\sim F_{\myq_2,n-\myq} \nonumber
\end{aligned}\]</span></p>
<p>Could fit the following two nested models: <span class="math display">\[\begin{aligned}
{\boldY} &amp; = &amp;  {\boldX}_1\boldbeta_1 + {\boldX}_2\boldbeta_2 + {\boldepsilon}
\nonumber \\
{\boldY} &amp; = &amp;  {\boldX}_1\boldbeta_1 + {\boldepsilon} \nonumber
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
{\boldX} = [{\boldX}_1,{\boldX}_2] &amp;  &amp; \boldbeta = \left[
\begin{array}{c} \boldbeta_1 \\ \boldbeta_2
\end{array} \right]\nonumber
\end{aligned}\]</span> then compute <span class="math inline">\(\Delta SSR\)</span> or <span class="math inline">\(\Delta SSE\)</span> Alternatively, could consider the forms of the SSE’s involved <span class="math inline">\(\ldots\)</span></p>
</div>
<div class="frame">
<p>Extra SS: Matrix Formulation</p>
<p>In particular, <span class="math display">\[\begin{aligned}
SSE(\boldbeta_1,\boldbeta_2) &amp; = &amp; {\boldY}^T ({\boldI}_n-{\boldH}){\boldY} \nonumber \\
SSE(\boldbeta_1) &amp; = &amp; {\boldY}^T ({\boldI}_n-{\boldH}_1){\boldY}
\nonumber
\end{aligned}\]</span> <span class="math display">\[\begin{aligned}
{\boldH} &amp; = &amp; {\boldX}({\boldX}^T{\boldX})^{-1}{\boldX}^T \nonumber
\\ {\boldH}_1 &amp;
= &amp; {\boldX}_1({\boldX}_1^T{\boldX}_1)^{-1}{\boldX}^T_1 \nonumber
\end{aligned}\]</span></p>
<p>Therefore, <span class="math display">\[\begin{aligned}
SS(\boldbeta_2|\boldbeta_1) &amp; = &amp; SSE(\boldbeta_1) - SSE(\boldbeta
_1,\boldbeta_2) \nonumber \\ &amp; = &amp; {\boldY}^T({\boldI}_n-{\boldH}_1){\boldY} - {\boldY}^T({\boldI}_n-{\boldH}){\boldY} \nonumber \\
&amp; = &amp; {\boldY}^T\{{\boldI}_n-{\boldH}_1-({\boldI}_n-{\boldH})\}{\boldY}  \nonumber \\ &amp; = &amp;  {\boldY}^T({\boldH}-{\boldH}_1 ){\boldY} \nonumber
\end{aligned}\]</span></p>
</div>
<div class="frame">
<p>How do we know that <span class="math inline">\(F\)</span> follows <span class="math inline">\(F_{\myq_2,n-\myq}\)</span> under <span class="math inline">\(H_0:\boldbeta_2=\boldzero_{p_2}\)</span> <span class="math inline">\(F=\frac{SS(\boldbeta_2|\boldbeta_1)/\myq_2}{\widehat{\sigma}^2_1}=\frac{SS(\boldbeta_2|\boldbeta_1)/p_2}{SSE(\boldbeta_1,\boldbeta_2)/(n-p)}=\frac{\boldY^T({\boldH}-{\boldH}_1 ){\boldY}/p_2}{\boldY^T({\boldI}-{\boldH} ){\boldY}/(n-p)}\)</span> Need to show <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)/\sigma^2=\boldY^T({\boldH}-{\boldH}_1 ){\boldY}/\sigma^2\stackrel{H_0}{\sim }\chi^2_{p_2}\)</span> <span class="math inline">\(SSE(\boldbeta_1,\boldbeta_2)/\sigma^2=\boldY^T({\boldI}-{\boldH} ){\boldY}/\sigma^2\sim \chi^2_{n-p}\)</span> <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)\ind SSE(\boldbeta_1,\boldbeta_2)\)</span></p>
</div>
<div class="frame">
<p>How do we know that <span class="math inline">\(F\)</span> follows <span class="math inline">\(F_{\myq_2,n-\myq}\)</span> under <span class="math inline">\(H_0:\boldbeta_2=\boldzero_{p_2}\)</span> <span class="math inline">\(F=\frac{SS(\boldbeta_2|\boldbeta_1)/\myq_2}{\widehat{\sigma}^2_1}=\frac{SS(\boldbeta_2|\boldbeta_1)/p_2}{SSE(\boldbeta_1,\boldbeta_2)/(n-p)}=\frac{\boldY^T({\boldH}-{\boldH}_1 ){\boldY}/p_2}{\boldY^T({\boldI}-{\boldH} ){\boldY}/(n-p)}\)</span> Need to show <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)/\sigma^2=\boldY^T({\boldH}-{\boldH}_1 ){\boldY}/\sigma^2\stackrel{H_0}{\sim }\chi^2_{p_2}\)</span> <span class="math inline">\(SSE(\boldbeta_1,\boldbeta_2)/\sigma^2=\boldY^T({\boldI}-{\boldH} ){\boldY}/\sigma^2\sim \chi^2_{n-p}\)</span> <span class="math inline">\(SS(\boldbeta_2|\boldbeta_1)\ind SSE(\boldbeta_1,\boldbeta_2)\)</span></p>
</div>
<div class="frame">
<p>How do we know that <span class="math inline">\(F\)</span> follows <span class="math inline">\(F_{\myq_2,n-\myq}\)</span> under <span class="math inline">\(H_0:\boldbeta_2=\boldzero_{p_2}\)</span> Sketch proof</p>
<p>We have already shown in Module F that <span class="math inline">\(SSE(\boldbeta_1,\boldbeta_2)/\sigma^2=\boldY^T({\boldI}-{\boldH} ){\boldY}\sim \chi^2_{n-p}\)</span> <span class="math inline">\({\boldH}-{\boldH}_1\)</span> is symmetric and idempotent <span class="math display">\[\begin{split}
            ({\boldH}-{\boldH}_1)^2=\boldH^2+{\boldH}_1^2-2\boldH\boldH_1\\
            =\boldH+{\boldH}_1-2\boldH[\boldX_1(\boldX_1\trans \boldX_1)^{-1}\boldX_1]\\
            \stackrel{\boldH\boldX_1=\boldX_1}{=}\boldH+{\boldH}_1-2\boldH_1=\boldH-\boldH_1
        \end{split}\]</span> <span class="math inline">\(rank({\boldH}-{\boldH}_1)=tr({\boldH})-tr({\boldH}_1)=p-p_1=p_2\)</span> non-centrality parameter <span class="math inline">\(E[\boldY]^T({\boldH}-{\boldH}_1 )E[\boldY]\stackrel{H_0:\boldbeta_2=0}{=}(\boldX_1\boldbeta_1)\trans({\boldH}-{\boldH}_1 )(\boldX_1\boldbeta_1)=0\)</span> <span class="math inline">\(({\boldH}-{\boldH}_1)(\boldI-\boldH)=0\)</span> because <span class="math display">\[\begin{split}
            (\boldI-\boldH) ({\boldH}-{\boldH}_1)=&amp;{\boldH}-{\boldH}_1 - \boldH^2 + \boldH\boldH_1\\
            =&amp;{\boldH}-{\boldH}_1 - \boldH + \boldH_1=0
        \end{split}\]</span></p>
</div>
<div class="frame">
<p>Sequential vs Partial Testing</p>
<div class="itemize">
<p>Certain situations indicate strictly <em>either</em> sequential <em>or</em> partial tests alone</p>
<p>Depends on aims of investigator, but also on the nature of the model under consideration</p>
Consider the following model: $$
<span class="math display">\[\begin{aligned}
    Y_i &amp; = &amp; \beta_0 + \beta_1X_{i1} +\beta_2X_{i2} +\beta_3X_{i3} +
    e_i \nonumber
    
\end{aligned}\]</span>
<p>$$</p>
<p>Partial tests could assess the following:</p>
<div class="itemize">
<p><span class="math inline">\(Q_1\)</span>: Does <span class="math inline">\(X_{i1}\)</span> contribute to the model (i.e., explain variation in <span class="math inline">\(Y_i\)</span>) given that <span class="math inline">\(X_{i2}\)</span> and <span class="math inline">\(X_{i3}\)</span> are already in the model</p>
<p><span class="math inline">\(Q_2\)</span>: Does <span class="math inline">\(X_{i2}\)</span> contribute <span class="math inline">\(\ldots\)</span> given that <span class="math inline">\(X_{i1}\)</span> and <span class="math inline">\(X_{i3}\)</span> <span class="math inline">\(\ldots\)</span> in the model</p>
</div>
</div>
</div>
<div class="frame">
<p>Partial Tests</p>
<div class="itemize">
<p>Partial tests: for <span class="math inline">\(X_1\)</span>: <span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(\beta_1|\beta_0,\beta_2,\beta_3)}{\widehat{\sigma}^2}=\frac{SS(X_1|X_2,X_3)}{\widehat{\sigma}^2}
\sim F_{1,n-4} \nonumber
\end{aligned}\]</span></p>
<p>for <span class="math inline">\(X_2\)</span>: <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\beta_2|\beta_0,\beta_1,\beta_3)}{\widehat{\sigma}^2}=
\frac{SS(X_2|X_1,X_3)}{\widehat{\sigma}^2}
\sim F_{1,n-4} \nonumber
\end{aligned}\]</span></p>
<p>Note that we can express the extra SS out in terms of either the parameters or corresponding covariates</p>
<p>The intercept (<span class="math inline">\(\beta_0\)</span>) is always included after the <span class="math inline">\(|\)</span> sign, hence not written out explicitly if when we use the covariates to express SS Denominator is always estimate of <span class="math inline">\(\sigma^2\)</span> in the full model</p>
</div>
</div>
<div class="frame">
<p>Partial Tests (continued)</p>
<div class="itemize">
<p>Could also assess the importance of a subset of covariates, given that a second subset of covariates is already in the model:</p>
<div class="itemize">
<p>e.g., ’Are either <span class="math inline">\(X_2\)</span> or <span class="math inline">\(X_3\)</span> important predictors of <span class="math inline">\(Y\)</span>, after adjusting for <span class="math inline">\(X_1\)</span>? <span class="math inline">\(H_0:\beta_2=\beta_3=0\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(X_2,X_3|X_1)/2}{\widehat{\sigma}^2}
\sim F_{2,n-4} \nonumber
\end{aligned}\]</span></p>
</div>
</div>
</div>
<div class="frame">
<p>Example: Partial Tests</p>
<div class="itemize">
<p>e.g.,</p>
<div class="itemize">
<p>response, <span class="math inline">\(SBP_i:\)</span> systolic blood pressure</p>
<p>covariates: age (<span class="math inline">\(A_i\)</span>) , weight (<span class="math inline">\(W_i\)</span>), height (<span class="math inline">\(H_i\)</span>)</p>
<p>model: <span class="math inline">\(SBP_i = \beta_0+ \beta_A A_i + \beta_W W_i + \beta_H H_i + e_i\)</span></p>
<p>all covariates are of approximately equal interest</p>
<p>desired to test importance of each covariate, adjusted for the others</p>
<p>no particular order of the tests is obvious</p>
</div>
<p>In this example, a set of partial tests is appropriate</p>
</div>
</div>
<div class="frame">
<p>Partial Tests (single)</p>
<div class="itemize">
<p>Partial tests: e.g., <span class="math inline">\(H_0: \beta_A=0\)</span> vs.&nbsp;<span class="math inline">\(H_0: \beta_A\neq 0\)</span></p>
<div class="itemize">
<p>could use an <span class="math inline">\(F\)</span>-test or, equivalently, a <span class="math inline">\(t\)</span>-test</p>
<p>e.g., consider age <span class="math inline">\(\ldots\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(\beta_A|\beta_0,\beta_W,\beta_H)}{\widehat{\sigma}^2}
\sim F_{1,n-4} \nonumber \\ \nonumber \\T &amp; = &amp;
\frac{\widehat{\beta}_A}{SE(\widehat{\beta}_A)} \sim
t_{n-4} \nonumber
\end{aligned}\]</span></p>
</div>
<p>Recall: equivalence of <span class="math inline">\(\{t_{df}\}^2\)</span> and <span class="math inline">\(F_{1,df}\)</span> when <span class="math inline">\(H_1\)</span> is two-sided</p>
<p>Could repeat for <span class="math inline">\(\beta_W\)</span> and <span class="math inline">\(\beta_H\)</span> <span class="math inline">\(\ldots\)</span></p>
</div>
</div>
<div class="frame">
<p>Partial Tests (subset)</p>
<div class="itemize">
<p>We could assess the association between <span class="math inline">\(SBP\)</span> and a subset of covariates, adjusted for all others e.g., could assess contribution of body mass metrics (weight <span class="math inline">\(W\)</span> and height <span class="math inline">\(H\)</span>), adjusted for age</p>
<div class="itemize">
<p><span class="math inline">\(H_0:\)</span> body mass measures not associated with <span class="math inline">\(SBP\)</span>, after accounting for <span class="math inline">\(age\)</span></p>
<p>more formally <span class="math inline">\(\ldots\)</span></p>
<p><span class="math inline">\(H_0:\beta_W=\beta_H=0\)</span>, versus</p>
<p><span class="math inline">\(H_1:\beta_W \neq 0\)</span> and/or <span class="math inline">\(\beta_H\neq 0\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(\beta_W,\beta_H|\beta_0,\beta_A)/2}{\widehat{\sigma}^2}
\sim F_{2,n-4} \nonumber
\end{aligned}\]</span></p>
</div>
</div>
</div>
<div class="frame">
<p>Sequential Testing</p>
<div class="itemize">
<p>In certain settings sequential testing is indicated</p>
<p>e.g., polynomial regression: balancing model fit with interpretation and parsimony</p>
<div class="itemize">
<p>implies that lower order terms should be examined first</p>
<p>e.g., response: serum cholesterol, <span class="math inline">\(SC\)</span>; covariate: body mass index, <span class="math inline">\(B\)</span></p>
<p>model: <span class="math display">\[\begin{aligned}
SC_i =  \beta_0 + \beta_1 B_i + \beta_2 B_i^2 + \beta_3 B_i^3 +
\beta_4 B_i^4 + e_i \nonumber
\end{aligned}\]</span> Partial test e.g.&nbsp;<span class="math inline">\(H_0: \beta_2=0\)</span> would not be appropriate: higher order terms should not be tested unless lower order terms are significant</p>
</div>
</div>
</div>
<div class="frame">
<p>Sequential Testing (continued)</p>
<div class="itemize">
<p>Sequence of tests:</p>
<div class="itemize">
<p><span class="math inline">\(H_0:\beta_1=0\)</span> vs <span class="math inline">\(H_1:\beta_1\neq 0\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\beta_1|\beta_0)}{\widehat{\sigma}^2} \sim
F_{1,n-5} \nonumber
\end{aligned}\]</span></p>
<p>if <span class="math inline">\(H_0\)</span> rejected, go to next test; otherwise, stop</p>
<p><span class="math inline">\(H_0:\beta_2=0\)</span> vs <span class="math inline">\(H_1:\beta_2\neq 0\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(\beta_2|\beta_0,\beta_1)}{\widehat{\sigma}^2}
\sim F_{1,n-5} \nonumber
\end{aligned}\]</span></p>
<p>if <span class="math inline">\(H_0\)</span> rejected, go to next test; otherwise, stop etc<span class="math inline">\(\ldots\)</span></p>
</div>
</div>
</div>
<div class="frame">
<p>Sequential Tests: Subsets</p>
<div class="itemize">
<p>Sequential tests on a subset of parameters may be indicated</p>
<p>Continuing on with <span class="math inline">\(SC\)</span>/<span class="math inline">\(BMI\)</span> polynomial model <span class="math inline">\(\ldots\)</span></p>
<div class="itemize">
<p><span class="math inline">\(H_0\)</span>: second-order model fits well</p>
<p><span class="math inline">\(H_1\)</span>: higher order terms necessary</p>
<p>more formally:</p>
<p><span class="math inline">\(H_0: \beta_3=\beta_4=0\)</span> vs.&nbsp;<span class="math inline">\(H_1:\beta_3\neq 0\)</span> or <span class="math inline">\(\beta_4\neq 0\)</span> <span class="math display">\[\begin{aligned}
F &amp; = &amp; \frac{SS(B^3,B^4|B,B^2)/2}{\widehat{\sigma}^2}
\sim F_{2,n-5} \nonumber
\end{aligned}\]</span></p>
</div>
</div>
</div>
<div class="frame">
<p>Role of Sequential Testing</p>
<div class="itemize">
<p>Partial testing is the default</p>
<p>Sequential testing is generally indicated only when the covariates being considered are inherently ordered</p>
<div class="itemize">
<p>e.g., by ease of interpretation e.g., by ease of data collection e.g., by perceived accuracy</p>
</div>
<p>The order of variables in the models makes a difference</p>
</div>
</div>
<div class="frame">
<p>Computing Test Statistic in Sequential Testing</p>
<div class="itemize">
<p>e.g., response, <span class="math inline">\(Y_i\)</span>; covariates: <span class="math inline">\(X_{i1},\ldots,X_{i5}\)</span></p>
<p>Consider the following <span class="math inline">\(F\)</span>-statistic:</p>
<p><span class="math display">\[\begin{aligned}
F &amp; = &amp;
\frac{SS(\beta_2,\beta_3|\beta_1,\beta_0)/2}{\widehat{\sigma}^2}
\sim F_{2,n-6} \nonumber
\end{aligned}\]</span></p>
<p><span class="math inline">\(\widehat{\sigma}^2\)</span> is computed based on the <em>full</em> model (i.e., model containing: <span class="math inline">\(X_{i1},\ldots,X_{i5}\)</span>)</p>
<p>In some text books, the statistic would be defined:</p>
<p><span class="math display">\[\begin{aligned}
F^* &amp; = &amp;
\frac{SS(\beta_2,\beta_3|\beta_1,\beta_0)/2}{SSE(\beta_0,\ldots,\beta_3)/(n-4)}
\sim F_{2,n-4} \nonumber
\end{aligned}\]</span></p>
<p>i.e., <span class="math inline">\(\sigma^2\)</span>, in the denominator, is estimated based on a model with only covariates <span class="math inline">\(X_1,X_2,X_3\)</span>.</p>
</div>
</div>
<div class="frame">
<p>Denominator</p>
<div class="itemize">
<p>The statistic, <span class="math inline">\(F^*\)</span>, has a very nice interpretation: percent reduction in <span class="math inline">\(SSE\)</span> (<span class="math inline">\(df\)</span>-adjusted)</p>
<p>However, an accurate estimator of <span class="math inline">\(\sigma^2\)</span> is required</p>
<p>Note:</p>
<div class="itemize">
<p>omitting covariates from a model may positively bias <span class="math inline">\(MSE\)</span></p>
<p>including extra covariates (i.e., over-fitting) usually does not bias <span class="math inline">\(\widehat{\sigma}^2\)</span> (only makes it more noisy)</p>
</div>
<p>R function <code>anova</code> and SAS both use our version of the <span class="math inline">\(F\)</span>-statistic in sequential testing, as opposed to <span class="math inline">\(F^*\)</span></p>
</div>
</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">
<p>Questions?</p>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>