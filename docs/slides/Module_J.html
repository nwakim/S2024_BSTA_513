<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Regression – module_j</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/bsta_550_hex_3.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Linear Regression</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../syllabus.html" rel="" target="" aria-current="page">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule1.html" rel="" target="">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../class_slides.html" rel="" target="">
 <span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homeworks.html" rel="" target="">
 <span class="menu-text">Homework</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Course Info</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../instructors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../schedule1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Course Materials</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Class Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../homeworks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weekly Pages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Weeks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_01_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_02_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_03_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_04_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_05_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_06_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_07_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_08_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_09_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_10_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../weeks/week_11_sched.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<div class="frame">
<p><span style="color: royalblue"><strong>BIOSTAT 650<br>
Theory and Application of Linear Regression<br>
Module J: General Linear Hypothesis</strong></span></p>
</div>
<div class="frame">
<p>Outline</p>
<p>Topics:</p>
<p>GLH framework</p>
<p>Testing equality of regression coefficients</p>
<p>Examples</p>
</div>
<div class="frame">
<p>General Linear Hypothesis (GLH) To date, we have focused on testing hypotheses through the Extra SS principle. e.g.,</p>
<p><span class="math inline">\({\boldY }={\boldX}\boldbeta+{\boldepsilon}\)</span> <span class="math inline">\(\boldbeta=(\boldbeta_1^T,\boldbeta_2^T)^T\)</span></p>
<p>All null hypotheses took the form: <span class="math inline">\(H_0:\boldbeta_2={\boldzero }\)</span> <span class="math inline">\(F = \frac{SS(\boldbeta_2\mid \boldbeta_1)/p_2}{\widehat{\sigma}_{\scriptscriptstyle \text{$1$} } } \sim F_{p_2,n-p}\)</span> <span class="math inline">\(SS(\boldbeta_2\mid \boldbeta_1)=SSR(\boldbeta_1,\boldbeta_2)-SSR(\boldbeta_1)\)</span></p>
<p>Often, it is of interest to test more general hypotheses: e.g., <span class="math inline">\(H_0: \beta_{1}=\beta_{2}=\beta_{3}\)</span> (recall cell means coding) Using the GLH principle, we have more flexibility to specify hypotheses</p>
</div>
<div class="frame">
<p>Example Example: consider a study designed to assess the relationship between resting heart rate (<span class="math inline">\(HR\)</span>) and age (<span class="math inline">\(A\)</span>) among 30-54 year olds.</p>
<p>in order to avoid assuming that <span class="math inline">\(E(HR)\)</span> is linear in age, the following model is specified: HR_i &amp; = &amp; _0 + _1AG_1i + _2AG_2i +_3AG_3i + _4AG_4i + _i where: AG_1i &amp; = &amp; I(30 A_i )<br>
AG_2i &amp; = &amp; I(35 A_i )<br>
AG_3i &amp; = &amp; I(40 A_i )<br>
AG_4i &amp; = &amp; I(45 A_i )<br>
AG_5i &amp; = &amp; I(50 A_i )</p>
</div>
<div class="frame">
<p>Example HR_i &amp; = &amp; _0 + _1AG_1i + _2AG_2i +_3AG_3i + _4AG_4i + _i</p>
<p>However, the investigator hypothesizes that only four age groups may be necessary, as mean heart rate in the 30-34 and 35-39 age groups are equal This implies the following hypotheses: <span class="math inline">\(H_0:\beta_1=\beta_2\)</span>, <span class="math inline">\(H_1:\beta_1 \neq \beta_2\)</span></p>
<p>This test can easily be formulated as <strong>a linear function of <span class="math inline">\(\beta\)</span>’s</strong> <span class="math inline">\(H_0:\beta_1-\beta_2=0\)</span>, <span class="math inline">\(H_1:\beta_1 - \beta_2\neq 0\)</span></p>
</div>
<div class="frame">
<p>GLH method</p>
<p>Any null hypothesis expressed as <span class="math inline">\(H_0: {\boldT}{\boldbeta}={\boldcc}\)</span> is a GLH Entries in <span class="math inline">\({\boldT}\)</span> and <span class="math inline">\({\boldcc}\)</span> are known constants <span class="math inline">\({\boldT}\)</span> is often referred to as the contrast matrix</p>
<p>Main idea of GLH: Find <span class="math inline">\({\boldT\ktimesp}\)</span> s.t. the linear functions <span class="math inline">\({\boldT\ktimesp}{\boldbeta\ptimesone}=\boldcc\)</span> gives the stated <span class="math inline">\(H_0\)</span> <span class="math inline">\(k\)</span> = number of equations simultaneously being tested <span class="math inline">\(p\)</span> = dimension of <span class="math inline">\(\boldbeta\)</span> <span class="math inline">\({\boldT\ktimesp}\)</span> is needed for constructing a test statistic</p>
<p>In the example <span class="math inline">\(H_0:\beta_1=\beta_2\)</span>, <span class="math inline">\(H_1:\beta_1 \neq \beta_2\)</span> equivalent to <span class="math inline">\(H_0:\beta_1-\beta_2=0\)</span>, <span class="math inline">\(H_1:\beta_1 - \beta_2\neq 0\)</span> <span class="math inline">\({\boldT\onetimesp}=[\begin{array}{ccccc}0 &amp; 1 &amp; -1 &amp; 0 &amp; 0  \end{array}]\)</span>, s.t. <span class="math inline">\({\boldT}{\boldbeta}=\beta_1-\beta_2\)</span> and <span class="math inline">\(\boldcc=0\)</span></p>
</div>
<div class="frame">
<p>Constructing Test Statistic <span class="math inline">\(H_0:\boldT\ktimesp\boldbeta\ptimesone=\boldcc\ktimesone\)</span> vs <span class="math inline">\(H_1:\boldT\ktimesp\boldbeta\ptimesone\neq \boldcc\ktimesone\)</span> F-test for GLH <span class="math display">\[\boxed{F=\frac{ ({\boldT}\widehat{\boldbeta}-{\boldcc})^T \{{\boldT}({\boldX}^T{\bf
        X})^{-1}{\boldT}^T\}^{-1} ({\boldT}\widehat{\boldbeta}-{\boldcc})/rank(\boldT) }{ \widehat{\sigma}^2_{\scriptscriptstyle \text{$1$}}}
\stackrel{H_0}{\sim}  F_{rank({\bf
        T}),n-p}
}\]</span> For a well defined <span class="math inline">\(H_0\)</span>, <span class="math inline">\(rank(\boldT)\)</span> = number of rows in <span class="math inline">\(\boldT\)</span>, i.e., how many equations (at most <span class="math inline">\(p\)</span>) are we simultaneously testing</p>
<p><span class="math inline">\(\widehat{\sigma}^2_{\scriptscriptstyle \text{$1$}}\)</span>: obtained from the unrestricted model, i.e., under <span class="math inline">\(H_1\)</span></p>
<p>Derivation provided at the end of the slides Rationale: <span class="math inline">\(\underbrace{\boldT \widehat{\boldbeta}-\boldcc}_\text{denoted as $\boldZ$} \stackrel{H_0}{\sim} N\{ \;\boldzero,\;\; \underbrace{\sigma^2 \boldT \xtx^{-1} \boldT^T}_\text{denoted as $\boldSigma$} \;\}\)</span> Under the null, <span class="math inline">\(\boldZ^\top \boldSigma^{-1} \boldZ\)</span> should be small</p>
</div>
<div class="frame">
<p>Example 1 Suppose the investigators want to examine whether the two lowest and two highest age intervals could be combined HR_i &amp; = &amp; _0 + _1AG_1i + _2AG_2i +_3AG_3i + _4AG_4i + _i</p>
<p>the pertinent hypotheses can be listed as: <span class="math inline">\(H_0: \beta_1=\beta_2\)</span>, <span class="math inline">\(\beta_4=0\)</span> <span class="math inline">\(H_1: \beta_1 \neq \beta_2\)</span>, or <span class="math inline">\(\beta_4 \neq 0\)</span> re-casting <span class="math inline">\(H_0\)</span> in terms of the GLH, _ &amp; = &amp;</p>
<p><span class="math inline">\(H_0: {\boldT_{\!\sf\scriptscriptstyle{2\times 5}}}\boldbeta_{\!\sf\scriptscriptstyle{5\times1}}={\boldzero }_2\)</span> vs.&nbsp;<span class="math inline">\(H_1: {\boldT}\boldbeta\neq {\boldzero }_2\)</span> test statistic: F = ^2 F_2,n-5</p>
</div>
<div class="frame">
<p>Example 2 <span class="math inline">\(n=26\)</span> subjects selected to participate in a study designed to examine the effects of weight and activity level on cholesterol levels (HDL)</p>
<p>Subjects were placed into one of three groups: Group 1: control (n=8) Group 2: running (n=8) Group 3: running and weight training (n=10) Response: HDL (mg/dl) Covariates: group, weight (lbs) Does the association between weight and HDL differ by group?</p>
</div>
<div class="frame">
<p>Example 2, Stratified SLR models It is common in practice to fit “stratified” models: Group 1: <span class="math inline">\(HDL_i, = \beta_1 + \beta_4 W_i + \epsilon_i\)</span> Group 2: <span class="math inline">\(HDL_i = \beta_2 + \beta_5W_i + \epsilon_i\)</span> Group 3: <span class="math inline">\(HDL_i = \beta_3 + \beta_6W_i + \epsilon_i\)</span> Models are fitted separately to “three datasets" (each group is treated as a separate dataset).</p>
<p>Since there are three distinct regression lines, we have distinct slopes</p>
<p>distinct intercepts</p>
</div>
<div class="frame">
<p>Example 2 (From 3 SLR to 1 MLR) separate SLR models can be fitted on three datasets</p>
<p>Ultimately we wish to see if the set of models can be simplified, i.e., are the 3 slopes the same? if the slopes are the same, are the intercepts also the same? Fitting models separately does not readily allow us to test differences in parameters</p>
<p>We can represent the previous set of group-specific models in a single, more compact MLR model: <span class="math inline">\({\boldY } = {\boldX}\boldbeta + {\boldepsilon}\)</span> where <span class="math inline">\(\boldbeta^T=(\beta_1,\ldots,\beta_6)\)</span>. What should <span class="math inline">\({\boldX}\)</span> be?</p>
</div>
<div class="frame">
<p>Example 2: From Group-specific SLRs to MLR Group 1: <span class="math inline">\({\boldY }_1 = {\boldX}_1\boldbeta_1 + {\boldepsilon}_1\)</span> = +</p>
<p>Group 2: <span class="math inline">\({\boldY }_2 = {\boldX}_2\boldbeta_2 + {\boldepsilon}_2\)</span> = +</p>
<p>Group 3: <span class="math inline">\({\boldY }_3 = {\boldX}_3\boldbeta_3 + {\boldepsilon}_3\)</span> = +</p>
</div>
<div class="frame">
<p>Example 2: From Group-specific SLRs to MLR Group 1: <span class="math inline">\({\boldY }_1 = {\boldX}_1\boldbeta_1 + {\boldepsilon}_1\)</span> = +</p>
<p>Group 2: <span class="math inline">\({\boldY }_2 = {\boldX}_2\boldbeta_2 + {\boldepsilon}_2\)</span> = +</p>
<p>Group 3: <span class="math inline">\({\boldY }_3 = {\boldX}_3\boldbeta_3 + {\boldepsilon}_3\)</span> = +</p>
</div>
<div class="frame">
<p>Example 2 (MLR model) Using the typical MLR <span class="math inline">\({\boldY } = {\boldX}\boldbeta + {\bf \epsilon}\)</span>, where = = =<br>
= <span class="math inline">\(HDL=\beta_1G_{1}+\beta_2G_{2}+\beta_3G_{3}+\beta_4G_{1}W+\beta_5G_{2}W+\beta_6G_{3}W+\epsilon\)</span>, where <span class="math inline">\(G_j=I(\text{group } j),j=1,\dots,3\)</span> and <span class="math inline">\(W=(W_1,\dots,W_{26})\)</span> Note: the above <span class="math inline">\(\boldX\)</span> <em>spans</em>, but does not contain, an intercept</p>
</div>
<div class="frame">
<p>Example 2: parallelism <span class="math inline">\(HDL=\underbrace{\left(\beta_1G_{1}+\beta_2G_{2}+\beta_3G_{3}\right)}_\text{intercept}+\underbrace{\left(\beta_4G_{1}+\beta_5G_{2}+\beta_6G_{3}\right)}_\text{slope}W+\epsilon\)</span> Using the GLH approach, we can test whether the slopes of the group-specific regression lines are equal <span class="math inline">\(H_0: \beta_4=\beta_5=\beta_6\)</span> (lines are parallel),<br>
<span class="math inline">\(H_1:\)</span> at least one of <span class="math inline">\(\beta_j\)</span>, <span class="math inline">\(j=4,5,6\)</span>, is different from the others<br>
(at least one line is not parallel to the others) : <span class="math inline">\(H_0: \beta_4-\beta_5=0\)</span> and <span class="math inline">\(\beta_5-\beta_6=0\)</span>,<br>
<span style="color: white"><strong>Equivalently</strong>:</span> <span class="math inline">\(H_1:\beta_4 - \beta_5 \neq 0\)</span> or <span class="math inline">\(\beta_5 - \beta_6 \neq 0\)</span> Note: third contrast is redundant Re-framing <span class="math inline">\(H_0\)</span> in terms of the GLH, = <span class="math inline">\(H_0: {\boldT}\boldbeta={\boldzero }_2\)</span> vs. <span class="math inline">\(H_1: {\boldT}\boldbeta\neq {\boldzero }_2\)</span></p>
</div>
<div class="frame">
<p>Example 2: parallelism Test statistic: F = &amp; &amp; F_2,20 see R code and output: <span class="math inline">\(F=2.95\)</span> <span class="math inline">\(p=P(F_{2,20}&gt;2.95)=0.075\)</span></p>
<p>This data is consistent with the parallelism hypothesis (null).</p>
<p>We have insufficient evidence to conclude the associations between weight and HDL differ across exercise groups (p=0.075).</p>
</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">
<p><u>Home Exercise</u>: equality of intercepts</p>
<p><span class="math inline">\(HDL=\underbrace{\left(\beta_1G_{1}+\beta_2G_{2}+\beta_3G_{3}\right)}_\text{intercept}+\underbrace{\left(\beta_4G_{1}+\beta_5G_{2}+\beta_6G_{3}\right)}_\text{slope}W+\epsilon\)</span> We can also test the equality of intercepts of the group-specific regression lines <span class="math inline">\(H_0: \beta_1=\beta_2=\beta_3\)</span> Re-write hypotheses find <span class="math inline">\({\boldT}\)</span> in GLH <span class="math inline">\(H_0: {\boldT}\boldbeta= {\boldzero }_2\)</span> vs. <span class="math inline">\(H_1: {\boldT}\boldbeta\neq {\boldzero }_2\)</span> =</p>
<p>Test statistic:</p>
<p><span class="math inline">\(F=~~~~~~~~~~~~~\stackrel{H_0}{\sim} F_{2,20}\)</span> <span class="math inline">\(p=P(F_{2,20}&gt;~~~~~~~~~~~)=\)</span></p>
</div>
<div class="frame">

</div>
<div class="frame">
<p><u>Home Exercise Answer Key</u>: equality of intercepts</p>
<p><span class="math inline">\(HDL=\underbrace{\left(\beta_1G_{1}+\beta_2G_{2}+\beta_3G_{3}\right)}_\text{intercept}+\underbrace{\left(\beta_4G_{1}+\beta_5G_{2}+\beta_6G_{3}\right)}_\text{slope}W+\epsilon\)</span> We can also test the equality of intercepts of the group-specific regression lines <span class="math inline">\(H_0: \beta_1=\beta_2=\beta_3\)</span> Re-write hypotheses <span class="math inline">\(H_0: \beta_1-\beta_2=0, \beta_2-\beta_3=0\)</span><br>
(many different ways, e.g.,) <span class="math inline">\(H_0: \beta_3-\beta_1=0, \beta_2-\beta_1=0\)</span> find <span class="math inline">\({\boldT}\)</span> in GLH <span class="math inline">\(H_0: {\boldT}\boldbeta= {\boldzero }_2\)</span> vs. <span class="math inline">\(H_1: {\boldT}\boldbeta\neq {\boldzero }_2\)</span> =</p>
<p>Test statistic:</p>
<p><span class="math inline">\(F=~~~3.12~~~~\stackrel{H_0}{\sim} F_{2,20}\)</span> <span class="math inline">\(p=P(F_{2,20}&gt;~~~3.12~~~~)=0.066\)</span></p>
</div>
<div class="frame">
<p>Example 2: Connection to reference cell coding and SS <span class="math inline">\(\boxed{HDL=\underbrace{\left(\beta_1G_{1}+\beta_2G_{2}+\beta_3G_{3}\right)}_\text{intercept}+\underbrace{\left(\beta_4G_{1}+\beta_5G_{2}+\beta_6G_{3}\right)}_\text{slope}W+\epsilon}\)</span> <strong>Cell means coding</strong>: <span class="math inline">\(H_0: \underbrace{\beta_5-\beta_4}_\text{2 vs 1}=0; \underbrace{\beta_6-\beta_4}_\text{3 vs 1}=0\)</span> (GLH) Re-parameterize the model: <strong>Reference cell coding</strong>: directly parameterize <span class="math inline">\(\beta_5-\beta_4\)</span> and <span class="math inline">\(\beta_6-\beta_4\)</span> Slope of weight for each group: <span class="math inline">\(H_0:\)</span> Extra SS test: <span class="math inline">\(F~~=~~ \frac{SS(~~~~~~~~~~~~~\mid ~~~~~~~~~~~~~)}{\widehat{\sigma}^2_{\scriptstyle 1}}\stackrel{H_0}{\sim} F_{~~~~,~~~~}\)</span></p>
</div>
<div class="frame">
<p>Example 2: Extra SS Test of interactions <span class="math inline">\(HDL=\gamma_1+\gamma_2G_{2}+\gamma_3G_{3}+\gamma_4W+\gamma_5G_{2}W+\gamma_6G_{3}W+\epsilon\)</span> Test the equality of <strong>slopes</strong> using extra SS &amp; reference cell coding</p>
<p>Equality of slopes: are interactions significant given that main effects are in the model?</p>
<p>Extra SS test for equal slopes: F&amp; = &amp; &nbsp;&nbsp;=&nbsp;&nbsp;2.95&nbsp;&nbsp;&nbsp;&nbsp; F_&nbsp;&nbsp;,&nbsp;&nbsp;</p>
<p>i.e., same result as GLH test of equal slopes</p>
</div>
<div class="frame">

</div>
<div class="frame">
<p>Example 2: Extra SS Test of interactions</p>
<p><span class="math inline">\(HDL=\gamma_1+\gamma_2G_{2}+\gamma_3G_{3}+\gamma_4W+\gamma_5G_{2}W+\gamma_6G_{3}W+\epsilon\)</span> Test the equality of <strong>slopes</strong> using extra SS &amp; reference cell coding</p>
<p>Equality of slopes: are interactions significant given that main effects are in the model?</p>
<p>Extra SS test for equal slopes: F &nbsp;&nbsp;= &nbsp;&nbsp; &nbsp;&nbsp;=&nbsp;&nbsp; 2.95&nbsp;&nbsp;&nbsp;&nbsp; F_2,20</p>
<p>i.e., same result as GLH test of equal slopes</p>
</div>
<div class="frame">
<p><u>Home Exercise</u>: Extra SS Test of Intercepts</p>
<p><span class="math inline">\(HDL=\gamma_1+\gamma_2G_{2}+\gamma_3G_{3}+\gamma_4W+\gamma_5G_{2}W+\gamma_6G_{3}W+\epsilon\)</span> Test the equality of <strong>intercepts</strong> using extra SS &amp; reference cell coding</p>
<p>Equality of slopes: are intercepts significant given that slopes are different?</p>
<p>Extra SS test for equal intercepts: F &amp; = &amp; &nbsp;&nbsp;=&nbsp;&nbsp; 3.12&nbsp;&nbsp;&nbsp;&nbsp;F_&nbsp;&nbsp;,&nbsp;&nbsp;</p>
<p>i.e., same result as GLH test of equal intercepts Note: GLH gives partial test of intercepts, assuming slopes are different (i.e., assuming group x weight interactions are in the model).</p>
</div>
<div class="frame">

</div>
<div class="frame">
<p><u>Home Exercise Answer Key</u>: Extra SS Test of Intercepts</p>
<p><span class="math inline">\(HDL=\gamma_1+\gamma_2G_{2}+\gamma_3G_{3}+\gamma_4W+\gamma_5G_{2}W+\gamma_6G_{3}W+\epsilon\)</span> Test the equality of <strong>intercepts</strong> using extra SS &amp; reference cell coding</p>
<p>Equality of slopes: are intercepts significant given that slopes are different?</p>
<p>Extra SS test for equal intercepts: F &amp; = &amp; &nbsp;&nbsp;=&nbsp;&nbsp; 3.12&nbsp;&nbsp;~&nbsp;&nbsp;F_2,20</p>
<p>i.e., same result as GLH test of equal intercepts Note: GLH gives partial test of intercepts, assuming slopes are different (i.e., assuming group x weight interactions are in the model).</p>
</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">

</div>
<div class="frame">
<p>Constructing Test Statistic (proof)</p>
<p>Recall: <span class="math inline">\(\widehat{\boldbeta} \sim N(\boldbeta, \sigma^2 \xtx^{-1} )\)</span></p>
<p>therefore, <span class="math inline">\(\boldT \widehat{\boldbeta} \sim N\{ \;E[\boldT \widehat{\boldbeta}],\;\; Var(\boldT \widehat{\boldbeta}) \;\}\)</span>, where E[] &amp; = &amp;<br>
Var()&amp; &amp; Var() ^T<br>
&amp; = &amp; ^2 ^-1 ^T</p>
<p>Under the null hypothesis <span class="math inline">\(E[\boldT \widehat{\boldbeta} - {\boldcc}] =\boldT \boldbeta - {\boldcc}= {\boldzero }\)</span></p>
<p>Therefore, <span class="math inline">\(\underbrace{\boldT \widehat{\boldbeta}-\boldcc}_\text{$\boldY$} \stackrel{H_0}{\sim} N\{ \;\boldzero,\;\; \underbrace{\sigma^2 \boldT \xtx^{-1} \boldT^T}_\text{$\boldSigma$} \;\}\)</span></p>
<p>Applying Results 1-2 in the footnote <span class="math display">\[\boxed{
    (\boldT \widehat{\boldbeta}-{\boldcc} )^T \{\sigma^2 \boldT \xtx^{-1} \boldT^T \}^{-1}   (\boldT \widehat{\boldbeta}-{\boldcc}) \sim \chi^2_{\scriptstyle \text{rank($\boldT$), $\lambda=0$}}
}\]</span></p>
</div>
<div class="frame">
<p>Constructing Test Statistic (proof continued) We have <span class="math inline">\((\boldT \widehat{\boldbeta}-{\boldcc} )^T \{\sigma^2 \boldT \xtx^{-1} \boldT^T \}^{-1} (\boldT \widehat{\boldbeta}-{\boldcc}) \stackrel{H_0}{\sim} \chi^2_{\scriptstyle \text{rank($\boldT$), $\lambda=0$}}\)</span> <span class="math inline">\(\frac{SSE}{\sigma^2 } \sim \chi^2_{\text{$n\!-\!p,\lambda \stackrel{\scriptscriptstyle \text{LINE}}{=}0$} }\)</span> and <span class="math inline">\(\widehat{\boldbeta}\ind SSE\)</span> (Module F)</p>
<p>To derive a test statistic, we take their ratio (divide each by df)</p>
<p>F &amp; = &amp; (SSE/^2)/(n-p)<br>
&amp; = &amp;<br>
&amp; &amp; F_rank( <strong>T</strong>),n-p</p>
</div>
<div class="frame">
<p>Questions?</p>
</div>
<div class="frame">
<p>Group project Group assignments available on Canvas “People" page Presentation on December 6th and 8th Presentation order randomly assigned. Please email us if you are not in the US time zone and have time constraints Project report due at 11:59pm on December 10th Sample project report</p>
</div>
<div class="frame">
<p>Confounding Definition: a pre-exposure variable that, conditional on other covariates, is associated with outcome conditional on exposure associated with exposure/treatment/POI</p>
<div class="columns">
<div class="column">
<p>0.5</p>
</div><div class="column">
<p>0.5</p>
</div>
</div>
<p>We adjust for confounders when studying the association between the predictor of interest (POI) and the outcome Crude treatment effect is biased unless treatment is randomized</p>
</div>
<div class="frame">
<p>Group project</p>
<p><strong>Determine question of interest (X and Y) via literature review</strong> hypothesis generation via e.g., model selection is not necessary model selection for inference questions is not recommended</p>
<p><strong>Determine confounders to adjust via literature review</strong></p>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>