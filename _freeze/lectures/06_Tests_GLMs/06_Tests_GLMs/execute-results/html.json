{
  "hash": "41bd0cacefb564d066b2f6469bc47845",
  "result": {
    "markdown": "---\ntitle: \"Lesson 6: Tests for GLMs using Likelihood function\"\nauthor: \"Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#C2352F\"\ndate: \"04/17/2024\"\nformat: \n  revealjs:\n    theme: \"../simple_NW.scss\"\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: \"Lesson 6: Tests for GLMs using Likelihood function\"\n    html-math-method: mathjax\n    highlight-style: ayu\nexecute:\n  echo: true\n  freeze: auto  # re-render only when source changes\n---\n\n::: {.cell}\n\n:::\n\n\n## I've never explicitly said this...\n\n-   Because we are in a public health class, we are often analyzing data with sensitive outcomes\n\n \n\n-   If you ever need a moment in class because of our topic, feel free to just step out or leave and privately view the lecture\n\n \n\n-   If you need extra time on your assignments because you have an emotional response to lectures/homework/lab, just let me know! Extenuating circumstance!\n\n# Learning Objectives\n\n1.  Use the Wald test to test the significance of an estimated coefficient through confidence intervals.\n\n2.  Articulate how the Wald test, Score test, and likelihood ratio test (LRT) calculates a test statistic using the likelihood function.\n\n3.  Use the Likelihood ratio test to test the significance of estimated coefficients through formal hypothesis testing.\n\n4.  Understand when and how to use each test: Wald, Score, and Likelihood ratio\n\n\n::: {.cell}\n<style type=\"text/css\">\n.reveal code {\n  max-height: 80% !important;\n}\n</style>\n:::\n\n\n## Connection between tests in linear models and GLMs\n\n-   In linear regression, we used ordinary least squares (OLS) to find the best fit model, so we could use the following tests:\n\n    -   t-test for single coefficients\n    -   F-test for single coefficients or groups of coefficients\n\n-   These tests **hinge on the Mean Squared Error (MSE)** which we minimized in OLS and the LINE assumptions\n\n \n\n-   In GLMs, when we use **maximum likelihood estimation (MLE)**, we **cannot** use t-tests or F-tests\n\n    -   Because we are now using likelihood to find our estimates (not OLS)\n\n-   But we have **parallel tests in MLE**!!\n\n    -   t-test ⟶ Wald test\n\n    -   F-test ⟶ Likelihood ratio test\n\n## Revisit the likelihood function\n\n::: columns\n::: {.column width=\"50%\"}\n-   [Likelihood function:]{style=\"color:#F6C342; font-weight: bold;\"} expresses the probability of the observed data as a function of the unknown parameters\n\n    -   Function that enumerates the likelihood (similar to probability) that we observe the data across the range of potential values of our coefficients\n\n-   We often compare likelihoods to see what estimates are more likely given our data\n\n-   Plot to right is a simplistic view of likelihood\n\n    -   I have flattened the likelihood that would be a function of $\\beta_0$ and $\\beta_1$ into a 2D plot (instead of 3D: $\\beta_0$ vs. $\\beta_1$ vs. $L(\\beta_0, \\beta_1)$)\n\n-   I use $L$ to represent the log-likelihood and $l$ to represent the likelihood\n:::\n\n::: {.column width=\"50%\"}\n \n\n \n\n![](./images/like_fn.png){fig-align=\"center\"}\n:::\n:::\n\n## Introduction to three tests in GLM\n\n-   To introduce these three tests, we will work on a **single coefficient**\n\n    -   To be clear: the *Likelihood ratio test can be extended to more coefficients*\n\n-   Let's say we fit a GLM using MLE\n\n    -   We will continue to use logistic regression as our working example\n\n \n\n-   Now we want to run a hypothesis test for an individual coefficient $j$:\n\n    -   $H_0: \\beta_j = 0$\n    -   $H_1: \\beta_j \\neq 0$\n\n-   Three potential tests that we use with a Likelihood function are:\n\n    -   [Wald test]{style=\"background-color:#D5E2F1;\"}\n    -   [Score test]{style=\"background-color:#F9E7B8;\"}\n    -   [Likelihood ratio test (LRT)]{style=\"background-color:#CADFB8;\"}\n\n## Poll Everywhere Question 1\n\n## Revisit previous model with late stage BC diagnosis and age\n\n::: columns\n::: {.column width=\"55%\"}\n-   Simple logistic regression model: $$\\text{logit}(\\pi(Age)) = \\beta_0 + \\beta_1 \\cdot Age$$\n:::\n\n::: {.column width=\"45%\"}\n \n\nDon't forget: $\\pi(Age) = P(Y=1 | Age)$\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbc_reg = glm(Late_stage_diag ~ Age_c, data = bc, family = binomial)\nsummary(bc_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Late_stage_diag ~ Age_c, family = binomial, data = bc)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)    \n(Intercept) -0.989422   0.023205  -42.64   <2e-16 ***\nAge_c        0.056965   0.003204   17.78   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 11861  on 9999  degrees of freedom\nResidual deviance: 11510  on 9998  degrees of freedom\nAIC: 11514\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\n# Learning Objectives\n\n::: lob\n1.  Use the Wald test to test the significance of an estimated coefficient through confidence intervals.\n\n2.  Articulate how the **Wald test**, Score test, and likelihood ratio test (LRT) calculates a test statistic using the likelihood function.\n:::\n\n3.  Use the Likelihood ratio test to test the significance of estimated coefficients through formal hypothesis testing.\n\n4.  Understand when and how to use each test: Wald, Score, and Likelihood ratio\n\n## Wald test (1/3) {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   Very similar to a t-test!\n\n    -   But slightly different because it based in our likelihood function\n\n-   Assumes test statistic W follows a standard normal distribution under the null hypothesis\n\n-   Test statistic: $$W=\\frac{{\\hat{\\beta}}_j}{se({\\hat{\\beta}}_j)}\\sim N(0,1)$$\n\n    -   where $\\widehat{\\beta}_j$ is a MLE of coefficient $j$\n\n-   95% Wald confidence interval: $${\\hat{\\beta}}_1\\pm1.96 \\cdot SE_{{\\hat{\\beta}}_j}$$\n\n-   The Wald test is a routine output in R (`summary()` of `glm()` output)\n\n    -   Includes $SE_{{\\hat{\\beta}}_j}$ and can easily find confidence interval with `tidy()`\n\n## Wald test (2/3) {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n![](./images/like_fn.png){fig-align=\"center\"}\n\n## Wald test (3/3) {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n![](./images/wald.png){fig-align=\"center\"}\n\n## Wald test procedure with confidence intervals {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n1.  Set the [**level of significance**]{style=\"color:#5B9BD5\"} $\\alpha$\n\n2.  Specify the [**null**]{style=\"color:#5B9BD5\"} ( $H_0$ ) and [**alternative**]{style=\"color:#5B9BD5\"} ( $H_A$ ) [**hypotheses**]{style=\"color:#5B9BD5\"}\n\n    -   In symbols\n    -   In words\n    -   Alternative: one- or two-sided?\n\n3.  Calculate the [**confidence interval**]{style=\"color:#5B9BD5\"} and [**determine if it overlaps with null**]{style=\"color:#5B9BD5\"}\n\n    -   Overlap with null (usually 0 for coefficient) = fail to reject null\n    -   No overlap with null (usually 0 for coefficient) = reject null\n\n4.  Write a [**conclusion**]{style=\"color:#5B9BD5\"} to the hypothesis test\n\n    -   What is the estimate and its confidence interval?\n    -   Do we reject or fail to reject $H_0$?\n    -   Write a conclusion in the context of the problem\n\n## Example: BC diagnosis and age {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nWald test for age coefficient\n:::\n\n::: ex-cont\nInterpret the coefficient for age in our model of late stage breast cancer diagnosis.\n:::\n:::\n\n::: columns\n::: {.column width=\"60%\"}\n**Needed steps:**\n\n1.  Set the **level of significance** $\\alpha$\n2.  Specify the **null** ( $H_0$ ) and **alternative** ( $H_A$ ) **hypotheses**\n3.  Calculate the **confidence interval** and **determine if it overlaps with null**\n4.  Write a **conclusion** to the hypothesis test\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNote\n:::\n\n::: proof-cont\nI don't want us to get fixated on this interpretation. This is more to introduce the process, BUT it's MUCH better to interpret the coefficient in terms of OR (next class).\n:::\n:::\n:::\n:::\n\n## Example: BC diagnosis and age {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nWald test for age coefficient\n:::\n\n::: ex-cont\nInterpret the coefficient for age in our model of late stage breast cancer diagnosis.\n:::\n:::\n\n1.  Set the **level of significance** $\\alpha$ $$\\alpha=0.05$$\n2.  Specify the **null** ( $H_0$ ) and **alternative** ( $H_A$ ) **hypotheses**\n\n$$\\begin{aligned}\nH_0 &: \\beta_{Age} = 0 \\\\\nH_1 &: \\beta_{Age} \\neq 0 \\\\\n\\end{aligned}$$\n\n## Example: BC diagnosis and age {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nWald test for age coefficient\n:::\n\n::: ex-cont\nInterpret the coefficient for age in our model of late stage breast cancer diagnosis.\n:::\n:::\n\n3.  Calculate the **confidence interval** and **determine if it overlaps with null**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(epiDisplay)\nbc_reg = glm(Late_stage_diag ~ Age_c, data = bc, family = binomial)\ntidy(bc_reg, conf.int=T) %>% gt() %>% tab_options(table.font.size = 35) %>%\n  fmt_number(decimals = 3)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"hvtldetukq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hvtldetukq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hvtldetukq thead, #hvtldetukq tbody, #hvtldetukq tfoot, #hvtldetukq tr, #hvtldetukq td, #hvtldetukq th {\n  border-style: none;\n}\n\n#hvtldetukq p {\n  margin: 0;\n  padding: 0;\n}\n\n#hvtldetukq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 35px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hvtldetukq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hvtldetukq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hvtldetukq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hvtldetukq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hvtldetukq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hvtldetukq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hvtldetukq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hvtldetukq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hvtldetukq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hvtldetukq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hvtldetukq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hvtldetukq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hvtldetukq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hvtldetukq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hvtldetukq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hvtldetukq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hvtldetukq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hvtldetukq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hvtldetukq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hvtldetukq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hvtldetukq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hvtldetukq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hvtldetukq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hvtldetukq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hvtldetukq .gt_left {\n  text-align: left;\n}\n\n#hvtldetukq .gt_center {\n  text-align: center;\n}\n\n#hvtldetukq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hvtldetukq .gt_font_normal {\n  font-weight: normal;\n}\n\n#hvtldetukq .gt_font_bold {\n  font-weight: bold;\n}\n\n#hvtldetukq .gt_font_italic {\n  font-style: italic;\n}\n\n#hvtldetukq .gt_super {\n  font-size: 65%;\n}\n\n#hvtldetukq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hvtldetukq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hvtldetukq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hvtldetukq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hvtldetukq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hvtldetukq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hvtldetukq .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.low\">conf.low</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"conf.high\">conf.high</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">−0.989</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.023</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">−42.637</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.000</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">−1.035</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">−0.944</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">Age_c</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.057</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.003</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">17.780</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.000</td>\n<td headers=\"conf.low\" class=\"gt_row gt_right\">0.051</td>\n<td headers=\"conf.high\" class=\"gt_row gt_right\">0.063</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n## Example: BC diagnosis and age {background-image=\"./images/title_blue.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nWald test for age coefficient\n:::\n\n::: ex-cont\nInterpret the coefficient for age in our model of late stage breast cancer diagnosis.\n:::\n:::\n\n::: columns\n::: {.column width=\"60%\"}\n4.  Write a **conclusion** to the hypothesis test\n\nFor every one year increase in age, the log-odds of late stage breast cancer diagnosis increases 0.057 (95% CI: 0.051, 0.063).\n\nThere is sufficient evidence that age an breast cancer diagnosis are associated.\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNote\n:::\n\n::: proof-cont\nI don't want us to get fixated on this interpretation. This is more to introduce the process, BUT it's MUCH better to interpret the coefficient in terms of OR (next class).\n:::\n:::\n:::\n:::\n\n## Poll Everywhere Question 2\n\n# Learning Objectives\n\n1.  Use the Wald test to test the significance of an estimated coefficient through confidence intervals.\n\n::: lob\n2.  Articulate how the Wald test, **Score test**, and likelihood ratio test (LRT) calculates a test statistic using the likelihood function.\n:::\n\n3.  Use the Likelihood ratio test to test the significance of estimated coefficients through formal hypothesis testing.\n\n4.  Understand when and how to use each test: Wald, Score, and Likelihood ratio\n\n## Score test {background-image=\"./images/title_yell.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   Score test does not require the computation of MLE for $\\beta_1$, while both likelihood test and Wald test does\n\n    -   Only need to know $\\beta_1$ under the null\n\n-   Score test is based on the first and second derivatives of the log-likelihood under the null hypothesis: $$S=\\frac{\\sum_{i=1}^{n}{x_i(y_i-\\bar{y})}}{\\sqrt{\\bar{y}(1-\\bar{y})\\sum_{i=1}^{n}\\left(x_i-\\bar{x}\\right)^2}} \\sim N(0,1)$$\n\n## Score test {background-image=\"./images/title_yell.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n![](./images/score.png){fig-align=\"center\"}\n\n# Learning Objectives\n\n\n1.  Use the Wald test to test the significance of an estimated coefficient through confidence intervals.\n\n::: lob\n2.  Articulate how the Wald test, Score test, and **likelihood ratio test (LRT)** calculates a test statistic using the likelihood function.\n\n3.  Use the Likelihood ratio test to test the significance of estimated coefficients through formal hypothesis testing.\n:::\n\n4.  Understand when and how to use each test: Wald, Score, and Likelihood ratio\n\n## Likelihood ratio test (1/3) {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   Likelihood ratio test answers the question:\n\n    -   For a specific covariate, **which model tell us more about the outcome variable**: the model including the covariate or the model omitting the covariate?\n    -   Aka: Which model is more likely given our data: model including the covariate or the model omitting the covariate?\n\n \n\n-   Test a single coefficient by comparing different models\n\n    -   **Very similar to the F-test**\n\n \n\n-   Important: LRT can be used conduct hypothesis tests for **multiple coefficients**\n\n    -   Just like F-test, we can test a single coefficient, continuous/binary covariate, multi-level covariate, or multiple covariates\n\n## Likelihood ratio test (2/3) {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   To assess the significance of a continuous/binary covariate’s coefficient in the simple logistic regression, we compare the deviance (D) with and without the covariate $$G=D\\left(\\text{model without } x\\right)-D\\left(\\text{model with } x\\right)$$\n\n \n\n-   For a continuous or binary variable, this is equivalent to test: $H_0: \\beta_j = 0$ vs. $H_1: \\beta_j \\neq 0$\n\n-   Test statistic for LRT: $$G=-2ln\\left[\\frac{\\text{likelihood without } x}{\\text{likelihood with } x}\\right]=2ln\\left[\\frac{l\\left({\\hat{\\beta}}_0,{\\hat{\\beta}}_1\\right)}{l({\\hat{\\beta}}_0)}\\right]$$\n\n## Likelihood ratio test (2/3) {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   To assess the significance of a continuous/binary covariate’s coefficient in the simple logistic regression, we compare the deviance (D) with and without the covariate $$G=D\\left(\\text{model without } x\\right)-D\\left(\\text{model with } x\\right)$$\n\n \n\n-   For a continuous or binary variable, this is equivalent to test: $H_0: \\beta_j = 0$ vs. $H_1: \\beta_j \\neq 0$\n\n-   Test statistic for LRT: $$G=-2ln\\left[\\frac{\\text{likelihood without } x}{\\text{likelihood with } x}\\right]=2ln\\left[\\frac{l\\left({\\hat{\\beta}}_0,{\\hat{\\beta}}_1\\right)}{l({\\hat{\\beta}}_0)}\\right]$$\n\n![](./images/pause.png){.absolute bottom=\"7%\" right=\"0%\" width=\"300\" height=\"300\"}\n\n## LRT: what is Deviance? {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   **Deviance:** quantifies the difference in likelihoods between a [fitted]{style=\"color:#F6C342; font-weight: bold;\"} and [saturated]{style=\"color:#ED7D31; font-weight: bold;\"} model\n\n    -   [Fitted model:]{style=\"color:#F6C342; font-weight: bold;\"}\n\n        -   Your proposed fitted model\n\n    -   [Saturated model:]{style=\"color:#ED7D31; font-weight: bold;\"}\n\n        -   A model that contains as many parameters as there are data points = **perfect fit**\n            -   Basically every individual has their own covariate\n        -   Perfect fit = maximum possible likelihood\n\n \n\n-   **All fitted models will have likelihood less than saturated model**\n\n![](./images/tiny_pause.png){.absolute top=\"83%\" right=\"0%\" width=\"120\" height=\"120\"}\n\n## LRT: what is Deviance? {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   The **deviance** is mathematically defined as: $$D=-2[L_{\\text{fitted}}-L_{\\text{saturated}}]$$\n\n-   An alternative way to write it is: $$D=-2ln\\left[\\frac{\\text{likelihood of the fitted model}}{\\text{likelihood of the saturated model}}\\right]$$\n\n-   Using ‘-2’ is to make the deviance follow a chi-square distribution\n\n![](./images/tiny_pause.png){.absolute top=\"83%\" right=\"0%\" width=\"120\" height=\"120\"}\n\n## Deviance to Likelihood Ratio Test {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   In the LRT, we are NOT comparing the likelihood of saturated model to the fitted model\n\n \n\n-   We ARE comparing the Deviance of the model with x and the model without x\n\n    -   We just use the saturated model to calculate Deviance\n    -   Both are considered fitted models with their own respective Deviance\n\n \n\n-   So our LRT is: $$G=D\\left(\\text{model without } x\\right)-D\\left(\\text{model with } x\\right)$$\n\n![](./images/tiny_pause.png){.absolute top=\"83%\" right=\"0%\" width=\"120\" height=\"120\"}\n\n## For reference {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n$$ \\begin{aligned}\nG&=D\\left(\\text{model without } x\\right)-D\\left(\\text{model with }x\\right) \\\\\nG&=-2ln\\left[\\frac{\\text{likelihood of model without } x}{\\text{likelihood of saturated model}}\\right]-\\left(-2ln\\left[\\frac{\\text{likelihood of model with } x}{\\text{likelihood of saturated model}}\\right]\\right) \\\\\nG&=-2ln\\left[\\frac{\\text{likelihood of model without } x}{\\text{likelihood of saturated model}}\\times\\frac{\\text{likelihood of saturated model}}{\\text{likelihood of model with } x}\\right] \\\\\nG&=-2ln\\left[\\frac{\\text{likelihood of model without } x}{\\text{likelihood of model with }}\\right] \\\\\nG&=2ln\\left[\\frac{l\\left({\\hat{\\beta}}_0,{\\hat{\\beta}}_1\\right)}{l({\\hat{\\beta}}_0)}\\right]\n\\end{aligned}$$\n\n![](./images/tiny_pause.png){.absolute top=\"83%\" right=\"0%\" width=\"120\" height=\"120\"}\n\n## Poll Everywhere Question 3\n\n## Likelihood ratio test (2/3) {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   To assess the significance of a continuous/binary covariate’s coefficient in the simple logistic regression, we compare the deviance (D) with and without the covariate $$G=D\\left(\\text{model without } x\\right)-D\\left(\\text{model with } x\\right)$$\n\n \n\n-   For a continuous or binary variable, this is equivalent to test: $H_0: \\beta_j = 0$ vs. $H_1: \\beta_j \\neq 0$\n\n-   Test statistic for LRT: $$G=-2ln\\left[\\frac{\\text{likelihood without } x}{\\text{likelihood with } x}\\right]=2ln\\left[\\frac{l\\left({\\hat{\\beta}}_0,{\\hat{\\beta}}_1\\right)}{l({\\hat{\\beta}}_0)}\\right]$$\n\n![](./images/play.png){.absolute bottom=\"7%\" right=\"0%\" width=\"300\" height=\"300\"}\n\n## Likelihood ratio test (3/3) {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n-   Under the null hypothesis, with adequate sample size, LRT statistic follows a chi-square distribution: $$G \\sim \\chi^2(df)$$\n\n    -   $df = (\\# \\text{coefficients in larger model}) − (\\# \\text{coefficients in smaller model})$\n\n \n\n-   If we are testing a single coefficient, like age, then $df=1$\n\n## Likelihood ratio test {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n![](./images/lrt.png){fig-align=\"center\"}\n\n## LRT procedure {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n1.  Set the [**level of significance**]{style=\"color:#70AD47\"} $\\alpha$\n\n2.  Specify the [**null**]{style=\"color:#70AD47\"} ( $H_0$ ) and [**alternative**]{style=\"color:#70AD47\"} ( $H_A$ ) [**hypotheses**]{style=\"color:#70AD47\"}\n\n    -   In symbols\n    -   In words\n    -   Alternative: one- or two-sided?\n\n3.  Calculate the [**test statistic**]{style=\"color:#70AD47\"} and [**p-value**]{style=\"color:#70AD47\"}\n\n4.  Write a [**conclusion**]{style=\"color:#70AD47\"} to the hypothesis test\n\n    -   Do we reject or fail to reject $H_0$?\n    -   Write a conclusion in the context of the problem\n\n## Example: BC diagnosis and age {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nLRT\n:::\n\n::: ex-cont\nDetermine if the model including age is more likely than model without age. Aka: Is age associated with late stage breast cancer diagnosis?\n:::\n:::\n\n**Needed steps:**\n\n1.  Set the **level of significance** $\\alpha$\n2.  Specify the **null** ( $H_0$ ) and **alternative** ( $H_A$ ) **hypotheses**\n3.  Calculate the **test statistic** and **p-value**\n4.  Write a **conclusion** to the hypothesis test\n\n## Example: BC diagnosis and age {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nLRT\n:::\n\n::: ex-cont\nDetermine if the model including age is more likely than model without age. Aka: Is age associated with late stage breast cancer diagnosis?\n:::\n:::\n\n1.  Set the **level of significance** $\\alpha$ $$\\alpha=0.05$$\n2.  Specify the **null** ( $H_0$ ) and **alternative** ( $H_A$ ) **hypotheses**\n\n$$\\begin{aligned}\nH_0 &: \\beta_{Age} = 0 \\\\\nH_1 &: \\beta_{Age} \\neq 0 \\\\\n\\end{aligned}$$\n\n## Example: BC diagnosis and age {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nLRT\n:::\n\n::: ex-cont\nDetermine if the model including age is more likely than model without age. Aka: Is age associated with late stage breast cancer diagnosis?\n:::\n:::\n\n3.  Calculate the **test statistic** and **p-value**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lmtest)\nbc_age = glm(Late_stage_diag ~ Age_c, data = bc, family = binomial)\nbc_int = glm(Late_stage_diag ~ 1, data = bc, family = binomial)\nlmtest::lrtest(bc_age, bc_int)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLikelihood ratio test\n\nModel 1: Late_stage_diag ~ Age_c\nModel 2: Late_stage_diag ~ 1\n  #Df  LogLik Df  Chisq Pr(>Chisq)    \n1   2 -5754.8                         \n2   1 -5930.5 -1 351.27  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Example: BC diagnosis and age {background-image=\"./images/title_green.png\" background-size=\"2500px 150px\" background-position=\"top\"}\n\n::: example\n::: ex-title\nLRT\n:::\n\n::: ex-cont\nDetermine if the model including age is more likely than model without age. Aka: Is age associated with late stage breast cancer diagnosis?\n:::\n:::\n\n4.  Write a **conclusion** to the hypothesis test\n\nWe reject the null hypothesis that the coefficient corresponding to age is 0 ($p-value << 0.05$). There is sufficient evidence that there is an association between age and late stage breast cancer diagnosis.\n\n# Learning Objectives\n\n\n1.  Use the Wald test to test the significance of an estimated coefficient through confidence intervals.\n\n2.  Articulate how the Wald test, Score test, and likelihood ratio test (LRT) calculates a test statistic using the likelihood function.\n\n3.  Use the Likelihood ratio test to test the significance of estimated coefficients through formal hypothesis testing.\n\n::: lob\n4.  Understand when and how to use each test: Wald, Score, and Likelihood ratio\n:::\n\n## All three tests together\n\n![](./images/three_tests.png){fig-align=\"center\"}\n\n[UCLA FAQ on Tests](https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faqhow-are-the-likelihood-ratio-wald-and-lagrange-multiplier-score-tests-different-andor-similar/)\n\n## Which test to use?\n\n-   All three tests are asymptotically equivalent\n\n    -   As sample approaches infinity\n\n-   For testing significance of single covariate coefficient:\n\n    -   [LRT]{style=\"background-color:#CADFB8;\"}\n\n        -   Wald and score are only approximations of LRT\n        -   For smaller samples, LRT better\n\n    -   [Wald test]{style=\"background-color:#D5E2F1;\"} is very convenient\n\n        -   Automatically performed in R\n        -   Does not need to estimate two models (LRT does)\n        -   Good for constructing confidence intervals of coefficients and odds ratios\n\n    -   [Score test]{style=\"background-color:#F9E7B8;\"}\n\n        -   Does not need to estimate two models (LRT does)\n        -   I don’t really see people use this…\n\n## Poll Everywhere Question 4\n\n## Poll Everywhere Question 5\n\n## Poll Everywhere Question 6\n\n## Poll Everywhere Question 7\n\n## Poll Everywhere Question 8\n\n## Tests and what they're used for\n\n|                                                                                                  | Wald test | Score test | LRT |\n|-------------------------|----------------|----------------|----------------|\n| Used to test significance of single coefficient                                                  |           |            |     |\n| *Can be* used to report confidence interval for a single coefficient                             |           |            |     |\n| Confidence interval reported by R for a single coefficient (and most commonly used)              |           |            |     |\n| Use to test significance/contribution to outcome prediction of multi-level categorical covariate |           |            |     |\n| Used for comparing two models with different (but nested) covariates                             |           |            |     |\n\n## Tests and what they're used for {visibility=\"hidden\"}\n\n|                                                                                                  | Wald test                                                                | Score test                                                               | LRT                                                                      |\n|-------------------------|----------------|----------------|----------------|\n| Used to test significance of single coefficient                                                  | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   |\n| *Can be* used to report confidence interval for a single coefficient                             | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   |\n| Confidence interval reported by R for a single coefficient (and most commonly used)              | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} |\n| Use to test significance/contribution to outcome prediction of multi-level categorical covariate | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   |\n| Used for comparing two models with different (but nested) covariates                             | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} | [{{< iconify f7 xmark-square-fill size=70px >}}]{style=\"color:#C2352F;\"} | [{{< iconify ic round-check-box size=70px >}}]{style=\"color:#70AD47;\"}   |\n\n## So how would the Wald test and LRT show up in research?\n\n-   Wald test\n\n    -   Often used when reporting estimates\n\n    -   Generally presented using a forest plot or table of ORs or RRs\n\n        -   Then we highlight the specific variable of interest in text\n        -   Will include the OR/RR estimate (not the coefficient like we saw today) with the 95% CI and proper interpretation of result\n\n \n\n-   LRT\n\n    -   Often when performing model selection and comparing two models\n\n        -   [Reporting model selection Cross Validated post](https://stats.stackexchange.com/questions/27479/model-selection-in-a-paper-what-to-say-about-the-dropped-variables)\n\n    -   Often does not show up explicitly in our reports, but is essential to get to our final model!!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}