{
  "hash": "f91734a4614bd68f6b6be1de705b81c4",
  "result": {
    "markdown": "---\ntitle: \"SLR: Model Evaluation and Diagnostics\"\nauthor: \"Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#213c96\"\ndate: \"01/29/2023\"\ncategories: [\"Week 4\"]\nformat: \n  revealjs:\n    theme: [default, simple_NW.scss]\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: SLR 4\n    html-math-method: mathjax\n    highlight-style: ayu\nexecute:\n  echo: true\n  freeze: auto  # re-render only when source changes\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\n\n\n## Let's remind ourselves of the model that we have been working with\n\n-   We have been looking at the association between life expectancy and\n    female literacy rate\n\n-   We used OLS to find the coefficient estimates of our best-fit line\n\n::: columns\n::: {.column width=\"55%\"}\n$$Y = \\beta_0 + \\beta_1 X + \\epsilon$$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"whttayqsuq\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#whttayqsuq table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#whttayqsuq thead, #whttayqsuq tbody, #whttayqsuq tfoot, #whttayqsuq tr, #whttayqsuq td, #whttayqsuq th {\n  border-style: none;\n}\n\n#whttayqsuq p {\n  margin: 0;\n  padding: 0;\n}\n\n#whttayqsuq .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 40px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#whttayqsuq .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#whttayqsuq .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#whttayqsuq .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#whttayqsuq .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#whttayqsuq .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#whttayqsuq .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#whttayqsuq .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#whttayqsuq .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#whttayqsuq .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#whttayqsuq .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#whttayqsuq .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#whttayqsuq .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#whttayqsuq .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#whttayqsuq .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whttayqsuq .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#whttayqsuq .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#whttayqsuq .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#whttayqsuq .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whttayqsuq .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#whttayqsuq .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whttayqsuq .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#whttayqsuq .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whttayqsuq .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#whttayqsuq .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#whttayqsuq .gt_left {\n  text-align: left;\n}\n\n#whttayqsuq .gt_center {\n  text-align: center;\n}\n\n#whttayqsuq .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#whttayqsuq .gt_font_normal {\n  font-weight: normal;\n}\n\n#whttayqsuq .gt_font_bold {\n  font-weight: bold;\n}\n\n#whttayqsuq .gt_font_italic {\n  font-style: italic;\n}\n\n#whttayqsuq .gt_super {\n  font-size: 65%;\n}\n\n#whttayqsuq .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#whttayqsuq .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#whttayqsuq .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#whttayqsuq .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#whttayqsuq .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#whttayqsuq .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#whttayqsuq .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"term\">term</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"estimate\">estimate</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"std.error\">std.error</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"statistic\">statistic</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p.value\">p.value</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">(Intercept)</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">50.93</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">2.66</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">19.14</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n    <tr><td headers=\"term\" class=\"gt_row gt_left\">female_literacy_rate_2011</td>\n<td headers=\"estimate\" class=\"gt_row gt_right\">0.23</td>\n<td headers=\"std.error\" class=\"gt_row gt_right\">0.03</td>\n<td headers=\"statistic\" class=\"gt_row gt_right\">7.38</td>\n<td headers=\"p.value\" class=\"gt_row gt_right\">0.00</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n```{=tex}\n\\begin{aligned}\n\\widehat{Y} &= \\widehat\\beta_0 + \\widehat\\beta_1 \\cdot X\\\\\n\\widehat{\\text{life expectancy}} &= 50.9 + 0.232 \\cdot \\text{female literacy rate}\n\\end{aligned}\n```\n\n\n:::\n\n::: {.column width=\"2%\"}\n:::\n\n::: {.column width=\"43%\"}\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nRows: 188 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): country\ndbl (2): life_expectancy_years_2011, female_literacy_rate_2011\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-3-1.png){width=1056}\n:::\n:::\n\n\n:::\n:::\n\n## Our residuals will help us a lot in our diagnostics!\n\n::: columns\n::: {.column width=\"35%\"}\n-   The **residuals** $\\widehat\\epsilon_i$ are the vertical distances\n    between\n\n    -   the observed data $(X_i, Y_i)$\n    -   the fitted values (regression line)\n        $\\widehat{Y}_i = \\widehat\\beta_0 + \\widehat\\beta_1 X_i$\n:::\n\n::: {.column width=\"65%\"}\n$$\n\\widehat\\epsilon_i =Y_i - \\widehat{Y}_i \\text{,   for } i=1, 2, ..., n\n$$\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=1056}\n:::\n:::\n\n\n:::\n:::\n\n# Learning Objectives\n\n::: lob\n1.  Describe the model assumptions made in linear regression using ordinary least squares\n:::\n\n2.  Determine if the relationship between our sampled X and Y is linear\n\n3.  Use QQ plots to determine if our fitted model holds the normality assumption\n\n4.  Use residual plots to determine if our fitted model holds the equality of variance assumption\n\n## Least-squares model assumptions: LINE\n\n \n\nThese are the model assumptions made in ordinary least squares:\n\n \n\n::: L\n**\\[L\\] Linearity** of relationship between variables\n:::\n\n::: I\n**\\[I\\] Independence** of the $Y$ values\n:::\n\n::: N\n**\\[N\\] Normality** of the $Y$'s given $X$ (residuals)\n:::\n\n::: E\n**\\[E\\] Equality** of variance of the residuals (homoscedasticity)\n:::\n\n## L: Linearity\n\n::: columns\n::: {.column width=\"35%\"}\n-   The relationship between the variables is linear (a straight line):\n    -   The mean value of $Y$ given $X$, $\\mu_{y|x}$ or $E[Y|X]$, is a\n        straight-line function of $X$\n\n$$\\mu_{y|x} = \\beta_0 + \\beta_1 \\cdot X$$\n:::\n\n::: {.column width=\"65%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_point(size = 3, se = FALSE): Ignoring unknown parameters: `se`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=1056}\n:::\n:::\n\n\n:::\n:::\n\n## I: Independence of observations\n\n-   The $Y$-values are statistically independent of one another\n\n-   Examples of when they are *not* independent, include\n\n    -   repeated measures (such as baseline, 3 months, 6 months)\n\n    -   data from clusters, such as different hospitals or families\n\n-   This condition is checked by reviewing the study *design* and not by\n    inspecting the data\n\n \n\n-   How to analyze data using regression models when the $Y$-values are\n    not independent is covered in BSTA 519 (Longitudinal data)\n\n## Poll Everywhere Question 1\n\n## N: Normality\n\n::: columns\n::: column\n-   For any fixed value of $X$, $Y$ has normal distribution.\n    -   Note: This is not about $Y$ alone, but $Y|X$\n-   Equivalently, the measurement (random) errors $\\epsilon_i$ ’s\n    normally distributed\n    -   This is more often what we check\n:::\n\n::: column\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=1056}\n:::\n:::\n\n\n:::\n:::\n\n## E: Equality of variance of the residuals\n\n-   The variance of $Y$ given $X$ ($\\sigma_{Y|X}^2$), is the same for\n    any $X$\n\n    -   We use just $\\sigma^2$ to denote the common variance\n\n-   This is also called **homoscedasticity**\n\n![](05_SLR_Eval/homosced.webp){fig-align=\"center\"}\n\n## Summary of LINE model assumptions\n\n-   $Y$ values are independent (check study design!)\n\n<br>\n\n::: columns\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\nThe distribution of $Y$ given $X$ is\n\n-   normal\n-   with mean $\\mu_{y|x} = \\beta_0 + \\beta_1 \\cdot X$\n-   and common variance $\\sigma^2$\n:::\n\n::: {.column width=\"40%\"}\nThis means that the residuals are\n\n-   normal\n-   with mean = 0\n-   and common variance $\\sigma^2$\n:::\n:::\n\n## How do we determine if our model follows the LINE assumptions?\n\n::: columns\n::: column\n::: definition\n::: def-title\n**\\[L\\] Linearity** of relationship between variables\n:::\n\n::: def-cont\nCheck if there is a linear relationship between the mean response (Y)\nand the explanatory variable (X)\n:::\n:::\n:::\n\n::: column\n::: proof1\n::: proof-title\n**\\[I\\] Independence** of the $Y$ values\n:::\n\n::: proof-cont\nCheck that the observations are independent\n:::\n:::\n:::\n\n::: column\n::: theorem\n::: thm-title\n**\\[N\\] Normality** of the $Y$'s given $X$ (residuals)\n:::\n\n::: thm-cont\nCheck that the responses (at each level X) are normally distributed \n\n-   Usually measured through the residuals\n:::\n:::\n:::\n\n::: column\n::: fact\n::: fact-title\n**\\[E\\] Equality** of variance of the residuals (homoscedasticity)\n:::\n\n::: fact-cont\nCheck that the variance (or standard deviation) of the responses is\nequal for all levels of X \n\n-   Usually measured through the residuals\n:::\n:::\n:::\n:::\n\n## L: Linearity of relationship between variables\n\n::: columns\n::: {.column width=\"15%\"}\n:::\n\n::: {.column width=\"70%\"}\n::: hl\nIs the association between the variables **linear**?\n:::\n:::\n:::\n\n-   **Diagnostic tool:** Scatterplot of $X$ vs. $Y$\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nWarning in geom_point(size = 3, se = FALSE): Ignoring unknown parameters: `se`\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 108 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Poll Everywhere Question 2\n\n## I: Independence of the residuals ($Y$ values)\n\n-   **Are the data points independent of each other?**\n\n \n\n-   **Diagnostic tool:** reviewing the study *design* and not by inspecting\n    the data\n\n## N: Normality of the residuals\n\n-   We need to check if the errors/residuals ($\\epsilon_i$'s) are\n    normally distributed\n\n \n\n-   **Diagnostic tools:**\n\n    -   Distribution plots of residuals\n\n    -   QQ plots of residuals\n\n \n\n-   [Extra resource on how QQ plots are\n    made](https://www.youtube.com/watch?v=okjYjClSjOg&ab_channel=StatQuestwithJoshStarmer)\n\n## N: Extract model's residuals in R\n\n-   First extract the residuals' values from the model output using the\n    `augment()` function from the `broom` package.\n-   Get a tibble with the orginal data, as well as the residuals and\n    some other important values.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- lm(life_expectancy_years_2011 ~ female_literacy_rate_2011, \n                data = gapm)\naug1 <- augment(model1) \n\nglimpse(aug1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 80\nColumns: 9\n$ .rownames                  <chr> \"1\", \"2\", \"5\", \"6\", \"7\", \"8\", \"14\", \"22\", \"…\n$ life_expectancy_years_2011 <dbl> 56.7, 76.7, 60.9, 76.9, 76.0, 73.8, 71.0, 7…\n$ female_literacy_rate_2011  <dbl> 13.0, 95.7, 58.6, 99.4, 97.9, 99.5, 53.4, 9…\n$ .fitted                    <dbl> 53.94643, 73.14897, 64.53453, 74.00809, 73.…\n$ .resid                     <dbl> 2.7535654, 3.5510294, -3.6345319, 2.8919074…\n$ .hat                       <dbl> 0.13628996, 0.01768176, 0.02645854, 0.02077…\n$ .sigma                     <dbl> 6.172684, 6.168414, 6.167643, 6.172935, 6.1…\n$ .cooksd                    <dbl> 1.835891e-02, 3.062372e-03, 4.887448e-03, 2…\n$ .std.resid                 <dbl> 0.48238134, 0.58332052, -0.59972251, 0.4757…\n```\n:::\n:::\n\n\n\n## N: Check normality with \"usual\" distribution plots\n\nNote that below I save each figure as an object, and then combine them\ntogether in one row of output using `grid.arrange()` from the\n`gridExtra` package\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhist1 <- ggplot(aug1, aes(x = .resid)) + geom_histogram()\n\ndensity1 <- ggplot(aug1, aes(x = .resid)) + geom_density()\n\nbox1 <- ggplot(aug1, aes(x = .resid)) + geom_boxplot()\n\ngrid.arrange(hist1, density1, box1, nrow = 1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=1152}\n:::\n:::\n\n\n\n## N: Normal QQ plots (QQ = quantile-quantile)\n\n-   It can be tricky to eyeball with a histogram or density plot whether\n    the residuals are normal or not\n-   QQ plots are often used to help with this\n\n::: columns\n::: {.column width=\"60%\"}\n-   *Vertical axis*: **data quantiles**\n    -   data points are sorted in order and\n    -   assigned quantiles based on how many data points there are\n-   *Horizontal axis*: **theoretical quantiles**\n    -   mean and standard deviation (SD) calculated from the data points\n    -   theoretical quantiles are calculated for each point, assuming\n        the data are modeled by a normal distribution with the mean and\n        SD of the data\n\n \n\n-   **Data are approximately normal if points fall on a line.**\n:::\n\n::: {.column width=\"40%\"}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=720}\n:::\n:::\n\n\n:::\n:::\n\n## N: Examples of Normal QQ plots (from $n=100$ observations)\n\n::: columns\n::: {.column width=\"8%\"}\n:::\n\n::: {.column width=\"22%\"}\nNormal\n:::\n\n::: {.column width=\"24%\"}\nUniform\n:::\n\n::: {.column width=\"24%\"}\nT\n:::\n\n::: {.column width=\"22%\"}\nSkewed\n:::\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=1920}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=1920}\n:::\n:::\n\n\n\n## N: Examples of Normal QQ plots (from $n=10$ observations)\n\n::: columns\n::: {.column width=\"8%\"}\n:::\n\n::: {.column width=\"22%\"}\nNormal\n:::\n\n::: {.column width=\"24%\"}\nUniform\n:::\n\n::: {.column width=\"24%\"}\nT\n:::\n\n::: {.column width=\"22%\"}\nSkewed\n:::\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-15-1.png){fig-align='center' width=1920}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=1920}\n:::\n:::\n\n\n\n## N: Examples of Normal QQ plots (from $n=1000$ observations)\n\n::: columns\n::: {.column width=\"8%\"}\n:::\n\n::: {.column width=\"22%\"}\nNormal\n:::\n\n::: {.column width=\"24%\"}\nUniform\n:::\n\n::: {.column width=\"24%\"}\nT\n:::\n\n::: {.column width=\"22%\"}\nSkewed\n:::\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-18-1.png){fig-align='center' width=1920}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=1920}\n:::\n:::\n\n\n\n## N: We can compare the QQ plots: model vs. theoretical\n\n::: columns\n::: column\n-   Residuals from Life Expectancy vs. Female Literacy Rate Regression\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(aug1, \n      aes(sample = .resid)) + \n  stat_qq() + \n  stat_qq_line() \n```\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-20-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n:::\n\n::: column\n-   Simulated QQ plot of Normal Residuals with $n = 80$\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot() +\n  stat_qq(aes(\n    sample = rnorm(80))) + \n  geom_abline(\n    intercept = 0, slope = 1, \n    color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-21-1.png){fig-align='center' width=576}\n:::\n:::\n\n\n:::\n:::\n\n## N: Shapiro-Wilk Test of Normality\n\n## E: Equality of variance of the residuals {.nostretch}\n\n-   Homoscedasticity\n-   Diagnostic tool: **residual plot**\n\n![](/img_slides/OLSassumptions-1.png){fig-align=\"center\" width=\"60%\"}\n\n::: {style=\"font-size: 60%;\"}\n<https://bookdown.org/roback/bookdown-bysh/ch-MLRreview.html#ordinary-least-squares-ols-assumptions>\n:::\n\n## E: Residual plot\n\n-   $x$ = explanatory variable from regression model\n    -   (or the fitted values for a multiple regression)\n-   $y$ = residuals from regression model\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(aug1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \".rownames\"                  \"life_expectancy_years_2011\"\n[3] \"female_literacy_rate_2011\"  \".fitted\"                   \n[5] \".resid\"                     \".hat\"                      \n[7] \".sigma\"                     \".cooksd\"                   \n[9] \".std.resid\"                \n```\n:::\n:::\n\n\n\n<br>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(aug1, \n       aes(x = female_literacy_rate_2011, \n           y = .resid)) + \n  geom_point() +\n  geom_abline(\n    intercept = 0, \n    slope = 0, \n    color = \"orange\") +\n  labs(title = \"Residual plot\")\n```\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](06_SLR_Diagnostics_files/figure-html/unnamed-chunk-24-1.png){width=576}\n:::\n:::\n\n\n:::\n:::\n\n## E: Equality of variance of the residuals (Homoscedasticity)\n\n-   The **variance** or, equivalently, the standard deviation of the\n    responses is **equal for all values of x**.\n-   This is called **homoskedasticity** (top row)\n-   If there is **heteroskedasticity** (bottom row), then the assumption\n    is not met.\n\n![](/img_slides/heteroskedastic.png){fig-align=\"center\"}\n\n## Summary of the assumptions and their diagnostic tool\n\n+--------------+-------------------------------+-------------------+\n| A ssumption  | What needs to hold?           | Diagnostic tool   |\n+==============+===============================+===================+\n| Linearity    | -   Relationship between $X$  | -   Scatterplot   |\n|              |     and $Y$ is linear         |     of $Y$ vs.    |\n|              |                               |     $X$           |\n+--------------+-------------------------------+-------------------+\n| Ind          | -   Observations are          | -   Study design  |\n| ependence    |     independent from each     |                   |\n|              |     other                     |                   |\n+--------------+-------------------------------+-------------------+\n| Normality    | -   Residuals (and thus       | -   QQ plot of    |\n|              |     $Y|X$) are normally       |     residuals     |\n|              |     distributed               |                   |\n|              |                               | -   Distribution  |\n|              |                               |     of residuals  |\n+--------------+-------------------------------+-------------------+\n| Equality of  | -   Variance of residuals     | -   Residual plot |\n| variance     |     (and thus $Y|X$) is same  |                   |\n|              |     across $X$ values         |                   |\n|              |     (homoscedasticity)        |                   |\n+--------------+-------------------------------+-------------------+\n",
    "supporting": [
      "06_SLR_Diagnostics_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}