{
  "hash": "9c787b5ce3806e4cbd0fed74509a02d7",
  "result": {
    "markdown": "---\ntitle: \"Module_C\"\nauthor: Xu Shi\ndate: Sep 13, 2020\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: xelatex\n---\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at /Users/wakim/Library/CloudStorage/OneDrive-OregonHealth&ScienceUniversity/Teaching/Classes/W2024_BSTA_512_612/W2024_BSTA_512\n```\n:::\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example 2: \n+ A study is carried out in order to evaluate the relationship between birth weight (measured in g/100) and estriol levels (measured as mg/24h based on urine samples). Data were collected on a total of n=31 mothers-to-be and their newborns. A straight line regression model was used for analysis.\n+ Read in the data file (estriol1.sas7bdat), which is stored as a permanent SAS set.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sas7bdat)\ndata = read.sas7bdat(file=\"estriol1.sas7bdat\")\nattach(data)\n```\n:::\n\n\n## Obtain a listing of the variables. Check if there is any missing data.\n+ Let's install and load a useful package called psych (or Hmisc)\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(psych)\n```\n:::\n\n\n## Obtain a listing of the variables. Check if there is any missing data.\n+ The describe() function is handy\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::describe(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        vars  n  mean   sd median trimmed   mad min max\nsubj       1 31 16.00 9.09     16   16.00 11.86   1  31\nestriol    2 31 17.23 4.75     16   17.28  2.97   7  27\nbwt        3 31 32.00 4.74     32   31.84  4.45  24  43\n        range skew kurtosis   se\nsubj       30 0.00    -1.32 1.63\nestriol    20 0.07    -0.30 0.85\nbwt        19 0.21    -0.63 0.85\n```\n:::\n:::\n\n\n\n## Fit an SLR model\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm = lm(bwt~estriol); summary(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = bwt ~ estriol)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8.1200 -2.0381 -0.0381  3.3537  6.8800 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  21.5234     2.6204   8.214 4.68e-09 ***\nestriol       0.6082     0.1468   4.143 0.000271 ***\n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.821 on 29 degrees of freedom\nMultiple R-squared:  0.3718,\tAdjusted R-squared:  0.3501 \nF-statistic: 17.16 on 1 and 29 DF,  p-value: 0.0002712\n```\n:::\n:::\n\n## By hand calculate parameter estiamtes \n\n::: {.cell}\n\n```{.r .cell-code}\nX=estriol; Y=bwt\nXbar = mean(X); Ybar = mean(Y)\nn = length(Y)\n( SSXY = sum((Y-Ybar)*(X-Xbar)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 412\n```\n:::\n\n```{.r .cell-code}\ncov(X,Y)*(n-1)  # compare to SSXY\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 412\n```\n:::\n\n```{.r .cell-code}\n( SSX =  sum((X-Xbar)^2) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 677.4194\n```\n:::\n\n```{.r .cell-code}\nvar(X)*(n-1)  # compare to SSX\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 677.4194\n```\n:::\n:::\n\n\n## By hand calculate parameter estiamtes (cont'd)\n\n::: {.cell}\n\n```{.r .cell-code}\n(beta1hat = SSXY/SSX)              #beta1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6081905\n```\n:::\n\n```{.r .cell-code}\nas.numeric(coef(m)[\"estriol\"])     #beta1 from lm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6081905\n```\n:::\n\n```{.r .cell-code}\n(beta0hat = Ybar-beta1hat*Xbar)    #beta0\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 21.52343\n```\n:::\n\n```{.r .cell-code}\nas.numeric(coef(m)[\"(Intercept)\"]) #beta0 from lm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 21.52343\n```\n:::\n:::\n\n\n## Obtain the F statistic and corresponding p value\n+ Print ANOVA table\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: bwt\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nestriol    1 250.57 250.574  17.162 0.0002712 ***\nResiduals 29 423.43  14.601                      \n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## By hand calculate the F statistic and corresponding p value\n\n::: {.cell}\n\n```{.r .cell-code}\nYhat = m$fitted.values\n( SSE = sum((Y-Yhat)^2) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 423.4255\n```\n:::\n\n```{.r .cell-code}\n( SSR = sum((Yhat-Ybar)^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 250.5745\n```\n:::\n:::\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n## Compare to ANOVA table\nanova(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: bwt\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nestriol    1 250.57 250.574  17.162 0.0002712 ***\nResiduals 29 423.43  14.601                      \n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## By hand calculate the F statistic and corresponding p value (cont'd)\n\n::: {.cell}\n\n```{.r .cell-code}\nMSE = SSE/(n-2) \nMSR = SSR/1\n( Fstat = MSR/MSE )         ## F statistic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.1616\n```\n:::\n\n```{.r .cell-code}\nanova(m)$F[1]               ## F statistic from ANOVA table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.1616\n```\n:::\n\n```{.r .cell-code}\n1-pf(q=Fstat,df1=1,df2=n-2) ## P-value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0002712299\n```\n:::\n\n```{.r .cell-code}\nanova(m)$Pr[1]              ## P-value from ANOVA table\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0002712299\n```\n:::\n:::\n\n\n## Estimate the marginal and conditional variance of birth weight.\n+ Marginal variance of bwt\n+ Variance of birth weight conditional on estriol level\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m)  #var(bwt); sd(bwt)^2; sum((Y-Ybar)^2)/(n-1); MSE\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: bwt\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nestriol    1 250.57 250.574  17.162 0.0002712 ***\nResiduals 29 423.43  14.601                      \n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Does birth weight depend on estriol level? Carry out an appropriate t test\n\n::: {.cell}\n\n```{.r .cell-code}\nsigma_squared = MSE                 \nvar_beta1hat = sigma_squared/SSX \nse_beta1hat = sqrt(var_beta1hat) \nt = beta1hat/se_beta1hat    ## t statistic\n2*(1 - pt(q=t,df=n-2))      ## p-value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0002712299\n```\n:::\n\n```{.r .cell-code}\nsummary(m)$coef[\"estriol\",] ## compare to lm result\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Estimate   Std. Error      t value     Pr(>|t|) \n0.6081904762 0.1468117168 4.1426562497 0.0002712299 \n```\n:::\n:::\n\n\n## Use an F test to determine whether estriol levels are associated with birth weight\n\n::: {.cell}\n\n```{.r .cell-code}\n( Fstat = MSR/MSE )         ## F statistic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.1616\n```\n:::\n\n```{.r .cell-code}\n1-pf(q=Fstat,df1=1,df2=n-2) ## P-value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0002712299\n```\n:::\n:::\n\n\n\n## What percentage of the variation in birth weight is explained by estriol level?\n\n::: {.cell}\n\n```{.r .cell-code}\n(R_squared = SSR / (SSR+SSE))## R-squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3717722\n```\n:::\n\n```{.r .cell-code}\nsummary(m)$r.squared         ## compare to R-squared from lm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3717722\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}