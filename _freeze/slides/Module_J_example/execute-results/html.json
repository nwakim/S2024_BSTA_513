{
  "hash": "fd1fea58e07fb2e87ab8f5ed7cc812dc",
  "result": {
    "markdown": "---\ntitle: \"Module_I\"\nauthor: \"Nicky Wakim\"\ndate: \"10/30/2023\"\nfontsize: 10pt\noutput: \n    beamer_presentation\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ Read in the data file (hdl.csv). (n = 26)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata = read.csv(file=\"hdl.csv\",header=T)\nattach(data)\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  idnum group weight  hdl\n1     1     1  163.5 75.0\n2     2     1  180.0 72.5\n3     3     1  178.5 62.0\n4     4     1  161.5 60.0\n5     5     1  127.0 53.0\n6     6     1  161.0 53.0\n```\n:::\n:::\n\n\n## The MLR model\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nG1 = as.numeric(group==1)\nG2 = as.numeric(group==2)\nG3 = as.numeric(group==3)\nwt = weight - mean(weight)\nm1 = lm(hdl~-1+I(G1)+I(G2)+I(G3)+I(G1*wt)+I(G2*wt)+I(G3*wt))\n# alternatively: lm(hdl~-1+factor(group)*wt-wt)\nsummary(m1)$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error    t value     Pr(>|t|)\nI(G1)      61.7029920  3.4335268 17.9707325 8.238699e-14\nI(G2)      53.1162611  3.4336920 15.4691399 1.361957e-12\nI(G3)      64.1608327  2.9506956 21.7443077 2.175830e-15\nI(G1 * wt)  0.2495631  0.2005974  1.2440992 2.278470e-01\nI(G2 * wt)  0.2509357  0.1050648  2.3883896 2.689778e-02\nI(G3 * wt) -0.0821306  0.1005492 -0.8168202 4.236546e-01\n```\n:::\n:::\n\n\n## GLH test for parallelism\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(Contrast.T = matrix(c(0,0,0,1,-1,0,0,0,0,0,1,-1),byrow=T,nrow=2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]    0    0    0    1   -1    0\n[2,]    0    0    0    0    1   -1\n```\n:::\n\n```{.r .cell-code}\ncar::linearHypothesis(model=m1,hypothesis.matrix=Contrast.T,rhs=c(0,0))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in printHypothesis(L, rhs, names(b)): one or more coefficients in the hypothesis include\n     arithmetic operators in their names;\n  the printed representation of the hypothesis will be omitted\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\n\n\nModel 1: restricted model\nModel 2: hdl ~ -1 + I(G1) + I(G2) + I(G3) + I(G1 * wt) + I(G2 * wt) + \n    I(G3 * wt)\n\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     22 2217.4                              \n2     20 1712.4  2    505.05 2.9495 0.07542 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## GLH test for equality of intercepts\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(Contrast.T = matrix(c(1,-1,0,0,0,0,0,1,-1,0,0,0),byrow=T,nrow=2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]    1   -1    0    0    0    0\n[2,]    0    1   -1    0    0    0\n```\n:::\n\n```{.r .cell-code}\ncar::linearHypothesis(model=m1,hypothesis.matrix=Contrast.T,rhs=c(0,0))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\nI(G1) - I(G2) = 0\nI(G2) - I(G3) = 0\n\nModel 1: restricted model\nModel 2: hdl ~ -1 + I(G1) + I(G2) + I(G3) + I(G1 * wt) + I(G2 * wt) + \n    I(G3 * wt)\n\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     22 2247.3                              \n2     20 1712.4  2    534.97 3.1242 0.06596 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## The MLR model reparameterized\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm2 = lm(hdl~I(G2)+I(G3)+I(wt)+I(G2*wt)+I(G3*wt))\nanova(m2) #Sequential SS (type I)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: hdl\n           Df  Sum Sq Mean Sq F value   Pr(>F)   \nI(G2)       1  914.13  914.13 10.6768 0.003853 **\nI(G3)       1    3.21    3.21  0.0375 0.848394   \nI(wt)       1  172.99  172.99  2.0205 0.170597   \nI(G2 * wt)  1  317.97  317.97  3.7138 0.068292 . \nI(G3 * wt)  1  187.09  187.09  2.1851 0.154925   \nResiduals  20 1712.36   85.62                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n(pval = 1-pf(q = (317.97+187.09)/2/85.62, df1 = 2, df2 = 20))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.07542134\n```\n:::\n:::\n\n\n## Change ordering of covariates\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm3 = lm(hdl~I(wt)+I(G2*wt)+I(G3*wt)+I(G2)+I(G3))\nanova(m3) #Sequential SS (type I)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: hdl\n           Df  Sum Sq Mean Sq F value  Pr(>F)  \nI(wt)       1  401.13  401.13  4.6851 0.04270 *\nI(G2 * wt)  1  446.89  446.89  5.2196 0.03339 *\nI(G3 * wt)  1  212.39  212.39  2.4807 0.13094  \nI(G2)       1  509.73  509.73  5.9536 0.02412 *\nI(G3)       1   25.24   25.24  0.2947 0.59320  \nResiduals  20 1712.36   85.62                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n(pval = 1-pf(q = (509.73+25.24)/2/85.62, df1 = 2, df2 = 20))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.06596391\n```\n:::\n:::\n\n\n## SS test Alternative 1: GLH formulation (slopes)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(Contrast.T = matrix(c(0,0,0,0,1,0,0,0,0,0,0,1),byrow=T,nrow=2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]    0    0    0    0    1    0\n[2,]    0    0    0    0    0    1\n```\n:::\n\n```{.r .cell-code}\ncar::linearHypothesis(model=m2,hypothesis.matrix=Contrast.T,rhs=c(0,0))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in printHypothesis(L, rhs, names(b)): one or more coefficients in the hypothesis include\n     arithmetic operators in their names;\n  the printed representation of the hypothesis will be omitted\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\n\n\nModel 1: restricted model\nModel 2: hdl ~ I(G2) + I(G3) + I(wt) + I(G2 * wt) + I(G3 * wt)\n\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     22 2217.4                              \n2     20 1712.4  2    505.05 2.9495 0.07542 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## SS test Alternative 1: GLH formulation (intercepts)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(Contrast.T = matrix(c(0,1,0,0,0,0,0,0,1,0,0,0),byrow=T,nrow=2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4] [,5] [,6]\n[1,]    0    1    0    0    0    0\n[2,]    0    0    1    0    0    0\n```\n:::\n\n```{.r .cell-code}\ncar::linearHypothesis(model=m2,hypothesis.matrix=Contrast.T,rhs=c(0,0))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear hypothesis test\n\nHypothesis:\nI(G2) = 0\nI(G3) = 0\n\nModel 1: restricted model\nModel 2: hdl ~ I(G2) + I(G3) + I(wt) + I(G2 * wt) + I(G3 * wt)\n\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     22 2247.3                              \n2     20 1712.4  2    534.97 3.1242 0.06596 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## SS test Alternative 2: ANOVA of nested models (slopes)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nanova(\n  lm(hdl~I(G2)+I(G3)+I(wt)+I(G2*wt)+I(G3*wt)),\n  lm(hdl~I(G2)+I(G3)+I(wt))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: hdl ~ I(G2) + I(G3) + I(wt) + I(G2 * wt) + I(G3 * wt)\nModel 2: hdl ~ I(G2) + I(G3) + I(wt)\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     20 1712.4                              \n2     22 2217.4 -2   -505.05 2.9495 0.07542 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## SS test Alternative 2: ANOVA of nested models (intercepts)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nanova(\n  lm(hdl~I(G2)+I(G3)+I(wt)+I(G2*wt)+I(G3*wt)),\n  lm(hdl~I(wt)+I(G2*wt)+I(G3*wt))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: hdl ~ I(G2) + I(G3) + I(wt) + I(G2 * wt) + I(G3 * wt)\nModel 2: hdl ~ I(wt) + I(G2 * wt) + I(G3 * wt)\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     20 1712.4                              \n2     22 2247.3 -2   -534.97 3.1242 0.06596 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}