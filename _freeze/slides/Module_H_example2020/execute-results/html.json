{
  "hash": "86f2206f73c5ae617d34d34d70f75f9f",
  "result": {
    "markdown": "---\ntitle: \"Module_H\"\nauthor: Xu Shi\ndate: Oct 18, 2020\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: xelatex\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ A data set was assembled consisting of life expectancy calculations, as well as other population level demographic data. Each record in the data set pertains to a country, with the primary objective being to determine the role of the following descriptors as predictors of life expectancy: continent, sex, persons per television, and persons per medical doctors.\n+ Read in the data file (life1.csv).\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata = read.csv(file=\"life1.csv\",header=T)\nattach(data)\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  continent per_TV per_MD sex life_exp\n1        Sa    4.0    370   M       74\n2        As  315.0   6166   M       53\n3        Sa    4.0    684   M       68\n4        Na    1.7    449   M       80\n5        As    8.0    643   M       72\n6        Sa    5.6   1551   M       74\n```\n:::\n:::\n\n\n## Produce frequency tables for continent.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nHmisc::describe(continent)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ncontinent \n       n  missing distinct \n      76        0        5 \n                                        \nValue         Af    As    Eu    Na    Sa\nFrequency     12    28    20     6    10\nProportion 0.158 0.368 0.263 0.079 0.132\n```\n:::\n:::\n\n\n## Compute mean life expectancy by continent.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nby(life_exp, factor(continent), mean) #tapply\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfactor(continent): Af\n[1] 59.08333\n---------------------------------------------------- \nfactor(continent): As\n[1] 65.03571\n---------------------------------------------------- \nfactor(continent): Eu\n[1] 74.15\n---------------------------------------------------- \nfactor(continent): Na\n[1] 74.66667\n---------------------------------------------------- \nfactor(continent): Sa\n[1] 69.1\n```\n:::\n:::\n\n\n## Create dummy variables for continent\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndummy_Af = 1*(continent==\"Af\")\ndummy_As = 1*(continent==\"As\")\ndummy_Eu = 1*(continent==\"Eu\")\ndummy_Na = 1*(continent==\"Na\")\ndummy_Sa = 1*(continent==\"Sa\")\n```\n:::\n\n\n\n## Fit a linear model with all continents represented. Interpret the NA in the output.\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\nm0 = lm(life_exp~dummy_Af+dummy_As+dummy_Eu+dummy_Na+dummy_Sa); summary(m0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ dummy_Af + dummy_As + dummy_Eu + dummy_Na + \n    dummy_Sa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   69.100      2.021  34.199  < 2e-16 ***\ndummy_Af     -10.017      2.736  -3.661 0.000479 ***\ndummy_As      -4.064      2.354  -1.727 0.088581 .  \ndummy_Eu       5.050      2.475   2.041 0.045002 *  \ndummy_Na       5.567      3.300   1.687 0.095973 .  \ndummy_Sa          NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.435,\tAdjusted R-squared:  0.4032 \nF-statistic: 13.67 on 4 and 71 DF,  p-value: 2.588e-08\n```\n:::\n:::\n\n\n## Compute the fitted means for each continent and compare them to the means computed previously.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ncoefs = c(coef(m0)) ## beta coefs\ncoefs[\"dummy_Sa\"] = 0 ## set NA to 0\ncoefs[-1] + coefs[\"(Intercept)\"] ## add intercept to each\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndummy_Af dummy_As dummy_Eu dummy_Na dummy_Sa \n59.08333 65.03571 74.15000 74.66667 69.10000 \n```\n:::\n\n```{.r .cell-code}\ntapply(life_exp, factor(continent), mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Af       As       Eu       Na       Sa \n59.08333 65.03571 74.15000 74.66667 69.10000 \n```\n:::\n:::\n\n\n## Fit a model w/o an intercept. Compare the parameter estimates to the group means.\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\nm1 = lm(life_exp~ -1+dummy_Af+dummy_As+dummy_Eu+dummy_Na+dummy_Sa); summary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ -1 + dummy_Af + dummy_As + dummy_Eu + \n    dummy_Na + dummy_Sa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients:\n         Estimate Std. Error t value Pr(>|t|)    \ndummy_Af   59.083      1.845   32.03   <2e-16 ***\ndummy_As   65.036      1.208   53.86   <2e-16 ***\ndummy_Eu   74.150      1.429   51.90   <2e-16 ***\ndummy_Na   74.667      2.609   28.62   <2e-16 ***\ndummy_Sa   69.100      2.021   34.20   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.9918,\tAdjusted R-squared:  0.9912 \nF-statistic:  1722 on 5 and 71 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n# Af       As       Eu       Na       Sa \n# 59.08333 65.03571 74.15000 74.66667 69.10000 \n```\n:::\n\n\n## Compare the SSE values for the two regression models fitted thus far. How can they be equal when SSY is defined differently?\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\ndata.frame(anova(m0))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df    Sum.Sq    Mean.Sq   F.value       Pr..F.\ndummy_Af   1 1080.1055 1080.10554 26.456149 2.291519e-06\ndummy_As   1  957.6451  957.64509 23.456597 7.239569e-06\ndummy_Eu   1   78.0125   78.01250  1.910841 1.712030e-01\ndummy_Na   1  116.2042  116.20417  2.846310 9.597309e-02\nResiduals 71 2898.6643   40.82626        NA           NA\n```\n:::\n\n```{.r .cell-code}\ndata.frame(anova(m1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df     Sum.Sq      Mean.Sq  F.value       Pr..F.\ndummy_Af   1  41890.083  41890.08333 1026.057 6.031556e-44\ndummy_As   1 118430.036 118430.03571 2900.830 2.553921e-59\ndummy_Eu   1 109964.450 109964.45000 2693.474 3.331992e-58\ndummy_Na   1  33450.667  33450.66667  819.342 1.006275e-40\ndummy_Sa   1  47748.100  47748.10000 1169.544 7.649970e-46\nResiduals 71   2898.664     40.82626       NA           NA\n```\n:::\n:::\n\n\n\n## Why does a linear model without an intercept (forced through the origin) have a higher R-squared value?\n\\pause\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\nones = rep(1,nrow(data))\nm1.2 = lm(life_exp~ -1+ones+dummy_Af+dummy_As+dummy_Eu+dummy_Na+dummy_Sa); summary(m1.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ -1 + ones + dummy_Af + dummy_As + dummy_Eu + \n    dummy_Na + dummy_Sa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients: (1 not defined because of singularities)\n         Estimate Std. Error t value Pr(>|t|)    \nones       69.100      2.021  34.199  < 2e-16 ***\ndummy_Af  -10.017      2.736  -3.661 0.000479 ***\ndummy_As   -4.064      2.354  -1.727 0.088581 .  \ndummy_Eu    5.050      2.475   2.041 0.045002 *  \ndummy_Na    5.567      3.300   1.687 0.095973 .  \ndummy_Sa       NA         NA      NA       NA    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.9918,\tAdjusted R-squared:  0.9912 \nF-statistic:  1722 on 5 and 71 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n## Interpret each row of the results in the no-intercept model.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ -1 + dummy_Af + dummy_As + dummy_Eu + \n    dummy_Na + dummy_Sa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients:\n         Estimate Std. Error t value Pr(>|t|)    \ndummy_Af   59.083      1.845   32.03   <2e-16 ***\ndummy_As   65.036      1.208   53.86   <2e-16 ***\ndummy_Eu   74.150      1.429   51.90   <2e-16 ***\ndummy_Na   74.667      2.609   28.62   <2e-16 ***\ndummy_Sa   69.100      2.021   34.20   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.9918,\tAdjusted R-squared:  0.9912 \nF-statistic:  1722 on 5 and 71 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## Fit a model using the factor() function.\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\nm2.1 = lm(life_exp~factor(continent)); summary(m2.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ factor(continent))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           59.083      1.845  32.032  < 2e-16 ***\nfactor(continent)As    5.952      2.205   2.700 0.008662 ** \nfactor(continent)Eu   15.067      2.333   6.458 1.14e-08 ***\nfactor(continent)Na   15.583      3.195   4.878 6.35e-06 ***\nfactor(continent)Sa   10.017      2.736   3.661 0.000479 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.435,\tAdjusted R-squared:  0.4032 \nF-statistic: 13.67 on 4 and 71 DF,  p-value: 2.588e-08\n```\n:::\n:::\n\n\n## Fit a model using dummy variables to get m2.2.\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\nm2.2 = lm(life_exp~dummy_As+dummy_Eu+dummy_Na+dummy_Sa); summary(m2.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ dummy_As + dummy_Eu + dummy_Na + dummy_Sa)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   59.083      1.845  32.032  < 2e-16 ***\ndummy_As       5.952      2.205   2.700 0.008662 ** \ndummy_Eu      15.067      2.333   6.458 1.14e-08 ***\ndummy_Na      15.583      3.195   4.878 6.35e-06 ***\ndummy_Sa      10.017      2.736   3.661 0.000479 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.435,\tAdjusted R-squared:  0.4032 \nF-statistic: 13.67 on 4 and 71 DF,  p-value: 2.588e-08\n```\n:::\n:::\n\n\n## Compare ANOVA tables of m2.1 and m2.2\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\ndata.frame(anova(m2.1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  Df   Sum.Sq   Mean.Sq  F.value       Pr..F.\nfactor(continent)  4 2231.967 557.99182 13.66747 2.587948e-08\nResiduals         71 2898.664  40.82626       NA           NA\n```\n:::\n\n```{.r .cell-code}\ndata.frame(anova(m2.2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df    Sum.Sq   Mean.Sq   F.value       Pr..F.\ndummy_As   1  336.1881 336.18813  8.234606 0.0054103864\ndummy_Eu   1  774.9292 774.92917 18.981146 0.0000436511\ndummy_Na   1  573.5758 573.57576 14.049188 0.0003597509\ndummy_Sa   1  547.2742 547.27424 13.404957 0.0004793670\nResiduals 71 2898.6643  40.82626        NA           NA\n```\n:::\n\n```{.r .cell-code}\nsum(data.frame(anova(m2.2))[1:4,\"Sum.Sq\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2231.967\n```\n:::\n:::\n\n\n## Interpret each row of the results in m2.1.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(m2.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ factor(continent))\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-12.0357  -5.1500   0.4071   4.4625  16.9643 \n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)    \n(Intercept)           59.083      1.845  32.032  < 2e-16 ***\nfactor(continent)As    5.952      2.205   2.700 0.008662 ** \nfactor(continent)Eu   15.067      2.333   6.458 1.14e-08 ***\nfactor(continent)Na   15.583      3.195   4.878 6.35e-06 ***\nfactor(continent)Sa   10.017      2.736   3.661 0.000479 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.39 on 71 degrees of freedom\nMultiple R-squared:  0.435,\tAdjusted R-squared:  0.4032 \nF-statistic: 13.67 on 4 and 71 DF,  p-value: 2.588e-08\n```\n:::\n:::\n\n\n## Fit a model using all covariates.\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\n(m = lm(life_exp~sex+factor(continent)+per_TV+per_MD))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = life_exp ~ sex + factor(continent) + per_TV + per_MD)\n\nCoefficients:\n        (Intercept)                 sexM  factor(continent)As  \n         60.3024463            5.1578947            4.4486324  \nfactor(continent)Eu  factor(continent)Na  factor(continent)Sa  \n         11.4080896           11.9200393            6.4763673  \n             per_TV               per_MD  \n         -0.0221166           -0.0001321  \n```\n:::\n:::\n\n+ Interpret the intercept, and describe any related concerns.\n\n## What percentage of the variation in life expectancy is explained by gender *alone*?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n( SSY = var(life_exp)*(nrow(data)-1) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5130.632\n```\n:::\n\n```{.r .cell-code}\n(SeqSS = data.frame(anova(lm(life_exp~sex))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df    Sum.Sq   Mean.Sq  F.value      Pr..F.\nsex        1  505.4737 505.47368 8.087303 0.005759927\nResiduals 74 4625.1579  62.50213       NA          NA\n```\n:::\n\n```{.r .cell-code}\nsum(SeqSS[,\"Sum.Sq\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5130.632\n```\n:::\n\n```{.r .cell-code}\nSeqSS[\"sex\",\"Sum.Sq\"]/SSY\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.09852075\n```\n:::\n:::\n\n\n## What percentage of the variation in life expectancy is explained by gender *alone*?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n( SSY = var(life_exp)*(nrow(data)-1) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5130.632\n```\n:::\n\n```{.r .cell-code}\n(ParSS = data.frame(car::Anova(lm(life_exp~sex),type=\"III\")))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 Sum.Sq Df     F.value       Pr..F.\n(Intercept) 161591.6842  1 2585.378684 2.609327e-59\nsex            505.4737  1    8.087303 5.759927e-03\nResiduals     4625.1579 74          NA           NA\n```\n:::\n\n```{.r .cell-code}\nsum(ParSS[-1,\"Sum.Sq\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5130.632\n```\n:::\n\n```{.r .cell-code}\nParSS[\"sex\",\"Sum.Sq\"]/SSY\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.09852075\n```\n:::\n:::\n\n\n## Consider the percentage of variation explained by the model with all covariates. What fraction of this percentage is attributable to the per-MD and per-TV covariates?\n\\pause\n\n::: {.cell mysize='true'}\n\\scriptsize\n\n```{.r .cell-code}\n(SeqSS = data.frame(anova(m)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  Df     Sum.Sq   Mean.Sq   F.value       Pr..F.\nsex                1  505.47368 505.47368 20.772905 2.212323e-05\nfactor(continent)  4 2231.96729 557.99182 22.931186 5.045840e-12\nper_TV             1  716.96728 716.96728 29.464428 8.223848e-07\nper_MD             1   21.55774  21.55774  0.885935 3.499131e-01\nResiduals         68 1654.66558  24.33332        NA           NA\n```\n:::\n\n```{.r .cell-code}\n(R2_MDTV = (SeqSS[\"per_TV\",\"Sum.Sq\"]+SeqSS[\"per_MD\",\"Sum.Sq\"])/SSY)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1439443\n```\n:::\n\n```{.r .cell-code}\nR2_MDTV/summary(m)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2124661\n```\n:::\n\n```{.r .cell-code}\n(SeqSS[\"per_TV\",\"Sum.Sq\"]+SeqSS[\"per_MD\",\"Sum.Sq\"])/sum(SeqSS[1:4,\"Sum.Sq\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2124661\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}