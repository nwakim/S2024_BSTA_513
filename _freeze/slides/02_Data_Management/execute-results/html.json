{
  "hash": "5c0252265cf12feef91009edf934affe",
  "result": {
    "markdown": "---\ntitle: \"Data Management with the `tidyverse`\"\nsubtitle: \"Adapted from parts of Mine Çetinkaya-Rundel's tidyverse course\"\nauthor: \"Nicky Wakim\"\ntitle-slide-attributes:\n    data-background-color: \"#213c96\"\ndate: \"01/10/2023\"\ncategories: [\"Week 1\"]\nformat: \n  revealjs:\n    theme: [default, simple_NW.scss]\n    toc: true\n    toc-depth: 1\n    toc-title: Slides Overview\n    chalkboard: true\n    slide-number: true\n    show-slide-number: all\n    width: 1955\n    height: 1100\n    footer: Data Management\n    highlight-style: ayu\n---\n\n\n\n\n## \n\n![Artwork by \\@allison_horst](02_Data_Management/debugging.png){fig-alt=\"A cartoon of a fuzzy round monster face showing 10 different emotions experienced during the process of debugging code. The progression goes from (1) “I got this” - looking determined and optimistic; (2) “Huh. Really thought that was it.” - looking a bit baffled; (3) “...” - looking up at the ceiling in thought; (4) “Fine. Restarting.” - looking a bit annoyed; (5) “OH WTF.” Looking very frazzled and frustrated; (6) “Zombie meltdown.” - looking like a full meltdown; (7) (blank) - sleeping; (8) “A NEW HOPE!” - a happy looking monster with a lightbulb above; (9) “insert awesome theme song” - looking determined and typing away; (10) “I love coding” - arms raised in victory with a big smile, with confetti falling.\"}\n\n# Introduction to the `tidyverse`\n\n## \n\n![](02_Data_Management/spiderverse.jpeg){fig-align=\"center\"}\n\n## What is the tidyverse?\n\nThe **tidyverse** is a collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures.\n\n::: columns\n::: {.column width=\"45%\"}\n-   **ggplot2** - data visualisation\n-   **dplyr** - data manipulation\n-   **tidyr** - tidy data\n-   **readr** - read rectangular data\n-   **purrr** - functional programming\n-   **tibble** - modern data frames\n-   **stringr** - string manipulation\n-   **forcats** - factors\n-   and many more ...\n:::\n\n::: {.column width=\"55%\"}\n![](02_Data_Management/tidyverse.png){fig-align=\"center\" width=\"669\"}\n:::\n:::\n\n## Tidy data[^1]\n\n[^1]: Source: R for Data Science. Grolemund and Wickham.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_Data_Management/img/tidy-data-frame.png){fig-alt='tidy data diagram'}\n:::\n:::\n\n\n1.  Each variable must have its own column.\n\n2.  Each observation must have its own row.\n\n3.  Each value must have its own cell.\n\n## Pipe operator (`magrittr`)\n\n-   The pipe operator (`%>%`) allows us to step through sequential functions in the same way we follow if-then statements or steps from instructions\n\n \n\n::: heq\nI want to find my keys, then start my car, then drive to work, then park my car.\n:::\n\n \n\n::: columns\n::: {.column width=\"50%\"}\n**Nested**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npark(drive(start_car(find(\"keys\")), \n           to = \"work\"))\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n**Piped**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfind(\"keys\") %>%\n  start_car() %>%\n  drive(to = \"work\") %>%\n  park()\n```\n:::\n\n:::\n:::\n\n## Recoding a binary variable with pipe operator\n\n \n\n::: heq\nLet's say I want a variable `transmission` to show the category names that are assigned to numeric values in the code. I want `0` to be coded as `automatic` and `1` to be coded as `manual`.\n:::\n\n \n\n::: columns\n::: {.column width=\"50%\"}\nBase R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars$transmission <-\n  ifelse(\n    mtcars$am == 0,\n    \"automatic\",\n    \"manual\"\n  )\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\nTidyverse:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars <- mtcars %>%\n  mutate(\n    transmission = case_when(\n      am == 0 ~ \"automatic\",\n      am == 1 ~ \"manual\"\n    )\n  )\n```\n:::\n\n\n \n\n::: hl\n`mutate()` creates new columns that are functions of existing variables\n:::\n:::\n:::\n\n## Recoding a multi-level variable\n\n \n\n::: heq\nLet's say I want a variable `gear` to show the category names that are assigned to numeric values in the code. I want `3` to be coded as gear `three`, `4` to be coded as gear `four`, `5` to be coded as gear `five`.\n:::\n\n \n\n::: columns\n::: {.column width=\"50%\"}\nBase R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars$gear_char <-\n  ifelse(\n    mtcars$gear == 3,\n    \"three\",\n    ifelse(\n      mtcars$gear == 4,\n      \"four\",\n      \"five\"\n    )\n  )\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\nTidyverse:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars <- mtcars %>%\n  mutate(\n    gear_char = case_when(\n      gear == 3 ~ \"three\",\n      gear == 4 ~ \"four\",\n      gear == 5 ~ \"five\"\n    )\n  )\n```\n:::\n\n:::\n:::\n\n# `ggplot2` revisited\n\n## `ggplot2` in tidyverse\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_Data_Management/img/ggplot2-part-of-tidyverse.png){width=80%}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n-   We talked about this in our review notes\n\n    -   I want to revisit it: always helps to have more examples!\n    -   This example is closer to the multivariable work we'll do in this class!\n\n \n\n-   **ggplot2** is tidyverse's data visualization package\n\n \n\n-   The `gg` in \"ggplot2\" stands for Grammar of Graphics\n\n \n\n-   It is inspired by the book **Grammar of Graphics** by Leland Wilkinson\n:::\n:::\n\n## Tidyverse: Visualizing multiple variables\n\n \n\n\n::: {.cell fig.asp='0.3'}\n\n```{.r .cell-code}\nggplot(\n  mtcars,\n  aes(x = disp, y = mpg, color = transmission)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](02_Data_Management_files/figure-revealjs/unnamed-chunk-9-1.png){width=100%}\n:::\n:::\n\n\n## Poll Everywhere Question 1\n\n## Tidyverse: Visualizing even more variables\n\n\n::: {.cell fig.asp='0.3'}\n\n```{.r .cell-code}\nggplot(\n  mtcars,\n  aes(x = disp, y = mpg, color = transmission)) +\n  geom_point() +\n  facet_wrap(~ cyl)\n```\n\n::: {.cell-output-display}\n![](02_Data_Management_files/figure-revealjs/unnamed-chunk-10-1.png){width=100%}\n:::\n:::\n\n\n## Base R: Visualizing even more variables\n\n\n::: {.cell fig.asp='0.3'}\n\n```{.r .cell-code}\nmtcars$trans_color <- ifelse(mtcars$transmission == \"automatic\", \"green\", \"blue\")\nmtcars_cyl4 = mtcars[mtcars$cyl == 4, ]\nmtcars_cyl6 = mtcars[mtcars$cyl == 6, ]\nmtcars_cyl8 = mtcars[mtcars$cyl == 8, ]\npar(mfrow = c(1, 3), mar = c(2.5, 2.5, 2, 0), mgp = c(1.5, 0.5, 0))\nplot(mpg ~ disp, data = mtcars_cyl4, col = trans_color, main = \"Cyl 4\")\nplot(mpg ~ disp, data = mtcars_cyl6, col = trans_color, main = \"Cyl 6\")\nplot(mpg ~ disp, data = mtcars_cyl8, col = trans_color, main = \"Cyl 8\")\nlegend(\"topright\", legend = c(\"automatic\", \"manual\"), pch = 1, col = c(\"green\", \"blue\"))\n```\n\n::: {.cell-output-display}\n![](02_Data_Management_files/figure-revealjs/unnamed-chunk-11-1.png){width=100%}\n:::\n:::\n\n\n# Functions for data management\n\n## Important functions for data management\n\n \n\n**Data manipulation**\n\n-   `pivot_longer()` and `pivot_wider()`\n\n-   `rename()`\n\n-   `mutate()`\n\n-   `filter()`\n\n-   `select()`\n\n**Summarizing data**\n\n-   `tbl_summary()`\n-   `group_by()`\n-   `summarize()`\n-   `across()`\n\n# Data manipulation\n\n## Example for `pivot_longer()`: Instructional staff employment trends\n\nThe American Association of University Professors (AAUP) is a nonprofit membership association of faculty and other academic professionals. [This report](https://www.aaup.org/sites/default/files/files/AAUP_Report_InstrStaff-75-11_apr2013.pdf) by the AAUP shows trends in instructional staff employees between 1975 and 2011, and contains an image very similar to the one given below.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_Data_Management/img/staff-employment.png){fig-align='center' fig-alt='staff employment figure' width=50%}\n:::\n:::\n\n\n## Data\n\nEach row in this dataset represents a faculty type, and the columns are the years for which we have data. The values are percentage of hires of that type of faculty for each year.\n\n   \n\n\n::: {.cell}\n\n```{.r .cell-code}\n(staff <- read_csv(\"data/instructional-staff.csv\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 12\n  faculty_type    `1975` `1989` `1993` `1995` `1999` `2001` `2003` `2005` `2007`\n  <chr>            <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>  <dbl>\n1 Full-Time Tenu…   29     27.6   25     24.8   21.8   20.3   19.3   17.8   17.2\n2 Full-Time Tenu…   16.1   11.4   10.2    9.6    8.9    9.2    8.8    8.2    8  \n3 Full-Time Non-…   10.3   14.1   13.6   13.6   15.2   15.5   15     14.8   14.9\n4 Part-Time Facu…   24     30.4   33.1   33.2   35.5   36     37     39.3   40.5\n5 Graduate Stude…   20.5   16.5   18.1   18.8   18.7   19     20     19.9   19.5\n# ℹ 2 more variables: `2009` <dbl>, `2011` <dbl>\n```\n:::\n:::\n\n\n## Poll Everywhere Question 2\n\n## Recreate the visualization\n\n \n\n-   In order to recreate this visualization we need to first reshape the data:\n    -   one variable for faculty type\n    -   one variable for year\n\n \n\n-   Convert the data from the wide format to long format\n    -   `pivot_longer()`\n\n## \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](02_Data_Management/img/pivot.gif){fig-align='center' fig-alt='pivot friends meme' width=80%}\n:::\n:::\n\n\n## `pivot_*()` functions\n\n![](02_Data_Management/img/tidyr-longer-wider.gif){fig-align=\"center\"}\n\n## Poll Everywhere Question 3\n\n## Pivot staff data and mutate percentage\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(staff_long <- staff %>%\n  pivot_longer(\n    cols = -faculty_type,    # columns to pivot\n    names_to = \"year\",       # name of new column for variable names\n    values_to = \"percentage\" # name of new column for values\n  ) %>%\n  mutate(percentage = as.numeric(percentage))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 55 × 3\n   faculty_type              year  percentage\n   <chr>                     <chr>      <dbl>\n 1 Full-Time Tenured Faculty 1975        29  \n 2 Full-Time Tenured Faculty 1989        27.6\n 3 Full-Time Tenured Faculty 1993        25  \n 4 Full-Time Tenured Faculty 1995        24.8\n 5 Full-Time Tenured Faculty 1999        21.8\n 6 Full-Time Tenured Faculty 2001        20.3\n 7 Full-Time Tenured Faculty 2003        19.3\n 8 Full-Time Tenured Faculty 2005        17.8\n 9 Full-Time Tenured Faculty 2007        17.2\n10 Full-Time Tenured Faculty 2009        16.8\n# ℹ 45 more rows\n```\n:::\n:::\n\n\n## A \"meh\" plot over the years\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(staff_long, aes(x = percentage, y = year, fill = faculty_type)) +\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](02_Data_Management_files/figure-revealjs/unnamed-chunk-15-1.png){width=1500}\n:::\n:::\n\n\n## More improvement {.smaller}\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nstaff_long %>%\n  mutate( \n    part_time = if_else(faculty_type == \"Part-Time Faculty\",\n                        \"Part-Time Faculty\", \"Other Faculty\"),\n    year = as.numeric(year)) %>% \n  ggplot(\n    aes(x = year, y = percentage/100, group = faculty_type, color = part_time)) +\n  geom_line() +\n  scale_color_manual(values = c(\"gray\", \"red\")) + \n  scale_y_continuous(labels = label_percent(accuracy = 1)) + \n  theme_minimal() +\n  labs(\n    title = \"Instructional staff employment trends\",\n    x = \"Year\", y = \"Percentage\", color = NULL) +\n  theme(legend.position = \"bottom\")\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n![](02_Data_Management_files/figure-revealjs/staff-lines-22-1.png){width=1500}\n:::\n:::\n\n:::\n:::\n\n## All that just to show one helpful function\n\nNow we can move onto the other functions mentioned:\n\n \n\n**Data manipulation**\n\n-   `pivot_longer()` and `pivot_wider()`\n\n-   `rename()`\n\n-   `mutate()`\n\n-   `filter()`\n\n-   `select()`\n\n**Summarizing data**\n\n-   `tbl_summary()`\n-   `group_by()`\n-   `summarize()`\n-   `across()`\n\n## Let's look back at the `dds.discr` dataset that I briefly used last class\n\n   \n\n-   We will load the data (This is a special case! `dds.discr` is a built-in R dataset)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"dds.discr\")\n```\n:::\n\n\n-   Now, let's take a glimpse at the dataset:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(dds.discr)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 6\n$ id           <int> 10210, 10409, 10486, 10538, 10568, 10690, 10711, 10778, 1…\n$ age.cohort   <fct> 13-17, 22-50, 0-5, 18-21, 13-17, 13-17, 13-17, 13-17, 13-…\n$ age          <int> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ gender       <fct> Female, Male, Male, Female, Male, Female, Female, Male, F…\n$ expenditures <int> 2113, 41924, 1454, 6400, 4412, 4566, 3915, 3873, 5021, 28…\n$ ethnicity    <fct> White not Hispanic, White not Hispanic, Hispanic, Hispani…\n```\n:::\n:::\n\n\n## `rename()`: one of the first things I usually do\n\n-   I notice that two variables have values that don't necessarily match the variable name\n\n    -   Female and male are not genders\n\n    -   \"White not Hispanic\" combines race and ethnicity into one category\n\n::: heq\nI want to rename gender to SAB (sex assigned at birth) and rename ethnicity to R_E (race and ethnicity)\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr1 = dds.discr %>% \n  rename(SAB = gender, \n         R_E = ethnicity)\n\nglimpse(dds.discr1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 6\n$ id           <int> 10210, 10409, 10486, 10538, 10568, 10690, 10711, 10778, 1…\n$ age.cohort   <fct> 13-17, 22-50, 0-5, 18-21, 13-17, 13-17, 13-17, 13-17, 13-…\n$ age          <int> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ SAB          <fct> Female, Male, Male, Female, Male, Female, Female, Male, F…\n$ expenditures <int> 2113, 41924, 1454, 6400, 4412, 4566, 3915, 3873, 5021, 28…\n$ R_E          <fct> White not Hispanic, White not Hispanic, Hispanic, Hispani…\n```\n:::\n:::\n\n\n## `mutate()`: constructing new variables from what you have\n\n-   We've seen a couple examples for `mutate()` so far (mostly because its used so often!)\n\n-   We haven't seen an example where we make a new variable from two variables\n\n::: heq\nI want to make a variable that is the ratio of expenditures over age\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr2 = dds.discr1 %>%\n  mutate(exp_to_age = expenditures/age)\n\nglimpse(dds.discr2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 7\n$ id           <int> 10210, 10409, 10486, 10538, 10568, 10690, 10711, 10778, 1…\n$ age.cohort   <fct> 13-17, 22-50, 0-5, 18-21, 13-17, 13-17, 13-17, 13-17, 13-…\n$ age          <int> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ SAB          <fct> Female, Male, Male, Female, Male, Female, Female, Male, F…\n$ expenditures <int> 2113, 41924, 1454, 6400, 4412, 4566, 3915, 3873, 5021, 28…\n$ R_E          <fct> White not Hispanic, White not Hispanic, Hispanic, Hispani…\n$ exp_to_age   <dbl> 124.2941, 1133.0811, 484.6667, 336.8421, 339.3846, 304.40…\n```\n:::\n:::\n\n\n## Poll Everywhere Question 4\n\n## `filter()`: keep rows that match a condition\n\n-   What if I want to subset the data frame? (keep certain rows of observations)\n\n::: heq\nI want to look at the data for people who between 50 and 60 years old\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr3 = dds.discr2 %>%\n  filter(age >= 50 & age <= 60)\n\nglimpse(dds.discr3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 23\nColumns: 7\n$ id           <int> 15970, 19412, 29506, 31658, 36123, 39287, 39672, 43455, 4…\n$ age.cohort   <fct> 51+, 51+, 51+, 51+, 51+, 51+, 51+, 51+, 51+, 51+, 51+, 51…\n$ age          <int> 51, 60, 56, 60, 59, 59, 54, 57, 52, 57, 55, 52, 59, 54, 5…\n$ SAB          <fct> Female, Female, Female, Female, Male, Female, Female, Mal…\n$ expenditures <int> 54267, 57702, 48215, 46873, 42739, 44734, 52833, 48363, 5…\n$ R_E          <fct> White not Hispanic, White not Hispanic, White not Hispani…\n$ exp_to_age   <dbl> 1064.0588, 961.7000, 860.9821, 781.2167, 724.3898, 758.20…\n```\n:::\n:::\n\n\n## `select()`: keep or drop columns using their names and types\n\n-   What if I want to remove or keep certain variables?\n\n::: heq\nI want to only have age and expenditure in my data frame\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr4 = dds.discr2 %>%\n  select(age, expenditures)\n\nglimpse(dds.discr4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 2\n$ age          <int> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ expenditures <int> 2113, 41924, 1454, 6400, 4412, 4566, 3915, 3873, 5021, 28…\n```\n:::\n:::\n\n\n# Summarizing Data\n\n## `tbl_summary()` : table summary (1/2)\n\n-   What if I want one of those fancy summary tables that are at the top of most research articles? (lovingly called \"Table 1\")\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gtsummary)\ntbl_summary(dds.discr2)\n```\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"pzveloiefp\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#pzveloiefp table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#pzveloiefp thead, #pzveloiefp tbody, #pzveloiefp tfoot, #pzveloiefp tr, #pzveloiefp td, #pzveloiefp th {\n  border-style: none;\n}\n\n#pzveloiefp p {\n  margin: 0;\n  padding: 0;\n}\n\n#pzveloiefp .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#pzveloiefp .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#pzveloiefp .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#pzveloiefp .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#pzveloiefp .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#pzveloiefp .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#pzveloiefp .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#pzveloiefp .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#pzveloiefp .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#pzveloiefp .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#pzveloiefp .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#pzveloiefp .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#pzveloiefp .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#pzveloiefp .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#pzveloiefp .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pzveloiefp .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#pzveloiefp .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#pzveloiefp .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#pzveloiefp .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pzveloiefp .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#pzveloiefp .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pzveloiefp .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#pzveloiefp .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pzveloiefp .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#pzveloiefp .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#pzveloiefp .gt_left {\n  text-align: left;\n}\n\n#pzveloiefp .gt_center {\n  text-align: center;\n}\n\n#pzveloiefp .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#pzveloiefp .gt_font_normal {\n  font-weight: normal;\n}\n\n#pzveloiefp .gt_font_bold {\n  font-weight: bold;\n}\n\n#pzveloiefp .gt_font_italic {\n  font-style: italic;\n}\n\n#pzveloiefp .gt_super {\n  font-size: 65%;\n}\n\n#pzveloiefp .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#pzveloiefp .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#pzveloiefp .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#pzveloiefp .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#pzveloiefp .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#pzveloiefp .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#pzveloiefp .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;N = 1,000&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>N = 1,000</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">id</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">55,385 (31,809, 76,135)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age.cohort</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    0-5</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">82 (8.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    6-12</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">175 (18%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    13-17</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">212 (21%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    18-21</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">199 (20%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    22-50</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">226 (23%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    51+</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">106 (11%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">18 (12, 26)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">SAB</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Female</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">503 (50%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Male</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">497 (50%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">expenditures</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">7,026 (2,899, 37,713)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">R_E</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    American Indian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">4 (0.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Asian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">129 (13%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Black</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">59 (5.9%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Hispanic</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">376 (38%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Multi Race</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">26 (2.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Native Hawaiian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3 (0.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    White not Hispanic</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">401 (40%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">exp_to_age</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">462 (274, 938)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Median (IQR); n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n:::\n:::\n\n## `tbl_summary()` : table summary (2/2)\n\n-   Let's make this more presentable\n\n \n\n::: columns\n::: {.column width=\"70%\"}\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr2 %>%\n  select(-id, -age.cohort, -exp_to_age) %>%\n  tbl_summary(label = c(age ~ \"Age\", \n                        R_E ~ \"Race/Ethnicity\", \n                        SAB ~ \"Sex Assigned at Birth\", \n                        expenditures ~ \"Expenditures\"))\n```\n:::\n\n:::\n\n::: {.column width=\"30%\"}\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div id=\"dbgvzfontn\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dbgvzfontn table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dbgvzfontn thead, #dbgvzfontn tbody, #dbgvzfontn tfoot, #dbgvzfontn tr, #dbgvzfontn td, #dbgvzfontn th {\n  border-style: none;\n}\n\n#dbgvzfontn p {\n  margin: 0;\n  padding: 0;\n}\n\n#dbgvzfontn .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dbgvzfontn .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dbgvzfontn .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dbgvzfontn .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dbgvzfontn .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dbgvzfontn .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dbgvzfontn .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dbgvzfontn .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dbgvzfontn .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dbgvzfontn .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dbgvzfontn .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dbgvzfontn .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dbgvzfontn .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dbgvzfontn .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dbgvzfontn .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dbgvzfontn .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dbgvzfontn .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dbgvzfontn .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dbgvzfontn .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dbgvzfontn .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dbgvzfontn .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dbgvzfontn .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dbgvzfontn .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dbgvzfontn .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dbgvzfontn .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dbgvzfontn .gt_left {\n  text-align: left;\n}\n\n#dbgvzfontn .gt_center {\n  text-align: center;\n}\n\n#dbgvzfontn .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dbgvzfontn .gt_font_normal {\n  font-weight: normal;\n}\n\n#dbgvzfontn .gt_font_bold {\n  font-weight: bold;\n}\n\n#dbgvzfontn .gt_font_italic {\n  font-style: italic;\n}\n\n#dbgvzfontn .gt_super {\n  font-size: 65%;\n}\n\n#dbgvzfontn .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dbgvzfontn .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dbgvzfontn .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dbgvzfontn .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dbgvzfontn .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dbgvzfontn .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dbgvzfontn .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;N = 1,000&lt;/strong&gt;&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>N = 1,000</strong><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Age</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">18 (12, 26)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Sex Assigned at Birth</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Female</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">503 (50%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Male</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">497 (50%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Expenditures</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">7,026 (2,899, 37,713)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Race/Ethnicity</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    American Indian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">4 (0.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Asian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">129 (13%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Black</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">59 (5.9%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Hispanic</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">376 (38%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Multi Race</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">26 (2.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Native Hawaiian</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3 (0.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    White not Hispanic</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">401 (40%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Median (IQR); n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n:::\n:::\n\n## `group_by()`: group by one or more variables\n\n-   What if I want to quickly look at group differences?\n-   It will not change how the data look, but changes the actions of following functions\n\n::: heq\nI want to group my data by sex assigned at birth.\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr5 = dds.discr2 %>%\n  group_by(SAB)\nglimpse(dds.discr5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 7\nGroups: SAB [2]\n$ id           <int> 10210, 10409, 10486, 10538, 10568, 10690, 10711, 10778, 1…\n$ age.cohort   <fct> 13-17, 22-50, 0-5, 18-21, 13-17, 13-17, 13-17, 13-17, 13-…\n$ age          <int> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ SAB          <fct> Female, Male, Male, Female, Male, Female, Female, Male, F…\n$ expenditures <int> 2113, 41924, 1454, 6400, 4412, 4566, 3915, 3873, 5021, 28…\n$ R_E          <fct> White not Hispanic, White not Hispanic, Hispanic, Hispani…\n$ exp_to_age   <dbl> 124.2941, 1133.0811, 484.6667, 336.8421, 339.3846, 304.40…\n```\n:::\n:::\n\n\n-   Let's see how the groups change something like the `summarize()` function in the next slide\n\n## `summarize()`: summarize your data or grouped data into one row\n\n-   What if I want to calculate specific descriptive statistics for my variables?\n-   This function is often best used with `group_by()`\n-   If only presenting the summaries, functions like `tbl_summary()` is better\n-   `summarize()` creates a new data frame, which means you can plot and manipulate the summarized data\n\n \n\n::: columns\n::: column\nOver whole sample:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr2 %>% \n  summarize(\n    ave = mean(expenditures),\n    SD = sd(expenditures),\n    med = median(expenditures))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 3\n     ave     SD   med\n   <dbl>  <dbl> <dbl>\n1 18066. 19543.  7026\n```\n:::\n:::\n\n:::\n\n::: column\nGrouped by sex assigned at birth:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr2 %>% \n  group_by(SAB) %>% \n  summarize(\n    ave = mean(expenditures),\n    SD = sd(expenditures),\n    med = median(expenditures))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 4\n  SAB       ave     SD   med\n  <fct>   <dbl>  <dbl> <int>\n1 Female 18130. 20020.  6400\n2 Male   18001. 19068.  7219\n```\n:::\n:::\n\n:::\n:::\n\n## `across()`: apply a function across multiple columns\n\n-   Like `group_by()`, this function is often paired with another transformation function\n\n::: heq\nI want all my integer values to have two significant figures.\n:::\n\n \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndds.discr6 = dds.discr2 %>%\n  mutate(across(where(is.integer), signif, digits = 2))\n\nglimpse(dds.discr6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,000\nColumns: 7\n$ id           <dbl> 10000, 10000, 10000, 11000, 11000, 11000, 11000, 11000, 1…\n$ age.cohort   <fct> 13-17, 22-50, 0-5, 18-21, 13-17, 13-17, 13-17, 13-17, 13-…\n$ age          <dbl> 17, 37, 3, 19, 13, 15, 13, 17, 14, 13, 13, 14, 15, 17, 20…\n$ SAB          <fct> Female, Male, Male, Female, Male, Female, Female, Male, F…\n$ expenditures <dbl> 2100, 42000, 1500, 6400, 4400, 4600, 3900, 3900, 5000, 29…\n$ R_E          <fct> White not Hispanic, White not Hispanic, Hispanic, Hispani…\n$ exp_to_age   <dbl> 124.2941, 1133.0811, 484.6667, 336.8421, 339.3846, 304.40…\n```\n:::\n:::\n\n\n# Resources\n\n## `dplyr` resources\n\n-   [More `dpylr` functions to reference!](https://dplyr.tidyverse.org/reference/index.html)\n\nAdditional details and examples are available in the vignettes:\n\n-   [column-wise operations vignette](https://dplyr.tidyverse.org/articles/colwise.html)\n\n-   [row-wise operations vignette](https://dplyr.tidyverse.org/articles/rowwise.html)\n\n \n\nand the dplyr 1.0.0 release blog posts:\n\n-   [working across columns](https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-colwise/)\n-   [working within rows](https://www.tidyverse.org/blog/2020/04/dplyr-1-0-0-rowwise/)\n\n## R programming class at OHSU!\n\nYou can check out [Dr. Jessica Minnier's R class page](https://sph-r-programming-2022.netlify.app/) if you want more notes, videos, etc.\n\n## The larger tidy ecosystem\n\nJust to name a few...\n\n-   [janitor](https://garthtarr.github.io/meatR/janitor.html)\n\n-   [kableExtra](https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html)\n\n-   [patchwork](https://patchwork.data-imaginist.com/)\n\n-   [gghighlight](https://cran.r-project.org/web/packages/gghighlight/vignettes/gghighlight.html)\n\n-   [tidybayes](https://mjskay.github.io/tidybayes/)\n\n## Credit to Mine Çetinkaya-Rundel\n\n-   These notes were built from Mine's notes\n\n    -   Most pages and code were left as she made them\n\n    -   I changed a few things to match our class\n\n-   Please see [her Github repository](https://github.com/mine-cetinkaya-rundel/teach-ds-wsc-2021/tree/main) for the original notes\n",
    "supporting": [
      "02_Data_Management_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/font-awesome/css/all.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/font-awesome/css/v4-shims.min.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}