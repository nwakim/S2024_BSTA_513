{
  "hash": "01b7410726c7bdd901542bf0e6fe57be",
  "result": {
    "markdown": "---\ntitle: \"Module_E\"\nauthor: Xu Shi\ndate: Sep 24, 2021\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: xelatex\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ A study was carried out to examine the relationship between body weight (measured in pounds) and covariates age (years) and height (inches) among (n=12) children age 6-12.\n+ Read in the data file (exampleE.csv).\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata = read.csv(file=\"exampleE.csv\",header=T)\nattach(data)\n```\n:::\n\n\n## Using SLR, estimate the effect of age on weight\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm_age = lm(weight~age); summary(m_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = weight ~ age)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-11.000  -3.911   1.143   4.071  10.000 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept)  30.5714     8.6137   3.549  0.00528 **\nage           3.6429     0.9551   3.814  0.00341 **\n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.015 on 10 degrees of freedom\nMultiple R-squared:  0.5926,\tAdjusted R-squared:  0.5519 \nF-statistic: 14.55 on 1 and 10 DF,  p-value: 0.003407\n```\n:::\n:::\n\n## Using SLR, estimate the effect of age on weight\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nconfint(m_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                2.5 %    97.5 %\n(Intercept) 11.378897 49.763960\nage          1.514728  5.770986\n```\n:::\n:::\n\n\n## Using SLR, estimate the effect of height on weight\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm_ht = lm(weight~height); summary(m_ht)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = weight ~ height)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-5.8736 -3.8973 -0.4402  2.2624 11.8375 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept)   6.1898    12.8487   0.482  0.64035   \nheight        1.0722     0.2417   4.436  0.00126 **\n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5.471 on 10 degrees of freedom\nMultiple R-squared:  0.663,\tAdjusted R-squared:  0.6293 \nF-statistic: 19.67 on 1 and 10 DF,  p-value: 0.001263\n```\n:::\n:::\n\n## Using SLR, estimate the effect of height on weight\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nconfint(m_ht)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  2.5 %    97.5 %\n(Intercept) -22.4389419 34.818639\nheight        0.5336202  1.610841\n```\n:::\n:::\n\n\n## Fit a multiple regression model with both height and age\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm_age_ht = lm(weight~age+height); summary(m_age_ht)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = weight ~ age + height)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.8708 -1.7004  0.3454  1.4642 10.2336 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)  \n(Intercept)   6.5530    10.9448   0.599   0.5641  \nage           2.0501     0.9372   2.187   0.0565 .\nheight        0.7220     0.2608   2.768   0.0218 *\n---\nSignif. codes:  \n0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.66 on 9 degrees of freedom\nMultiple R-squared:   0.78,\tAdjusted R-squared:  0.7311 \nF-statistic: 15.95 on 2 and 9 DF,  p-value: 0.001099\n```\n:::\n:::\n\n## Fit a multiple regression model with both height and age\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nconfint(m_age_ht)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                   2.5 %    97.5 %\n(Intercept) -18.20587071 31.311967\nage          -0.07002526  4.170278\nheight        0.13205592  1.312020\n```\n:::\n:::\n\n\n##  Compare the parameter estimates from SLR and MLR\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(m_age)$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error  t value    Pr(>|t|)\n(Intercept) 30.571429  8.6137053 3.549161 0.005275610\nage          3.642857  0.9551151 3.814050 0.003406552\n```\n:::\n\n```{.r .cell-code}\nsummary(m_ht)$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Estimate Std. Error   t value    Pr(>|t|)\n(Intercept) 6.189849  12.848746 0.4817473 0.640354534\nheight      1.072230   0.241731 4.4356349 0.001263019\n```\n:::\n\n```{.r .cell-code}\nsummary(m_age_ht)$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Estimate Std. Error   t value   Pr(>|t|)\n(Intercept) 6.553048 10.9448271 0.5987347 0.56411347\nage         2.050126  0.9372256 2.1874417 0.05648531\nheight      0.722038  0.2608051 2.7684967 0.02180704\n```\n:::\n:::\n\n\n##  Compare the parameter estimates from SLR and MLR\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(m_age)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5518797\n```\n:::\n\n```{.r .cell-code}\nsummary(m_ht)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6293158\n```\n:::\n\n```{.r .cell-code}\nsummary(m_age_ht)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.7310941\n```\n:::\n:::\n\n\n\n##  By-hand compute point estimates and make inference\n\n::: {.cell}\n\n```{.r .cell-code}\n#### define design matrix, outcome, dimensions ####\nX = model.matrix(weight~age+height)\nY = weight\nn = nrow(X)\np = ncol(X)\n#### Estimation: betahat and var(betahat) ####\nbetahat = solve(t(X)%*%X)%*%t(X)%*%Y \nYhat = X%*%betahat                                    \nepsilonhat = Y - Yhat ## residual\n## estimated sigma^2\nsigma_squared = t(epsilonhat)%*%epsilonhat/(n-p)      \n## variance of betahat\nvar_betahat = diag( solve(t(X)%*%X) )*c(sigma_squared)\nse_betahat = sqrt(var_betahat)  ## se of betahat      \n#### Inference: t statistic and p val for H0: beta=0 ####\nt_statistic = c(betahat/se_betahat) \np_value = c(2*( 1-pt(q=abs(t_statistic),df=n-p) )) \n```\n:::\n\n\n##  Compare results from by-hand calculation and lm()\n+ By hand results\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(by_hand = cbind(Estimate=c(betahat),\n                 Std_Err=se_betahat, \n                 t_statistic=t_statistic,\n                 p_value=p_value))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Estimate    Std_Err t_statistic    p_value\n(Intercept) 6.553048 10.9448271   0.5987347 0.56411347\nage         2.050126  0.9372256   2.1874417 0.05648531\nheight      0.722038  0.2608051   2.7684967 0.02180704\n```\n:::\n:::\n\n+ Results from lm()\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(from_lm = summary(m_age_ht)$coef)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Estimate Std. Error   t value   Pr(>|t|)\n(Intercept) 6.553048 10.9448271 0.5987347 0.56411347\nage         2.050126  0.9372256 2.1874417 0.05648531\nheight      0.722038  0.2608051 2.7684967 0.02180704\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}