{
  "hash": "a2ddc75d8873743d646f8a366c764eb8",
  "result": {
    "markdown": "---\ntitle: \"Module M\"\nauthor: Nicky\ndate: Nov 28, 2021\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: pdflatex\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ A data set is assembled from (n=17) hospitals in order to construct a model to predict manpower requirements (MANPOWER) as a function of the following factors: average number of patients admitted per day (PAT-DAYS), number of x- rays taken (X-RAYS), total number of days patients spent in bed (BED-DAYS), and average number of days stay per admission (AVG-STAY). One monthâ€™s worth of experience is recorded for each hospital.\n+ Read in the data file (systolic1.csv).\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nrm(list=ls())\ndata = read.csv(file=\"hosp1.csv\",header=T)\nattach(data)\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  X pat_days x_rays bed_days avg_stay manpower\n1 1    15.57   2463   472.92     4.45   566.52\n2 2    44.02   2048  1339.75     6.92   696.82\n3 3    20.42   3940   620.25     4.28  1033.15\n4 4    18.74   6505   568.33     3.90  1603.62\n5 5    49.20   5723  1497.60     5.50  1611.37\n6 6    44.92  11520  1365.83     4.60  1613.27\n```\n:::\n:::\n\n## Compute the correlation matrix of the four covariates. \n+ Do you have any concerns? Which pair-wise correlation appears to be the most problematic?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ncor(data[c(\"pat_days\", \"x_rays\", \"bed_days\", \"avg_stay\")])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          pat_days    x_rays  bed_days  avg_stay\npat_days 1.0000000 0.9073795 0.9999039 0.6711974\nx_rays   0.9073795 1.0000000 0.9071492 0.4466496\nbed_days 0.9999039 0.9071492 1.0000000 0.6711098\navg_stay 0.6711974 0.4466496 0.6711098 1.0000000\n```\n:::\n\n```{.r .cell-code}\n# psych::pairs.panels(data[,\n#     c(\"pat_days\", \"x_rays\", \"bed_days\", \"avg_stay\")])\n```\n:::\n\n\n## What are the limitations of your assessment via bivariate analysis?\n\n\n## Fit a model containing each of the afore-listed factors. Compute the VIFs.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm = lm(manpower~pat_days+x_rays+bed_days+avg_stay)\ncar::vif(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   pat_days      x_rays    bed_days    avg_stay \n5234.696180    7.778477 5210.637545    2.499282 \n```\n:::\n:::\n\n+ Which covariate has the highest % of its variation explained by other covariates in the mode?\n\n\n## Re-fit the model without BED-DAYS. Compare the R$^2$ to that of the original model.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm2 = lm(manpower~pat_days+x_rays+avg_stay)\nc(summary(m)$r.squared, summary(m)$adj.r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9905451 0.9873935\n```\n:::\n\n```{.r .cell-code}\nc(summary(m2)$r.squared, summary(m2)$adj.r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9894044 0.9869592\n```\n:::\n:::\n\n\n\n## Re-fit the model without PAT-DAYS. Compare the R$^2$ to that of the original model.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nm3 = lm(manpower~bed_days+x_rays+avg_stay)\nc(summary(m)$r.squared, summary(m)$adj.r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9905451 0.9873935\n```\n:::\n\n```{.r .cell-code}\nc(summary(m2)$r.squared, summary(m2)$adj.r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9894044 0.9869592\n```\n:::\n\n```{.r .cell-code}\nc(summary(m3)$r.squared, summary(m3)$adj.r.squared)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9900682 0.9877763\n```\n:::\n:::\n\n\n## Based on your work thus far, what is a solution to the collinearity issue previously identified?\n\\pause\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ncar::vif(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   pat_days      x_rays    bed_days    avg_stay \n5234.696180    7.778477 5210.637545    2.499282 \n```\n:::\n\n```{.r .cell-code}\ncar::vif(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n pat_days    x_rays  avg_stay \n11.321381  7.771393  2.498503 \n```\n:::\n\n```{.r .cell-code}\ncar::vif(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n bed_days    x_rays  avg_stay \n11.269348  7.737331  2.492904 \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}