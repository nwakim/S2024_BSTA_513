{
  "hash": "50d23e72f54efb9670a43c61c6e0c61c",
  "result": {
    "markdown": "---\ntitle: \"Module_G\"\nauthor: Xu Shi\ndate: Oct 12, 2020\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: xelatex\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ A study is conducted to examine the role of age (measured in days) and birth weight (BWT in ounces) as predictors of infant systolic blood pressure (SBP, mm Hg). \n+ Read in the data file (systolic1.csv).\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata = read.csv(file=\"systolic1.csv\",header=T)\nattach(data)\n```\n:::\n\n\n## Estimate the crude (i.e., unadjusted) effect of BWT on SPB. Is the effect significant?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = sbp ~ bwt)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-8.653 -3.000 -1.087  2.877 11.707 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 69.13333   10.40990   6.641 1.11e-05 ***\nbwt          0.15733    0.08556   1.839   0.0872 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.213 on 14 degrees of freedom\nMultiple R-squared:  0.1946,\tAdjusted R-squared:  0.137 \nF-statistic: 3.382 on 1 and 14 DF,  p-value: 0.08722\n```\n:::\n:::\n\n\n## Estimate the effect of BWT on SPB, adjusted for AGE. Is the effect significant?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt+age))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = sbp ~ bwt + age)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.0438 -1.3481 -0.2395  0.9688  6.6964 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 53.45019    4.53189  11.794 2.57e-08 ***\nbwt          0.12558    0.03434   3.657   0.0029 ** \nage          5.88772    0.68021   8.656 9.34e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.479 on 13 degrees of freedom\nMultiple R-squared:  0.8809,\tAdjusted R-squared:  0.8626 \nF-statistic: 48.08 on 2 and 13 DF,  p-value: 9.844e-07\n```\n:::\n:::\n\n\n## Estimate the correlation between BWT and AGE. Is the correlation significant?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ncor.test(bwt,age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  bwt and age\nt = 0.40201, df = 14, p-value = 0.6937\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.4106219  0.5722308\nsample estimates:\n     cor \n0.106828 \n```\n:::\n\n```{.r .cell-code}\n# summary(lm(bwt~age))$coef\n# summary(lm(age~bwt))$coef\n```\n:::\n\n\n## Compare the simple and multiple linear regression coefficient estimates for BWT, are they really any different? Why?\n\n## What is the main reason that BWT had an insignificant effect based on the SLR model, but a significant effect based on the MLR model?\n\n## Compute sequential SS (type I SS)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nanova(lm(sbp~bwt+age))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nbwt        1 130.54  130.54  21.238 0.0004901 ***\nage        1 460.50  460.50  74.923 9.342e-07 ***\nResiduals 13  79.90    6.15                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(lm(sbp~bwt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df Sum Sq Mean Sq F value  Pr(>F)  \nbwt        1 130.54  130.54  3.3818 0.08722 .\nResiduals 14 540.40   38.60                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Compute sequential SS (type I SS): order matters\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nanova(lm(sbp~age+bwt))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nage        1 508.82  508.82  82.784 5.322e-07 ***\nbwt        1  82.22   82.22  13.377  0.002896 ** \nResiduals 13  79.90    6.15                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(lm(sbp~age))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nage        1 508.82  508.82  43.939 1.135e-05 ***\nResiduals 14 162.12   11.58                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Numerically verify that, same as SAS, anova() uses F rather than F*\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(SeqSS = data.frame(anova(lm(sbp~bwt+age))))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df    Sum.Sq    Mean.Sq  F.value       Pr..F.\nbwt        1 130.53750 130.537500 21.23840 4.900555e-04\nage        1 460.49814 460.498140 74.92286 9.341884e-07\nResiduals 13  79.90186   6.146297       NA           NA\n```\n:::\n\n```{.r .cell-code}\nSeqSS[,\"Mean.Sq\"]/SeqSS[,\"F.value\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.146297 6.146297       NA\n```\n:::\n:::\n\n\n## Compute partial SS (type III SS)\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n```{.r .cell-code}\ncar::Anova(lm(sbp~bwt+age), type=\"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnova Table (Type III tests)\n\nResponse: sbp\n            Sum Sq Df F value    Pr(>F)    \n(Intercept) 854.98  1 139.104 2.571e-08 ***\nbwt          82.22  1  13.377  0.002896 ** \nage         460.50  1  74.923 9.342e-07 ***\nResiduals    79.90 13                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n\n## Using the SS's, calculate how much would R$^2$ increase if AGE is added to a model that already contains BWT\n\\pause\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n(seq_bwt_age = anova(lm(sbp~bwt+age)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: sbp\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nbwt        1 130.54  130.54  21.238 0.0004901 ***\nage        1 460.50  460.50  74.923 9.342e-07 ***\nResiduals 13  79.90    6.15                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n( SSY = sum( data.frame(seq_bwt_age)[,\"Sum.Sq\"] )  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 670.9375\n```\n:::\n\n```{.r .cell-code}\n(diff_Rsquared=data.frame(seq_bwt_age)[\"age\",\"Sum.Sq\"]/SSY)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6863503\n```\n:::\n:::\n\n\n\n## Verify your answer using lm outputs\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt+age))$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8809101\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt))$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1945599\n```\n:::\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt+age))$r.squared - summary(lm(sbp~bwt))$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6863503\n```\n:::\n:::\n\n\n## Using the *extra* SS's, test whether BWT is associated with SBP, not accounting for AGE\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata.frame(seq_bwt_age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df    Sum.Sq    Mean.Sq  F.value       Pr..F.\nbwt        1 130.53750 130.537500 21.23840 4.900555e-04\nage        1 460.49814 460.498140 74.92286 9.341884e-07\nResiduals 13  79.90186   6.146297       NA           NA\n```\n:::\n:::\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\n## Compare to lm result\nsummary(lm(sbp~bwt))$coef[\"bwt\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Estimate Std. Error    t value   Pr(>|t|) \n0.15733333 0.08555527 1.83896724 0.08722334 \n```\n:::\n:::\n\n+ What is the reason for the difference?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt))$sigma^2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 38.6\n```\n:::\n:::\n\n\n## Are the t tests in lm(sbp~bwt+age) output sequential or partial? \n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt+age))$coef\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 53.4501940  4.5318886 11.794243 2.570807e-08\nbwt          0.1255833  0.0343362  3.657459 2.895789e-03\nage          5.8877191  0.6802051  8.655799 9.341884e-07\n```\n:::\n:::\n\n+ Verify your answer numerically\\pause \n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nsummary(lm(sbp~bwt+age))$coef[,\"t value\"]^2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n(Intercept)         bwt         age \n  139.10416    13.37701    74.92286 \n```\n:::\n\n```{.r .cell-code}\ndata.frame(car::Anova(lm(sbp~bwt+age), type=\"III\"))[,\"F.value\"]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 139.10416  13.37701  74.92286        NA\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}