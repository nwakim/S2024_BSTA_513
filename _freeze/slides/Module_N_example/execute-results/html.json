{
  "hash": "1bf1cb8db3adb02042d35fcb6140d2b0",
  "result": {
    "markdown": "---\ntitle: \"Module_N\"\nauthor: Xu Shi\ndate: Dec 1, 2020\nfontsize: 10pt\noutput: \n    beamer_presentation\nlatexengine: pdflatex\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell mysize='true'}\n\n:::\n\n## Example: \n+ A study was carried out on n=31 adult males in order to develop a prediction model for oxygen uptake. The study subjects run 1 mile on a treadmill, with an oxygen mask and heart monitor strapped to them. Data are recorded on age (years), weight (kg), time to run 1 mile (min), resting pulse (taken before the run), maximum pulse (during the run) and pulse at the end of the run; as well oxygen uptake.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nrm(list=ls())\ndata = read.csv(file=\"fitness1.csv\",header=T)\nattach(data)\nhead(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  age   wt o2uptake t_run pulse_rest pulse_end pulse_max\n1  44 89.4     44.6  11.3         62       178       182\n2  40 75.0     45.3  10.7         62       185       185\n3  44 85.8     54.2   8.6         45       156       168\n4  42 68.1     59.5   8.1         40       166       172\n5  38 89.0     49.8   9.2         55       178       180\n6  47 77.4     44.8  11.6         58       176       176\n```\n:::\n:::\n\n\n## Determine if there are any collinearity issues. Is any corrective action required?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ncar::vif(lm(o2uptake~.,data=data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       age         wt      t_run pulse_rest  pulse_end  pulse_max \n  1.490402   1.148435   1.616520   1.428064   8.516299   8.768442 \n```\n:::\n:::\n\n\n## Generate a potential model using forward selection, with $p_I$ = 0.10.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nolsrr::ols_step_forward_p(lm(o2uptake~.,data=data),penter=0.1,details=F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                            Selection Summary                              \n--------------------------------------------------------------------------\n        Variable                   Adj.                                       \nStep     Entered     R-Square    R-Square     C(p)        AIC        RMSE     \n--------------------------------------------------------------------------\n   1    t_run          0.7576      0.7492    13.9400    152.6448    2.6635    \n   2    age            0.7836      0.7681    11.5436    151.1231    2.5610    \n   3    pulse_end      0.8225      0.8028     6.9751    146.9808    2.3620    \n   4    pulse_max      0.8445      0.8206     5.2559    144.8741    2.2527    \n--------------------------------------------------------------------------\n```\n:::\n:::\n\n\n\n## If you re-run forward selection, but with $p_I$ = 0.05. How would your results compare with the previous ones?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nolsrr::ols_step_forward_p(lm(o2uptake~.,data=data),penter=0.05,details=F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                            Selection Summary                             \n-------------------------------------------------------------------------\n        Variable                  Adj.                                       \nStep    Entered     R-Square    R-Square     C(p)        AIC        RMSE     \n-------------------------------------------------------------------------\n   1    t_run         0.7576      0.7492    13.9400    152.6448    2.6635    \n-------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## Select a model through backward elimination, with $p_O$ = 0.10.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nolsrr::ols_step_backward_p(lm(o2uptake~.,data=data),prem=0.1,details=F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                           Elimination Summary                             \n--------------------------------------------------------------------------\n        Variable                    Adj.                                      \nStep     Removed      R-Square    R-Square     C(p)       AIC        RMSE     \n--------------------------------------------------------------------------\n   1    pulse_rest      0.8575      0.8291    5.0557    144.1610    2.1990    \n   2    wt              0.8445      0.8206    5.2559    144.8741    2.2527    \n--------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## If you re-run backward selection, but with $p_O$ = 0.5. How would your results compare with the previous ones?\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nolsrr::ols_step_backward_p(lm(o2uptake~.,data=data),prem=0.5,details=F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                           Elimination Summary                             \n--------------------------------------------------------------------------\n        Variable                    Adj.                                      \nStep     Removed      R-Square    R-Square     C(p)       AIC        RMSE     \n--------------------------------------------------------------------------\n   1    pulse_rest      0.8575      0.8291    5.0557    144.1610    2.1990    \n--------------------------------------------------------------------------\n```\n:::\n:::\n\n\n## Categorize age for illustration\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\ndata$age = cut(data$age,\n               breaks=c(min(age)-1,median(age),max(age)+1)) \ntable(data$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n(37,48] (48,58] \n     16      15 \n```\n:::\n:::\n\n\n## Now with new age, select a model through forward selection, with $p_I$ = 0.10.\n\n::: {.cell mysize='true'}\n\\footnotesize\n\n```{.r .cell-code}\nolsrr::ols_step_forward_p(lm(o2uptake~.,data=data),penter=0.1,details=F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                            Selection Summary                              \n--------------------------------------------------------------------------\n        Variable                   Adj.                                       \nStep     Entered     R-Square    R-Square     C(p)        AIC        RMSE     \n--------------------------------------------------------------------------\n   1    t_run          0.7576      0.7492    15.7748    152.6448    2.6635    \n   2    age            0.8009      0.7866    10.1335    148.5441    2.4566    \n   3    pulse_end      0.8227      0.8031     8.2739    146.9366    2.3603    \n   4    pulse_max      0.8515      0.8286     5.2082    143.4586    2.2019    \n--------------------------------------------------------------------------\n```\n:::\n:::\n\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}